06d4996 & 16 Aug 2013 & rusty & { Initial conversion of 0.9.5 draft spec into text.




git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@1} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9d60335 & 16 Aug 2013 & rusty & { Reworked spec into non-PCI order.


Issue: \url{https://tools.oasis-open.org/issues/browse/VIRTIO-1}
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@2} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
49f2dca & 16 Aug 2013 & rusty & { 2.1.4 Virtqueues: Clarify vring_size() when VIRTIO_RING_F_EVENT_INDEX.


Ported from draft commit eb9fc84d0d3c46438aaab190e2401a9e5409a052.

Reported-by: Stefan Fritsch <sf@sfritsch.de>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@3} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
88a9bcb & 16 Aug 2013 & rusty & { 2.5 Device Types: add reservation for rproc serial (11).


Ported from draft commit 5306b0cfe750604643c157ed870b04c426924bb4.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@4} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
93e42c5 & 16 Aug 2013 & rusty & { 2.7 virtio_ring.h: make it compile, update, and add avail/used helpers.


Ported from draft, commit 76f5840ce1ca56b211c974f24e86a91bd8ef2d07

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@5} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e0ed235 & 16 Aug 2013 & rusty & { 2.6 Reserved Feature Bits: fix count.


Ported from draft, commit b0037d5d207dba8a66cb7616608164a3f46a8971

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@6} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9761928 & 16 Aug 2013 & rusty & { 2.4.2.2 MMIO Device Layout: clarity enhancement.


Outcome of discussion with Amos Kong.

Ported from draft, commit 38c8600ef2e33d672449f517598239bc682673c9.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@7} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
01d6f20 & 16 Aug 2013 & rusty & { 2.5.1.5 Device Operation: add missing semicolon.


Ported from draft, commit 3c482cf453d36d7c7f81d6a5be260551243e01d4.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@8} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c000eee & 16 Aug 2013 & rusty & { 2.5 Device Types: reserve 12 for virtio CAIF.


Ported from draft, commit fcb1075753e285b3629301ea075ca0522e29a97b.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@9} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2d4fa5d & 16 Aug 2013 & rusty & { Make references to "descriptor chains" explicit.


Ported from draft, commit 7a3a665b778039786fade0093df7cc60ebc6cdb1.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@10} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f74524e & 16 Aug 2013 & rusty & { 2.5.5.6 Device Operation: VIRTIO_BALLOON_F_MUST_TELL_HOST is negotiated


Make that clear: it was not the original intention, but no implementation
actually requires this feature, and making it compulsory has unintended
consequences (it is unlike any other feature).

Ported from draft, commit ed6dd6e5b4c4c01084ff1638b754ad823d0b80f8.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@11} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4a831c1 & 16 Aug 2013 & rusty & { 2.1.4.2 Message Framing: Document header framing requirement.


Ported from draft, commits 7e74459bb966ccbaad9e4bf361d1178b7f400b79,
8e47520c64c87473f910b55817ba95b0e4113c13 and part of
835628846cc04efe660e505552d06eb945277d3b.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@12} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
69fbbac & 16 Aug 2013 & rusty & { 2.6 Reserved Feature Bits: document bit 30 as used by qemu.


Partial port of draft commit 835628846cc04efe660e505552d06eb945277d3b.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@13} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6c9d2f4 & 16 Aug 2013 & rusty & { As submitted to virtio-comment list: \url{https://lists.oasis-open.org/archives/virtio-comment/201308/msg00009.html}


(Edited into plain text)

From: Dmitry Fleytman <dfleytma@redhat.com>

Virtio-net driver currently negotiates network offloads
on startup via features mechanism and have no ability to
disable and re-enable offloads later.
This patch introduced a new control command that allows
to configure device network offloads state dynamically.
The patch also introduces a new feature flag
VIRTIO_NET_F_CTRL_GUEST_OFFLOADS.

Signed-off-by: Dmitry Fleytman <dfleytma@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@14} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
75fe4e4 & 19 Aug 2013 & rusty & { Rename to conform to OASIS Naming Directives.


\url{http://docs.oasis-open.org/specGuidelines/ndr/namingDirectives.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@15} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e17291d & 29 Aug 2013 & mstsirkin & { virtio: fix feature bit thinko


32 Feature bits means 0 to 31, not 32.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@16} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b03b3a8 & 29 Aug 2013 & mstsirkin & { formatting fixes


for consistency, make sure the following
formatting rules hold:

- each subchapter number ends with dot

- each subchapter title is followed by a line of dashes

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@17} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
acd8e68 & 29 Aug 2013 & mstsirkin & { formatting: more fixups


Fix up formatting for cross-references
e.g. (see X.Y.Z. Foo Bar) to match section names.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@18} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c278158 & 29 Aug 2013 & mstsirkin & { formatting: put cross-references in "", fix FIXME


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@19} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
98776ec & 29 Aug 2013 & mstsirkin & { minor: rename section


Section in PCI part of spec talks about interrupts,
not used buffers (that's generic).
Also tweak formatting.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@20} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
66ccc72 & 29 Aug 2013 & mstsirkin & { format: remove trailing whitespace


no reason to have it

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@21} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
48d04a5 & 29 Aug 2013 & mstsirkin & { formatting: fix numbering


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@22} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
288a081 & 29 Aug 2013 & mstsirkin & { fix-numbers: perl script to fix up numbering


A handy script I used to fix it up the numbering.
It can make mistakes, so check before you commit!

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@23} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4c087bd & 29 Aug 2013 & mstsirkin & { formatting: fix up section and footnote numbering


automatically done by script.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@24} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a2ec438 & 30 Aug 2013 & mstsirkin & { add .exrc


set text width correctly automatically for vim users

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@25} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7734132 & 30 Aug 2013 & mstsirkin & { formatting: fix more xrefs


Text had some xrefs in the form [sub:text].
These point nowhere, find the target making most
sense and make them point there.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@26} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1ecf60e & 30 Aug 2013 & mstsirkin & { formatting: fix xref to virtio_ring.h


Text simply had a stub *XREF* text, make it
point at the actual section.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@27} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2f58637 & 30 Aug 2013 & mstsirkin & { formatting: fix two xrefs


Fix incorrect section number in one xref, fill in
actual targets for another.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@28} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7c748b4 & 03 Sep 2013 & rusty & { 2.5.6.6.3: unify event structs From: Paolo Bonzini <pbonzini@redhat.com>


All currently defined event structs have the same fields.  Simplify the
driver by enforcing this also for future structs.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
See: \url{https://lists.oasis-open.org/archives/virtio-comment/201308/msg00031.html}
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@29} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9ef9ca8 & 03 Sep 2013 & rusty & { 2.5.6.6.3: add configuration change event


This adds an event for changes to LUN parameters, for example capacity.  These
are reported in virtio-blk via configuration changes, and we want a similar
functionality in virtio-scsi too.

There is no list of supported parameter changes, instead we just refer to
the list of sense codes in the SCSI specification.

This event will usually be serviced in one of three ways: 1) call an OS
service to revalidate the disk, either always or only for some specific
sense codes; 2) somehow pass the sense directly to the upper-level driver;
3) inject a TEST UNIT READY command into the upper-level device, so that
the OS will see the unit attention code and react.  Of course a mix of
the three is also possible, depending on how the driver writer prefers
to have his layering violations served.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

See: \url{https://lists.oasis-open.org/archives/virtio-comment/201308/msg00032.html}
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@30} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1c403ad & 04 Sep 2013 & rusty & { 2.4.2.2 Define all MMIO registers as little endian


Port of draft commit 88f37f9ec178b664213b77211fec03687b87958b.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@31} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5fe30e0 & 11 Sep 2013 & rusty & { VIRTIO_F_VERSION_1: indentifying legacy devices.


Most of this text is taken directly from Michael Tsirkin's proposal,
separated from the PCI-specific parts, and given an explicit feature name.

See minutes: \url{https://lists.oasis-open.org/archives/virtio/201309/msg00041.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@32} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
148d17d & 11 Sep 2013 & rusty & { 2.5 Reserve device ID 0 (zero) as invalid


See minutes: \url{https://lists.oasis-open.org/archives/virtio/201309/msg00041.html}
Signed-off-by: Pawel Moll <pawel.moll@arm.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@33} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5d15cc4 & 18 Sep 2013 & mstsirkin & { transitional: minor clarification


It's useful to have a common term that includes
transitional drivers running on legacy devices
and legacy drivers running on transitional devices.
The wording "using legacy interface" seems to
describe this well, let's make this
explicit.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@34} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e83ad8c & 25 Sep 2013 & rusty & { Any layout is allowed (deprecate VIRTIO_F_ANY_LAYOUT)


As per issue virtio-10, approved OASIS meeting 2013-09-24.
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@35} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
cfcac7f & 25 Sep 2013 & rusty & { Remove VIRTIO_F_NOTIFY_ON_EMPTY


As per \url{http://tools.oasis-open.org/issues/browse/VIRTIO-13}

(Includes le8 -> u8 fix)

Approved OASIS meeting 2013-09-24.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@36} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fbed1a2 & 25 Sep 2013 & rusty & { 2.4.1.3: Remove VIRTIO_NET_F_GSO


As per VIRTIO-17, approved OASIS meeting 2013-09-24.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@37} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
943f199 & 25 Sep 2013 & rusty & { Relegate the VIRTIO_BLK_F_SCSI feature to legacy


As per issue virtio-18, approved OASIS meeting 2013-09-24.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@38} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8ec4977 & 25 Sep 2013 & rusty & { 2.4.2.3: Remove VIRTIO_BLK_F_BARRIER.


As per VIRTIO-19, approved OASIS meeting 2013-09-24.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@39} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5e19006 & 25 Sep 2013 & rusty & { 2.4.2.5: Remove ioprio field.


Leave a reserved field in there for alignment.

See: \url{https://tools.oasis-open.org/issues/browse/VIRTIO-20}
Approved OASIS meeting 2013-09-24.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@40} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9d70a91 & 25 Sep 2013 & rusty & { 2.3.3 Add virtio-ccw spec.


Ported from draft commit cdbad68fd1ccb8b99b3853836e2b38e0bf74361b.

Issue VIRTIO-29, approved OASIS meeting 2013-09-24.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@41} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fbf60ea & 25 Sep 2013 & rusty & { 2.3.3 virtio-ccw: Add secondary indicators.


Ported from draft commit e945661b40bcfd29efc35dfa73465bcc960bd20b.

Issue VIRTIO-29, approved OASIS meeting 2013-09-24.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@42} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3e6f11b & 25 Sep 2013 & rusty & { 2.3.3.2 virtio-ccw clarifications.


Ported from draft commit 67843fe9745e96c10e148f00ba0aa64397c64f06.

Issue VIRTIO-29, approved OASIS meeting 2013-09-24.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@43} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f44fda4 & 25 Sep 2013 & rusty & { virtio-ccw: document GPR4/GPR2 cookie values


virtio-ccw on kvm can use a cookie value passed to guest
to optimize channel/VQ lookups.
Document this.

VIRTIO-29, approved OASIS meeting 2013-09-24.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@44} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
80a202a & 30 Sep 2013 & mstsirkin & { pci: new configuration layout



- split data path, common config and device specific config

- support for new VQ layout

Resolves issue VIRTIO-21

Approved OASIS meeting 2013-09-24.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@45} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
bec2c19 & 30 Sep 2013 & mstsirkin & { pci: new layout: driver must not write to bits>63


Since we never offer feature bits >63, driver must
not ack them.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@46} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f954854 & 30 Sep 2013 & mstsirkin & { pci: new layout: move footnote


Legacy footnotes belong directly within text.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@47} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2c75849 & 30 Sep 2013 & mstsirkin & { pci: remove requirement for revision ID to be 0


While spec previously required revision to be 0 exactly
it turned out not to be an efficient means to
disable legacy drivers - we had to resort to changing
device ID instead.

So let's free up this field making it available for
device makers for hardware versioning.

Resolves VIRTIO-22
Approved OASIS meeting 2013-09-24.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@48} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1a0b2c6 & 30 Sep 2013 & mstsirkin & { virtqueue: flexible layout, size, alignment


Transports can now lay out available/used/descriptor
regions in a flexible way.
This is useful for embedded systems to save memory,
and for large systems to reduce the need for
physically-contigious memory.

However, this does not add a way to actually program this
in any of the transports, so it's not useful by
itself, separate follow-up patches will add a way to
program this for transports.

Resolves issue: VIRTIO-23
Approved OASIS meeting 2013-09-24.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@49} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f654bea & 04 Oct 2013 & rusty & { Legacy Interfaces: A Note on Virtqueue Layout: Remove dup paragraph.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@50} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
edeffd1 & 04 Oct 2013 & rusty & { 2.1: Add ccw to forward references.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@51} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6df98f7 & 04 Oct 2013 & rusty & { Copy linear layout to CCW, MMIO sections.


Revision r49 "virtqueue: flexible layout, size, alignment" moved the linear
assumption into the legacy section.  We also need it in the per-transport
sections until (if?) those two transports go non-linear.

Just copied the paragraph, with variable names changed to match the particular
transport field nomenclature.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@52} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
305bbae & 04 Oct 2013 & rusty & { 2.3.1.2.5: emphasize that PCI device-specific config byte-accessible legacy only


This clarification taken from a larger patch by MST:
\url{http://markmail.org/search/?q=subject\%3A\%22[PATCH]\%20configuration\%20space\%20endian-ness\%22+list\%3A\%22org.oasis-open.lists.virtio\%22\#query:subject\%3A\%22[PATCH]\%20configuration\%20space\%20endian-ness\%22\%20list\%3A\%22org.oasis-open.lists.virtio\%22+page:1+mid:6k3im4t3csdukbzm+state:results}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@53} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9a67087 & 04 Oct 2013 & rusty & { net \& block: Make Device configuration layout a separate section.


Formatting conversion error: other devices are OK.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@54} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
470aa92 & 04 Oct 2013 & rusty & { net: revert accidental u16->le16 config change.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@55} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
968eac4 & 04 Oct 2013 & rusty & { Remove comment about > 24 feature bits.


We have that on every transport now.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@56} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
eada3cb & 09 Oct 2013 & hornet & { 2.3.2 MMIO: Reformatting the text


* cleaned up indentation
* replaced all non-ASCII characters with equivalents
* fixed paragraphs numbering

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@57} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c90c93d & 09 Oct 2013 & hornet & { 2.1.2. Feature Bits: Fixed typo


s/resered/reserved

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@58} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fce0e55 & 09 Oct 2013 & hornet & { 2.1.2.1 Legacy Interface: Fixed typo


s/accomodates/accommodates

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@59} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c5f79f5 & 10 Oct 2013 & mstsirkin & { initialization: add extra device status handshake


2.2.1: FEATURES_OK.

Based on MST's ideas, but a bit simpler.

Resolves issue: VIRTIO-30.
Approved OASIS meeting 2013-10-08.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@60} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3fe5804 & 14 Oct 2013 & rusty & { 2.5.2.3: Add block topology.


From: Paolo Bonzini <pbonzini@redhat.com>

Current QEMU and Linux drivers can export queue parameters via the
virtio-blk configuration space.  Document this, since the next patch
will have to add another configuration field after these.

Approved at 2013-10-08 Meeting: \url{https://lists.oasis-open.org/archives/virtio/201310/msg00087.html}
See: \url{https://lists.oasis-open.org/archives/virtio-comment/201308/msg00028.html}
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

Conflicts:
	virtio-v1.0-wd01-part1-specification.txt

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@61} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9a42c29 & 14 Oct 2013 & rusty & { virtio_blk: deprecate flush.


This is partially a port of Paolo Bonzini <pbonzini@redhat.com>'s
WCE spec changes, but puts them in the legacy section.  It reserves
the writeback field for compatibility.

Flush is now required.

Approved at 2013-10-08 meeting: \url{https://lists.oasis-open.org/archives/virtio/201310/msg00087.html}
See: \url{https://lists.oasis-open.org/archives/virtio-comment/201308/msg00078.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@62} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a70adf9 & 14 Oct 2013 & rusty & { 2.5.2.3:  document topology fields


From: Paolo Bonzini <pbonzini@redhat.com>

This completes the changes from yesterday.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Approved at 2013-10-08 meeting: \url{https://lists.oasis-open.org/archives/virtio/201310/msg00087.html}
See:\url{https://lists.oasis-open.org/archives/virtio-comment/201308/msg00030.html}
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@63} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ce8f873 & 14 Oct 2013 & rusty & { VIRTIO-15: Simplify indirect descriptors.


You get a single table, no multiple tables (no driver does this, but devices
are supposed to support it anyway)

As per issue virtio-15
Approved at meeting 2013-10-08: \url{https://lists.oasis-open.org/archives/virtio/201310/msg00087.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@64} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a29c58e & 15 Oct 2013 & cornelia.huck & { virtio-ccw: clarify sense id operation


Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@65} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5542f33 & 15 Oct 2013 & hornet & { 2.3.2 MMIO: Reformatting the text, cont.


Further indentation clean-up and non-ASCII characters hunt.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@66} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0ef4832 & 29 Oct 2013 & hornet & { 2.3.2 MMIO: Upgrade registers layout to version 2


This patch addresses VIRTIO-44:

* Clarifies MagicValue content
* Bumps up the Version value to 2
* Removes paged-based addressing and replaces it
  with 64 bit addresses
* Replaces implicit queue organisation (based
  on alignment size) with explicit desc/avail/used
  addreses (based on original MST's patch, see
  VIRTIO-41)
* Introduces explicit protocol for queue
  enabling (based on original MST's idea)
  and disabling
* Defines driver's reaction to an invalid
  device ID (0x0).

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@67} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4a88c5a & 29 Oct 2013 & hornet & { 2.3.2 MMIO: Add config space version register


... to allow synchronisation between the guest and the host.

Based on Rusty's original patch, see VIRTIO-35.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@68} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
663e729 & 30 Oct 2013 & rusty & { virtio-ccw: introduce revisions


Provide a new ccw that allows devices and drivers to operate on selected
revision levels.

VIRTIO-42

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@69} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c04faff & 30 Oct 2013 & rusty & { virtio-ccw: split descriptor/available/used rings (alternate)


Extend vq_info_block so that the addresses for descriptor table,
available ring and used ring may be transmitted independently.

VIRTIO-23

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@70} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
630f485 & 30 Oct 2013 & rusty & { Revert "virtio-ccw: introduce revisions"


This reverts commit 663e7294691c6f76488d26c82a81f0d6d1e27593.

Accidental commit; minutes say we defer.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@71} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
80f2437 & 30 Oct 2013 & cornelia.huck & { virtio-ccw: add adapter interrupt support


Specify a new channel command to set up two-stage indicators as needed
for adapter interrupts and describe how adapter interrupts are used
for notifications.

VIRTIO-43

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@72} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0806562 & 30 Oct 2013 & cornelia.huck & { virtio-ccw: clarify some channel I/O concepts


Add the documents where channel I/O is generally described to the
normative references and add some further words on command rejects
and length checks.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@73} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
306baac & 31 Oct 2013 & rusty & { Configuration (read) atomicity.


Aka issue VIRTIO-35.

This is solved per transport:
1) PCI: use the 8 bit reserved field.
	Assume that if you really change that fast, you'll do it lazily on
	config space read.
2) MMIO (already solved by v2 update)
3) CCW: no transport changes.
	They always read/write the entire thing.  This just shows that
	Cornelia is smarter than I am.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@74} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a009ddd & 31 Oct 2013 & rusty & { configuration space endian-ness


make it all LE and require natural width accesses

resolves VIRTIO-9

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com> (rebase)

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@75} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ba0bc52 & 31 Oct 2013 & rusty & { virtqueue endian-ness


make all ring structures LE
resolves VIRTIO-9

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@76} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a83238a & 31 Oct 2013 & rusty & { 2.4.2.3.1 Legacy Interface: Feature bits


A previous patch put the device config layout in the middle of the
legacy feature bits.  Fix up now.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@77} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b4da10a & 31 Oct 2013 & rusty & { Use le types in all non-legacy places.


Emphasize that legacy endian was different, but change all the basic types
to use le32 etc as a constant reminder.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@78} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9bb3bd7 & 31 Oct 2013 & rusty & { Thorough endianness notes for legacy.


This is noted at the beginning of the spec, but let's make it explicit
everywhere le32 etc is used.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@79} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9a48bcc & 31 Oct 2013 & rusty & { Remove __ annotations on pci.


We use le32 etc elsewhere, make it consistent.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@80} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4186dbd & 31 Oct 2013 & rusty & { CCW: Make it very clear that CCW channel commands are big-endian.


Noone is likely to get confused, but let's be explicit since the rest of
the spec is little-endian.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@81} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
711aad9 & 04 Nov 2013 & cornelia.huck & { ccw: Tweak the comments on endianess.


...just to make obvious that we're talking about the transmitted data.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@82} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c01a259 & 04 Nov 2013 & cornelia.huck & { ccw: Remove reference to old s390-virtio transport.


Historical notes for a mechanism that was never officially specced
do not add anything to the standard.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@83} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
57110bc & 04 Nov 2013 & cornelia.huck & { ccw: Improve indicator wording.


Be clearer about traditional vs. adapter interrupts and virtqueue vs.
configuration indicators.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@84} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
55dc713 & 04 Nov 2013 & mstsirkin & { typo fix: 8-bite->8-bit


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@85} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1f0f785 & 05 Nov 2013 & cornelia.huck & { virtio-ccw: introduce revisions


Provide a new ccw that allows devices and drivers to operate on selected
revision levels.

VIRTIO-42

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@86} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4e05c77 & 07 Nov 2013 & rusty & { 2.2.1: Remove advice that reset is not req'd on startup.


It's always good practice to reset a device.

As per minutes of meeting 2013-11-05: \url{http://markmail.org/message/3cjjeakzkfzcqk5c}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@87} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
30ea341 & 07 Nov 2013 & rusty & { 2.2.2.1: remove advice on notification for empty buffers.


A driver can notify whenever it wants, but it should only make a difference
to buggy devices.

As per meeting 2013-11-05: \url{http://markmail.org/message/3cjjeakzkfzcqk5c}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@88} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d0a31ae & 10 Nov 2013 & mstsirkin & { pci: a note on non-transitional devices


Add a note documenting handling legacy drivers for
non transitional devices.

VIRTIO-34

Accepted Nov 5, 2013
\url{https://lists.oasis-open.org/archives/virtio/201311/msg00031.html}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@89} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ed86f85 & 10 Nov 2013 & mstsirkin & { pci: use revision id 1 or higher for non transitional devices


VIRTIO-34

Accepted Nov 5, 2013
\url{https://lists.oasis-open.org/archives/virtio/201311/msg00031.html}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@90} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
754eb33 & 10 Nov 2013 & mstsirkin & { compatibility: extendable config space and pci cfg


We often specify specific layout of config space,
in the past drivers took this to mean "there will be
no other fields" and failed devices where config
space was larger.

To avoid such issues in the future, document that drivers
should only check size is >= the required value.

VIRTIO-48

Accepted Nov 5, 2013
\url{https://lists.oasis-open.org/archives/virtio/201311/msg00031.html}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@91} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5f3f1af & 10 Nov 2013 & mstsirkin & { virtio-pci: access device using config


VIRTIO-39.

Accepted Nov 5, 2013
\url{https://lists.oasis-open.org/archives/virtio/201311/msg00031.html}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@92} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1d7e7fb & 11 Nov 2013 & hornet & { 2.3.2 MMIO: Define reset requirements


This patch addresses VIRTIO-47, adding explicit description
of the device behaviour when being reset.

As per meeting 2013-11-05
\url{https://lists.oasis-open.org/archives/virtio/201311/msg00031.html}

Signed-off-by: Pawel Moll <pawel.moll@arm.com>



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@93} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
678fcbc & 25 Nov 2013 & mstsirkin & { virtio: fix duplicate section numbers


make sure section numbers are unique.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@94} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2de92a6 & 25 Nov 2013 & mstsirkin & { minor: add dots after section numbers


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@95} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
db8c4bc & 25 Nov 2013 & mstsirkin & { minor: put section cross-references on a single line


Easier to handle them automatically this way.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@96} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1b83b86 & 25 Nov 2013 & mstsirkin & { minor: fix up cross-references for virtio-net


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@97} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a491f6a & 25 Nov 2013 & mstsirkin & { minor: make code and only code have leading tab


Mostly true already, correct remaining issues.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@98} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3e36dad & 25 Nov 2013 & mstsirkin & { minor: indent more listings


make sure all listings are indented with a leading tab.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@99} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d6fa229 & 25 Nov 2013 & mstsirkin & { minor: format tables in a standard way


Make horisontal separators be +-----+ everywhere.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@100} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f5a01d1 & 25 Nov 2013 & mstsirkin & { minor: format tables in a uniform way


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@101} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8b579fd & 25 Nov 2013 & mstsirkin & { minor: fix up section cross references


Use consistent "number. name" everywhere.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@102} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
40af2b9 & 25 Nov 2013 & mstsirkin & { virtio: add latex templates from CMIS


I imported latex templates from the CMIS specifications
and changed s/CMIS/VIRTIO/ everywhere.

The result is very close to one produced by exporting from the
ODF we were supplied, with the exception of the TOC formatting,
where section numbers are in blue instead of black, and major
sections don't have dots leading to page numbers.

I'm guessing this isn't very important, someone with more latex
knowledge can try to figure this out.

Generating html doesn't actually work for me.
It doesn't work for me for CMIS either, so
it's probably just an issue with my local latex setup.

I'm not sure we need html output at all.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@103} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c9d7e8c & 25 Nov 2013 & mstsirkin & { makehtml: use local t4ht stub


Fedora seems to ship a broken t4ht. Skip it.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@104} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8532c91 & 25 Nov 2013 & mstsirkin & { makepdf: run 3 times


seems to be needed to resolve cross references.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@105} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
493ecc7 & 25 Nov 2013 & mstsirkin & { makepdf.sh: remove aux before generation


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@106} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fe5bfc7 & 25 Nov 2013 & mstsirkin & { makehtml: remove aux before generation


can be corrupt from previous runs.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@107} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5dfaff9 & 25 Nov 2013 & mstsirkin & { virtio: LaTeX: add dot lines for chapters in the TOC


Signed-off-by: Pawel Moll <pawel.moll@arm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@108} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2192810 & 25 Nov 2013 & mstsirkin & { virtio: LaTeX: Do not include leading numbers in the TOC link


... making them black on the way.

Warning! This is a hack and it depends on the hyperref
package version.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@109} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
37797d7 & 25 Nov 2013 & mstsirkin & { virtio: LaTeX: change the way the dotted lines are added in the TOC


Instead of using the tocloft package, which seems to collide
with OASIS-style TOC headers, patch the report style. More
hacky, less intrusive...

Signed-off-by: Pawel Moll <pawel.moll@arm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@110} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6786106 & 25 Nov 2013 & mstsirkin & { txt2latex.pl: script to convert text to latex


The result compiles and looks kind of OK.

This reverse-engineers our txt format to generate
the initial latex file.

Tables are included in verbatim sections.
Code is included in listing sections.
Math is escaped with \$\$.

TODO (possibly manually):

- remove extra sections at the beginning of the document

- format tales using tabular or similar environment

- format lists using itemize/enumerate/description

- prevent hyphenation in the middle of identifiers

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@111} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
37b8352 & 25 Nov 2013 & mstsirkin & { txt2latex.pl: don't put _ in labels


This doesn't work well if _ is redefined, and is easy to avoid.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@112} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ef16b64 & 25 Nov 2013 & mstsirkin & { content.tex: spec text converted to latex


This is simply virtio-v1.0-wd01-part1-specification.txt
converted by txt2latex.pl

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@113} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e5ab5df & 25 Nov 2013 & mstsirkin & { latex: add underscore package


We use _ widely, make this legal so we don't
need to escape all uses.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@114} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9c26238 & 25 Nov 2013 & mstsirkin & { latex: include content.tex


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@115} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
346e908 & 25 Nov 2013 & mstsirkin & { latex: add a comment


Add a comment about an alternative to
\textbackslash usepackage\{underscore\}, in case we'll want to
use it in the future.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@116} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1902f4a & 25 Nov 2013 & mstsirkin & { introduction.tex: import from text document


manually import introduction from main text.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@117} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
964ad5f & 25 Nov 2013 & mstsirkin & { content.tex: drop text moved to introduction.tex


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@118} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
da40d31 & 25 Nov 2013 & mstsirkin & { content.tex: fix up cross-reference to S390


make it a hyper-link.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@119} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
26f7978 & 25 Nov 2013 & mstsirkin & { content.tex: manually fix malformed table


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@120} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4601066 & 25 Nov 2013 & mstsirkin & { content.tex: manual legacy pci device layout


rewrite legacy pci device layout using tabularx.
it was too wide for verbatim to lay out reasonably.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@121} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
bf017b2 & 25 Nov 2013 & mstsirkin & { tex: fix html build: add packages


tabularx is required.
Things seem to build without underscore but just in case
let's import it too.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@122} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0339161 & 25 Nov 2013 & cornelia.huck & { content.tex: Fix virtio-ccw cross reference.


Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@123} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7295d25 & 25 Nov 2013 & mstsirkin & { makehtml: import hard-coded css


It should be generated from virtiohtml.cfg but
this does not seem to work.
For now import a hard-coded one.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@124} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
900f7f3 & 25 Nov 2013 & mstsirkin & { makehtml: proper fix for t4ht


So recent Fedora and some other distros have broken t4ht
packages, making makehtml fail.  The correct fix is to put a
working t4ht somewhere in your path.

For example, for Fedora one can get an old copy from here:
\url{http://pkgs.fedoraproject.org/repo/pkgs/tetex-tex4ht/tex4ht-1.0.2008_02_28_2058.tar.gz/dc9d78c8ad22acd4b40dfd2cbbe2b8de/tex4ht-1.0.2008_02_28_2058.tar.gz}
after unpacking, t4ht is under ./bin/linux/t4ht, put it on path.
tex4ht.env is under texmf/tex4ht/base/unix/tex4ht.env, put it
in \$HOME (you can rename it .tex4ht) or under current directory.

Revert the work-around in makehtml, but keep it around
in a comment for people who want to use it.
alternatively, someone might want to implement auto-detection
of the broken t4ht and apply the work-around automatically.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@125} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
306b6bb & 25 Nov 2013 & mstsirkin & { main.tex: drop appendix stub


This was used to demonstrate appending format, it is
no longer useful.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@126} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2b28e1a & 25 Nov 2013 & mstsirkin & { makehtml: more fedora work-arounds


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@127} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3fbe730 & 25 Nov 2013 & mstsirkin & { latex: updates requested by OASIS for the CSD


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@128} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5775fae & 28 Nov 2013 & mstsirkin & { title.tex: revert to standard oasis text


required by OASIS

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@129} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3fea788 & 28 Nov 2013 & mstsirkin & { content.tex: split virtio-ring out


Split virtio_ring.h out to a separate file.
Required by OASIS (though not a strict requirement
for non-normative definitions like this one).

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@130} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
41b7ad4 & 28 Nov 2013 & mstsirkin & { conformance.txt: minimal placeholder


We should make it clearer later, for now this should
be enough for the CSD 1.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@131} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
43d0c1a & 28 Nov 2013 & mstsirkin & { introduction.tex: make keywords upper-case


This seems to be the consensus.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@132} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6592e22 & 01 Dec 2013 & mstsirkin & { title.tex: remove list of related specifications


Has a typo and it's empty anyway.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@133} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3059e55 & 01 Dec 2013 & mstsirkin & { title.tex: add specification URIs


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@134} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
bacf3ab & 01 Dec 2013 & mstsirkin & { title.tex: prettify slightly


Remove an ugly vfill, nicer to have space at bottom of page.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@135} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e061239 & 01 Dec 2013 & mstsirkin & { title.tex: comment out unused text


We don't have related work and xml namespaces, so
comment them out.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@136} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3ae39a6 & 01 Dec 2013 & mstsirkin & { abstract.tex: add abstract


move it out of introduction.tex, use \textbackslash input
to avoid duplication. Fix a minor typo (the the).

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@137} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
885de8b & 01 Dec 2013 & mstsirkin & { title.tex: add abstract


import from abstract.tex

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@138} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3db30db & 01 Dec 2013 & mstsirkin & { introduction.tex: import abstract


import abstract from abstract.tex

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@139} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7f40233 & 01 Dec 2013 & mstsirkin & { tex: rename file


Rename virtio-v1.0-csd01.tex to virtio.tex,
so we don't have to rename before use.
Use --jobname for output.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@140} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9ede441 & 01 Dec 2013 & mstsirkin & { html: rename file


htlatex doesn't seem to support -jobname for output
file name, so simply rename file before processing.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@141} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
823702f & 01 Dec 2013 & mstsirkin & { tex: tweak generated output file names


Tweak output to match oasis requirements.
Make it possible to specify output name through
environment, and set draft stage and version
automatically.

Add script to export all files in a zip archive.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@142} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7956aca & 01 Dec 2013 & mstsirkin & { title.tex: fix typo in macro usage


missing \textbackslash 

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@143} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6c27c89 & 01 Dec 2013 & mstsirkin & { tex: fix links in generated html


Use \textbackslash urldef to make them expand macros.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@144} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f37b614 & 02 Dec 2013 & rusty & { Terminology: Device and driver, not host and guest.


We've mixed both together, whereas from a spec-reader point of view,
"driver" and "device" is probably clearer.

CCW part incorporated:

  Switch the parts of the virtio-ccw specification that did not already
  to device/driver instead of guest/host. For more general discussions,
  host/guest is kept (like when talking about guest<->host notifications
  in general). This should make things more consistent.

  Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@145} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b03fa34 & 02 Dec 2013 & rusty & { pci: fix config notify bit.


The Linux code uses 0x2, so I assume second lowest bit is right...

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@146} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
212c0cf & 02 Dec 2013 & rusty & { Specify requirements more clearly.


The spec language is mostly written with a view to driver authors, and
contains assumptions, eg:

	The Device Status field is updated by the OS and driver...

But the spec is for both device and driver authors.  It should specify
exactly what is to be done, and by whom, eg:

	The driver MUST update the Device Status field...

1) Change from passive to active (eg "foo must be reset" => "driver
   must reset foo").

2) Upcase SHOULD, MUST etc.  There are probably more that I missed.

3) Make the following requirements explicit:
   - The driver must not clear device status bits.
   - Make bad on looped descriptors explicit.
   - Driver must not set VRING_DESC_F_INDIRECT unless negotiated feature.
   - Available/used ring sections rewritten to be more explicit that driver
     must not set VRING_AVAIL_F_NO_INTERRUPT.
   - Following device initialization sequence is a MUST.
   - Driver must not continue initialization if it sets FAILED.
   - "memory barriers" are now a MUST, though the weasel-word "suitable"
     was added.
   - Driver MUST notify device.

4) Misc changes:
   - Use "device offers" / "driver accepts" language for feature negotiation.
   - config space always uses little-endian, remove 'generally'.
   - "descriptor chain" term used everywhere.
   - Extraneous "+" deleted.
   - Remove "Unless explicitly specified otherwise" from PCI spec endian
     sentence.
   - Refer to notify_off_multiplier in queue_notify_off discussion.

Signed-off-by: Rusty Russell <rusty@au.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@147} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
69bf4d8 & 02 Dec 2013 & rusty & { latexify document more.


This change:

- Turns formatted lists into real lists (itemize, etc).

- Turns ascii tables into real tables.

- Use \textbackslash ldots for ...

- Moves \textbackslash footnote to immediately after what it refers to, otherwise we
  get awkward whitespace before the superscript.

- List of stats for balloon contains values in () to match other lists.

- Puts lstlisting around CCW code example

- Cross references to numbered steps, rather than hardcoded (2) etc.

No actual contents changed.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@148} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b20c81b & 02 Dec 2013 & mstsirkin & { content.tex: fix html build


_ should not be used in labels

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@149} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1bcdb95 & 02 Dec 2013 & mstsirkin & { tex: s/item:/itm:/


It is preferable to use standard prefixes for labels, in case
we ever want to use fancyref.
See \url{http://en.wikibooks.org/wiki/LaTeX/Labels_and_Cross-referencing}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@150} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6195eab & 02 Dec 2013 & mstsirkin & { tex: fix some urls


replace 1.0 with v1.0
make urls work correctly in html

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@151} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fee371b & 03 Dec 2013 & rusty & { 4.1.2.5: Make table clearer


As suggested by Cornelia Huck.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@152} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4373909 & 03 Dec 2013 & rusty & { Formatting repair as per Chet's feedback.


1) Populate TC member list.
2) Remove Non-Normative References section
3) Fix URLs to point to correct place.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@153} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
827569a & 03 Dec 2013 & rusty & { Remove suggestion to use old virtualization list for number assignment.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@154} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f0acc42 & 03 Dec 2013 & mstsirkin & { acknowledgements.tex: tweak MST's name


I prefer it when the S. initial is included.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@155} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
900a539 & 03 Dec 2013 & rusty & { More formatting fixes from Chet's suggestions:

1) Indented pdf subtitles correctly.
2) Correct wording for public review drafts
3) Include footnote html files.
4) "approved by VIRTIO" not "members of OASIS"
5) "OASIS Standard" in citation section changed to depend on filename.
6) URL in citation section fixed.
7) Footnotes in HTML version are all consecutively numbered.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@156} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ef81473 & 03 Dec 2013 & mstsirkin & { virtio-html.tex: add hrulefill before each chapter


Same as we have in PDF.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@157} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9c176a8 & 03 Dec 2013 & mstsirkin & { title.tex: fix citation format as suggested by Chet


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@158} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
87cf45b & 03 Dec 2013 & mstsirkin & { title.tex: add space before and after URLs


Something seems to eat up space right before and after a urldef
call unless we protect it with \{ \}.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@159} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
07675d4 & 08 Dec 2013 & mstsirkin & { remove .txt format file


It's out of date anyway by now

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@160} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f53432c & 08 Dec 2013 & mstsirkin & { makeall.sh: support generating archive from svn


Not everyone's using git ...

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@161} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f134829 & 08 Dec 2013 & mstsirkin & { REVISION: virtio v1.0 csd01


This version was approved as v1.0 csd01
on Tue, Dec 03, 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@162} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b1fdac3 & 08 Dec 2013 & mstsirkin & { makeall.sh: take revision from REVISION by default


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@163} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c3d56c3 & 08 Dec 2013 & mstsirkin & { REVISION: virtio-v1.0-csprd01


This revision was approved at VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@164} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f4fcdbf & 08 Dec 2013 & mstsirkin & { REVISION: wd02


As we are working towards csd02, change default
spec file name.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@165} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5839d2c & 08 Dec 2013 & mstsirkin & { net: add _F_MQ support


VIRTIO-49

Includes git commits:

3c600996f641614d3720c94dd52155aaaba670fa
    virtio-spec: fix two typos
commit 67023431c8796bc430ec0a79b15bab57e2e0f1f6
    virtio-spec: virtio network device multiqueue support
commit a02d91f8729b4a333d525015d22138a86ce9b644
    net: add note that you can defer rx queue init until mq enable.

Approved Dec 3, 2013

Reported-by: Francesco Fusco <ffusco@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@166} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
df64d9b & 08 Dec 2013 & mstsirkin & { net: document VIRTIO_NET_F_MAC_ADDR


VIRTIO-50

commit f058954d131e3dc73058778ad23b241a235ae8e1
    virtio-spec: set mac address by a new vq command

Approved Dec 3, 2013

Reported-by: Francesco Fusco <ffusco@redhat.com>
Signed-off-by: Amos Kong <akong@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@167} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
99d4a38 & 08 Dec 2013 & mstsirkin & { commands-pdf.tex: align title page


Section titles are currently misaligned on the title
page. This patch aligns them back.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@168} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ff21900 & 08 Dec 2013 & mstsirkin & { virtio-html: add right and left borders for tables


In html version our tables lack vertical separators,
that's ugly. Tweak config file for htlatex to add these.
htlatex wants to use hr for horizontal separation
(presumably for portability?)
So add only vertical borders using CSS.

Note: pdf version has a dual line after 1st column
in each row, I didn't figure out how to make this
with htlatex yet.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@169} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
da510aa & 09 Dec 2013 & hornet & { 2.3.2 MMIO: LaTeXisation


Converter the register layout descriptions into
tables.

Also hardened the specification language, using
MUSTs and MUST NOTs.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@170} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7f8b3f7 & 12 Dec 2013 & cornelia.huck & { ccw: Tighten specification language.


must -> MUST changes, removed inappropriate mays.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@171} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
adc597e & 12 Dec 2013 & cornelia.huck & { ccw: clarify passing of subchannel id


Make clear that the upper half of the register must be ignored, just
like normal I/O instructions do.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@172} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6d98c36 & 12 Dec 2013 & cornelia.huck & { ccw: feature bit endianness


In contrast to the other values transmitted in ccw payload, feature bits
are little endian. Fix it in the structure definition.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@173} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3801029 & 12 Dec 2013 & hornet & { 2.3.2 MMIO: Further clarifications


Clarified driver behaviour for out-of-spec MagicValue,
Version and DeviceID values.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@174} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c091f00 & 12 Dec 2013 & hornet & { 1. Introduction: Removed left-over "PCI"


The "Extensible" paragraph of the introduction still
referred to "Virtio PCI devices". Changed to
"Virtio devices".

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@175} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fb2e84d & 12 Dec 2013 & hornet & { 2.3.2 MMIO: Notifications \& interrupts clarifications


(Hopefully) clarified the way notifications are being
passed between the device and the driver and about
the meaning of the interrupt registers.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@176} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6620a37 & 16 Dec 2013 & hornet & { 2.3.2 MMIO: Configuration space offset corrected


The offset in the MMIO configuration space description
(table 4.1) became wrong at some time (0x0fff). Fixed.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@177} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7b8f0d5 & 16 Dec 2013 & hornet & { title \& acknowledgements: Make ARM less limited


... by removing the "Limited" bit of the name.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@178} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5683834 & 03 Jan 2014 & hornet & { mmio: Obviously wrong notification register name


The "4.2.3.3 Notifying The Device" section said "writing
the index of the updated queue to the QueueNum". This
is obviously wrong - should read "QueueNotify".

Signed-off-by: Pawel Moll <pawel.moll@arm.com>



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@179} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6d6fc82 & 12 Jan 2014 & mstsirkin & { .exrc: rename to _vimrc


.exrc is not allowed in the OASIS Library, since "dot" files are
special files in file system.

They are specifically disallowed by the Naming Directives [1] :
"Filenames and directory names must neither begin nor end with a
punctuation character (period or hyphen). [...]"

Rename to _vimrc which also works - from vim help:

     d. If the 'exrc' option is on (which is not the default),
	the current directory is searched for three files.
	The first that exists is used, the others are ignored.
        -  The file ".vimrc" (for Unix, Amiga and OS/2) (*)
                    "_vimrc" (for MS-DOS and Win32) (*)
        -  The file "_vimrc" (for Unix, Amiga and OS/2) (*)
                    ".vimrc" (for MS-DOS and Win32) (*)
        -  The file ".exrc"  (for Unix, Amiga and OS/2)
                    "_exrc"  (for MS-DOS and Win32)

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@180} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
36937d0 & 12 Jan 2014 & mstsirkin & { README: note on issues and work-arounds


Document that makehtml needs to be edited to
use workaround.
Document that paths need to be adjusted if copying
config from an old installation.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@181} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
59bc2cd & 12 Jan 2014 & mstsirkin & { makehtml.sh: drop workaround, add warning


Issues in html generation turn out to be
due to tex4ht being unable to find fonts due to
misconfigured font paths.

As we are unable to work-around them properly anyway
replace work-around with a warning and print suggestions
for fixing the config.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@182} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f979d4b & 12 Jan 2014 & mstsirkin & { html: Convert ligatures into normal ASCII character


Seems to work for me, although I don't know exactly why (I have a
feeling, but no proof ;-)

Signed-off-by: Pawel Moll <pawel.moll@arm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@183} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c6ee628 & 17 Jan 2014 & rusty & { Fixes for first WD front page.


Based on feedback from Paul Knight <paul.knight@oasis-open.org>.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@184} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1d94b5b & 17 Jan 2014 & rusty & { net/multiqueue: tighten wording


Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@185} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
761fadc & 17 Jan 2014 & rusty & { Feedback file for virtio-comment.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@186} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
87943ef & 20 Jan 2014 & mstsirkin & { html: make footnotes inline


Makes text search easier and reduces clutter in the
public directory.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@187} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
27b1466 & 21 Jan 2014 & rusty & { feedback.txt: update


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@188} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
75f991b & 21 Jan 2014 & rusty & { Split feedback into multiple files.


Makes it easier to edit/apply individual proposals.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@189} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6779caf & 23 Jan 2014 & rusty & { Michael's patch adding MQ support added some u16s; they are u16 in

legacy mode but should be le16 for modern devices.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@190} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f324e9e & 23 Jan 2014 & rusty & { Formatting: fix feature bits for console device.


Make them a description list like every other device.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@191} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0cc124a & 23 Jan 2014 & rusty & { More feedback.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@192} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
336c83c & 23 Jan 2014 & cornelia.huck & { virtio-ccw: fix set_revision payload definition


The members of struct virtio_rev_info are big endian: use be16 types.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@193} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
30277c0 & 28 Jan 2014 & hornet & { mmio: Move QueueReady register from offset 0x03c to 0x044


Legacy devices have QueueAlign register at 0x03c. To stay
on the safe side and avoid any potential clashes (also to
be able to abort any wrong writes), move it to previously
unused offset 0x044.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@194} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ad65a92 & 29 Jan 2014 & rusty & { Feedback \#1: fixes from Thomas Huth


Document: virtio-v1.0-csprd01
Number: 1
Date: Fri, 10 Jan 2014 11:01:44 +0100
Link to Mail: \url{https://lists.oasis-open.org/archives/virtio-comment/201401/msg00000.html}
Commenter name: Thomas Huth <thuth@linux.vnet.ibm.com>

Approved at meeting: 2014-01-28
	\url{https://lists.oasis-open.org/archives/virtio/201401/msg00054.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@195} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0776749 & 29 Jan 2014 & rusty & { Feedback \#2: More feedback from  Thomas Huth


Document: virtio-v1.0-csprd01
Number: 2
Date: Fri, 10 Jan 2014 13:49:49 +0100
Link to Mail: \url{https://lists.oasis-open.org/archives/virtio-comment/201401/msg00001.html}
Commenter name: Thomas Huth <thuth@linux.vnet.ibm.com>

Approved at meeting 2014-01-28:
	\url{https://lists.oasis-open.org/archives/virtio/201401/msg00054.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@196} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6ba5d27 & 29 Jan 2014 & rusty & { Feedback \#3: Feedback from Pranavkumar Sawargaonkar (VIRTIO_CONSOLE_F_EMERG_WRITE)


Document: virtio-v1.0-csprd01
Number: 3
Date: Tue, 21 Jan 2014 15:09:54 +0530
Link to Mail: \url{https://lists.oasis-open.org/archives/virtio-comment/201401/msg00037.html}
Commenter name: Pranavkumar Sawargaonkar <pranavkumar@linaro.org>

Approved at meeting 2014-01-28:
	\url{https://lists.oasis-open.org/archives/virtio/201401/msg00054.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@197} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4c16cda & 29 Jan 2014 & hornet & { 4.1.2.5: Legacy: PCI Device Layout: fix PCI header fields order


The order of the fields in the legacy PCI header seems to get
messed up in the new spec, with the "Queue Address" moved
behind "Queue Notify". According to the 0.9.5 version of the spec
it should be:

* Device Features 32
* Driver Features 32
* Queue Address 32
* Queue Size 16
* Queue Select 16
* Queue Notify 16
* Device Status 8
* ISR Status 8

Signed-off-by: Pawel Moll <pawel.moll@arm.com>

-- 
1.8.3.2



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@198} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fa593d8 & 31 Jan 2014 & rusty & { Feedback: document decisions in the files.


I also sent out a thankyou mail for these.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@199} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
56492ea & 31 Jan 2014 & rusty & { Feedback \#4:  Haggai Eran's VIRTIO_RING_F_INDIRECT_DESC fix.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@200} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
97776cc & 31 Jan 2014 & rusty & { 3.2.1: Language tightening.


1) Lots of "we", replace with "the driver".
2) Use MAY and MUST NOT for spurious notifications.
3) Don't refer to PCI configuration space for notification.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@201} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c178e0f & 03 Feb 2014 & rusty & { More feedback.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@202} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
87ef649 & 06 Feb 2014 & rusty & { whitespace: make all examples unindented, and avoid tabs.


This makes the formatting far nicer.  Applying now as it touches almost
all examples and layouts, so we can rebase future changes on top of
common ground.

(Based on feedback from Thomas Huth for one example, and generalized).

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@203} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
35edda9 & 07 Feb 2014 & rusty & { block: legacy SCSI command fix.


When describing the historical layout requirements, it says
 "status field is a separate read-only buffer of size 1 byte, by itself."

That's clearly wrong, as it says above "The final status byte is written by the device"

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@204} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
889af3e & 07 Feb 2014 & rusty & { More feedback from Thomas.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@205} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b41c0ea & 07 Feb 2014 & rusty & { More feedback (partial)


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@206} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c02a47b & 07 Feb 2014 & rusty & { Cleanup and setup clarifications


1) Explicitly allow drivers to read config space during feature
   negotiation.

2) Add the concept of a "live" virtqueue, and explicitly disallow
   moving it backwards or changing descriptors.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@207} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6590c3b & 09 Feb 2014 & rusty & { More feedback updates from Thomas.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@208} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4bd4aaf & 10 Feb 2014 & rusty & { ccw: missed field conversions


Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@209} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
928d384 & 10 Feb 2014 & rusty & { Feedback: more introduction reworking from MST.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@210} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
27fd1f8 & 10 Feb 2014 & rusty & { Feedback: more clarity on aim of ring layout \& cache effects.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@211} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5017ce7 & 10 Feb 2014 & rusty & { C struct specifications.


Explicitly specify that our C struct specifications are without padding,
and add some definitions for our integer data types.

[ Rusty - added /* comments */ and removed redundant old le* explanation ]

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@212} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
992110f & 10 Feb 2014 & rusty & { PCI Section Rework


1) Minor changes from must to MUST etc.
2) More references using \textbackslash ref.
3) Move section on capabilities first, before we talk about the common
   config layout.  The previous order made sense for legacy.
4) Make explicit subsections for each type of capability and move more
   information into them.
5) Make it clear that there must be one or more.
6) Include 'struct virtio_pci_cap cap;' in struct virtio_pci_cfg_cap to
   match virtio_pci_notify_cap.
7) Explicitly note there's no way to negotiate the queue size for a
   legacy device.
8) Fix old language on config change event: config is not in the pci
   configuration space.
9) Explicitly state what the driver should do to use virtio_pci_cfg_cap.

Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@213} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
83e2126 & 10 Feb 2014 & rusty & { patch feedback-4.patch


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@214} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
82ef43b & 10 Feb 2014 & rusty & { patch feedback-5.patch


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@215} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
393b73e & 10 Feb 2014 & rusty & { patch feedback-6.patch


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@216} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9d7baf4 & 10 Feb 2014 & rusty & { patch feedback-7-orig.patch


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@217} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
261e83f & 10 Feb 2014 & rusty & { example code does not have to be optimal but it

seems cleaner to disable interrupts after we
recheck the ring empty state.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@218} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4f1ad91 & 10 Feb 2014 & rusty & { We'll add more non-normative sections with hints for

implementing registers such as PCI class, status
and command registers.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@219} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b374dba & 10 Feb 2014 & rusty & { feedback: s/virtio header/virtio common configuration/


While most places now sat virtio common configuration
structure, some places still use the term virtio header.
Since it's not necessarily before the
common configuration anymore, rename it
to virtio common configuration structure for consistency.

Cc: Arun Subbarao <asubbarao@lnxw.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@220} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
173247e & 10 Feb 2014 & rusty & { patch feedback-8-5.patch


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@221} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b60e6fe & 10 Feb 2014 & rusty & { patch feedback-8-6.patch


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@222} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
25665bb & 10 Feb 2014 & rusty & { patch feedback-8-7.patch


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@223} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b140ac4 & 10 Feb 2014 & rusty & { patch feedback-8-9.patch


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@224} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fc645a1 & 10 Feb 2014 & rusty & { REVERT LAST 15 JUNK COMMITS.


Back to r211.  It's been a long day.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@225} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3de864b & 10 Feb 2014 & rusty & { Feedback: update so it applies sequentially.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@226} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5840d9b & 10 Feb 2014 & rusty & { Merge together all feedback from Arun.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@227} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4870127 & 11 Feb 2014 & rusty & { Feedback: fix formatting typo.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@228} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
60772f6 & 11 Feb 2014 & rusty & { Feedback: minor clarity update from Thomas.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@229} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f5e6f14 & 11 Feb 2014 & rusty & { feedback: add more replacements of read-only.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@230} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3333466 & 12 Feb 2014 & rusty & { C struct specifications.


Explicitly specify that our C struct specifications are without padding,
and add some definitions for our integer data types.

[ Rusty - added /* comments */ and removed redundant old le* explanation ]

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@231} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
bd9d0bb & 12 Feb 2014 & rusty & { PCI: rearrange it all


This is the re-arrangement originally suggested by Rusty,
except I made some fixes and also tweaked a couple of places
where behaviour changes where suggested - if we want these,
they should go in separately.

Rearrange discovery section to make it clearer what goes on.
Wording changes MUST/MAY/etc.  Clarify cfg gateway use.  No
behavioural changes.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@232} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e3b0412 & 12 Feb 2014 & rusty & { PCI: rearrange it all


This is the re-arrangement originally suggested by Rusty,
except I made some fixes and also tweaked a couple of places
where behaviour changes where suggested - if we want these,
they should go in separately.

Rearrange discovery section to make it clearer what goes on.
Wording changes MUST/MAY/etc.  Clarify cfg gateway use.  No
behavioural changes.

[ Merged "fixup! PCI: rearrange it all" --RR ]

As per minutes:
        \url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@233} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b08cb60 & 12 Feb 2014 & rusty & { PCI: minor changes for previous patch.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@234} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
eb1dc6c & 12 Feb 2014 & rusty & { Feedback \#4: applied.


As per minutes:
	\url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@235} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3a77190 & 12 Feb 2014 & rusty & { Feedback \#5: Applied.


As per minutes:
	\url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@236} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
908cfaa & 12 Feb 2014 & rusty & { Feedback \#6: Applied


As per minutes:
	\url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@237} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
69678f4 & 12 Feb 2014 & rusty & { Feedback \#7: Applied


Some minor merging required.

As per minutes:
    \url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@238} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
86e2b45 & 12 Feb 2014 & rusty & { Feedback \#8: Applied.


[ Includes fixup! removing MSI-X ]
As per minutes:
        \url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@239} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ad640ee & 12 Feb 2014 & rusty & { PCI: consistent device/PCI configuration space


Re section:
4.1.3.4 Notification of Device Configuration Changes

Feedback:
	Please use "PCI configuration space" and "device configuration
	state" consistently, without abbreviation. For example, from the
	first sentence it looks like "device configuration state" can be
	changed, but the first bullet claims it's "configuration space".
	So, which one? Does "configuration space" mean "PCI configuration
	space" or is it a synonym for "device configuration state"?
	Because those are two different things; the driver needs to know
	what exactly to rescan.

As per minutes:
        \url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Cc: Arun Subbarao <asubbarao@lnxw.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@240} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3df7d74 & 12 Feb 2014 & rusty & { PCI: explicitly document ISR status field


Feedback on ISR status register:
	It would be helpful if this section provided the meaning of each
	bit in the register.

ISR use is scattered all around the place.
Add a section describing the format and semantics.

[ Merged to combine with new ISR-specific section --RR ]

As per minutes:
        \url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Cc: Arun Subbarao <asubbarao@lnxw.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@241} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
82ee05b & 12 Feb 2014 & rusty & { ccw: Further use of RFC2119 language.


Some more instances of MAY and SHOULD, as reported in TAB comments
TAB-548 and TAB-550.

As per minutes:
        \url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@242} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0060905 & 12 Feb 2014 & rusty & { Fix S390 normative references.


As pointed out in TAB-539 and TAB-540:


- Add an URL to the documents. (Unfortunately, there is no link that
  always points to the latest version.)

- State that we include any future revisions as well.

As per minutes:
        \url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@243} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8519c6e & 12 Feb 2014 & rusty & { VIRTIO-55: Add a reserved ID for GPU devices


As existing work on virtio-gpu is using device ID 16, reflect this in
the spec. This closes out VIRTIO-55.

As per minutes:
        \url{https://lists.oasis-open.org/archives/virtio/201402/msg00121.html}

Signed-off-by: Paul Mundt <paul.mundt@huawei.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@244} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
eeeef4a & 12 Feb 2014 & mstsirkin & { abstract: address lnovich comment


lnovich@redhat.com suggested rewording abstract,
making the following point:

. from what point of view is virtio like a physical device?
  it's very different from host POV
. "the guest" appears out of nowhere. It's the guest that runs
  in the vm of course.
. "not all that different" means similar so there's not need to
  be verbose

Address this comment

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@245} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
af89066 & 12 Feb 2014 & mstsirkin & { introduction: address lnovich comments


generally list of buses is out of date, list all supported buses.
Drop explicit mention of lguest since it's not part of the spec.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@246} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b06c313 & 12 Feb 2014 & mstsirkin & { content: more strict confirmance language


Correct new language to explicitly use MAY/SHOULD/MUST
in more places or simply drop the somewhat vague "can" where
we are describing the only way to operate the device.
Most of the changes are in the PCI section.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@247} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ed5fcb7 & 12 Feb 2014 & mstsirkin & { PCI: minor wording change


Since access width requirement is a confirmance clause, make it
explicit that it applies to 4,2 and 1 byte fields.
Also explain what happens to fields of other widths (such as
the 6 byte MAC).

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@248} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1da6ff0 & 13 Feb 2014 & cornelia.huck & { ccw: padding annotations


Remove __packed__ annotation from all ccw structures that don't need it,
and make the length requirements explicit for those that do.

This is the part of the patch to resolve VIRTIO-56 that had been missed.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@249} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
23b092a & 19 Feb 2014 & rusty & { net: fix incorrect reference.


It pointed into the block section for some reason.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@250} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
65c4282 & 19 Feb 2014 & rusty & { Gratuitous Packet Sending: clarify wording.


The device can ask, not the driver.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@251} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1cb300f & 20 Feb 2014 & rusty & { SCSI: missing space.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@252} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e6d2600 & 26 Feb 2014 & rusty & { SCSI: fix up more fields.


Some missing \textbackslash field\{\} markings, and a few redundant "the XXX field".

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@253} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fe9ec9c & 26 Feb 2014 & rusty & { feedback: minor wording cleanups


We already mention requirement for natural width
accesses for non device specific configuration.
Don't repeat this in legacy section.

Further, mention virtio pci structure in
preamble to help link sections together.

Cc: Arun Subbarao <asubbarao@lnxw.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

Conflicts:
	content.tex

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@254} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
22c616e & 26 Feb 2014 & rusty & { PCI: better document driver and device requirements


Feedback:
10) 4.1.3.1.2 Queue Vector Configuration
Some of the information from section 8.4 needs to be moved to
here, for example that the device may have an MSI-X table size
other than 2048.
Otherwise, this reads as though the MSI-X table must always have
2048 entries.

11) Please explicitly describe the device behavior when writing
a vector value beyond the MSI-X table size.

Address these comments.

Cc: Arun Subbarao <asubbarao@lnxw.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@255} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
60549f6 & 26 Feb 2014 & rusty & { Feedback: TAB-557 Spelling errors, etc (VIRTIO-75)


Reported-by: Patrick Durusau <patrick@durusau.net>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@256} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
cf4c71d & 26 Feb 2014 & rusty & { Feedback: TAB-555 Bad sub-sectioning (VIRTIO-80)


Reported-by: Patrick Durusau <patrick@durusau.net>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@257} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4aeb418 & 26 Feb 2014 & rusty & { Feedback: Bug TAB-553 (VIRTIO-76)


Haven't marked them non-normative yet, but it makes sense to put the header
in an appendix.

Reported-by: Patrick Durusau <patrick@durusau.net>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@258} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2cea64e & 26 Feb 2014 & rusty & { Feedback: move new device design section to Appendix.


It's non-normative.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@259} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
159a2f5 & 26 Feb 2014 & rusty & { Feedback: use proper list in introduction (VIRTIO-82)


Also avoid extra spacing before footnote markers.

Reported-by: Patrick Durusau <patrick@durusau.net>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@260} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a774e43 & 26 Feb 2014 & rusty & { Feedback: add old draft to normative references (VIRTIO-77)


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@261} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
86775fe & 26 Feb 2014 & rusty & { Feedback: hoist the one legacy-related requirement out of legacy section.


This requirement applies to any system which *did* have legacy drivers.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@262} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0ab234c & 26 Feb 2014 & rusty & { Feedback: move legacy/transitional definitions into terminology.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@263} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
86e4e22 & 26 Feb 2014 & rusty & { Feedback: 2.1 Device Status field: Separate description from normative.


Start with explanation, progress to normative requirements.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@264} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b789c0a & 26 Feb 2014 & rusty & { Feedback: add normative marker.


From \url{http://docs.oasis-open.org/templates/TCHandbook/ConformanceGuidelines.html:}
   Normative statements MUST be referenceable so that a statement may be
   referenced from another part of a specification, but more importantly
   so they can be referenced from Conformance Clauses.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@265} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e14bfc9 & 26 Feb 2014 & rusty & { Feedback: split Basic Facilities feature bits and config space into normative.


Split text into descriptive and normative.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@266} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5421a41 & 26 Feb 2014 & rusty & { Feedback: Normative split in Basic Facilities of a Virtio Device / Virtqueues


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@267} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b3693e3 & 26 Feb 2014 & rusty & { Feedback: Normative split for Basic Facilities of a Virtio Device / Virtqueues / Message Framing


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@268} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
051f9aa & 26 Feb 2014 & rusty & { Feedback: Separate the rest of chapter 2 into normative vs explanatory.


The big change here is in introducing new subsections for interrupt and notification
suppression, and moving all requirements into them.

The example processing loop is also moved into a note, to show clearly
that it's not normative.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@269} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1936b9f & 26 Feb 2014 & rusty & { Feedback: PCI: Separate explanatory and normative text.


Rather than treat selectors 0 and 1 as special, the wording for features
is made more general (though still the same effect).

I split the interrupt handler into a separate subsection: it was
misleading because it didn't handle configuration interrupts until
the next section.  It's also non-normative.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@270} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
56edc8c & 26 Feb 2014 & rusty & { Feedback: MMIO: Separate normative and descriptive text.


The section on initialization is now non-normative.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@271} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9a53e4d & 26 Feb 2014 & rusty & { Feedback: CCW: Separate normative and descriptive sections.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@272} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
234e04b & 26 Feb 2014 & rusty & { Feedback: net: separate normative and instructional text.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@273} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b968a39 & 26 Feb 2014 & rusty & { Feedback: block: separate normative and descriptive text.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@274} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4d981d1 & 26 Feb 2014 & rusty & { Feedback: console \& entropy: separate normative and descriptive texts.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@275} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d29e270 & 26 Feb 2014 & rusty & { Feedback: SCSI: Separate normative and descriptive texts.


This could use some more rigour, I think: there are still many
implied requirements which could be called out.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@276} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3a0f76c & 26 Feb 2014 & rusty & { Feedback: Separate normative requirements for Reserved Feature Bits.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@277} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
984f94b & 26 Feb 2014 & rusty & { Feedback: VIRTIO-77 Conformance clause.


Now we have grouped all the normative statements, the conformance
clauses for drivers and devices can simply reference them.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@278} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ddfe8c9 & 26 Feb 2014 & rusty & { VIRTIO-28: Deprecate balloon device, add number for new one.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@279} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ce25e7b & 26 Feb 2014 & rusty & { VIRTIO-45: Add a reserved ID for Timer/Clock device


Just add a reserved ID for Timer/Clock device. There is no work
on it yet but it is nice to have the ID which could be used safely
in preliminary implementations.

Signed-off-by: Daniel Kiper <daniel.kiper@oracle.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@280} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2a75834 & 26 Feb 2014 & rusty & { ccw: Fix requirements for processing adapter interrupts.


We currently mandate that the driver clears the summary indicator
before processing the queue indicator; this is bogus, as the requirement
for interrupt avoidance is rather that the driver unsets the summary
indicator before before it stops looking at the queue indicator.

In fact, the best way to get a race-free implementation of the interrupt
handler is to process the queue indicators twice; let's add a recommondation
to do that.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com> (merged)

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@281} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
490ccb6 & 26 Feb 2014 & cornelia.huck & { introduction: typo in terminology section


s/device/driver/ for the transitional driver description.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@282} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3745a61 & 26 Feb 2014 & hornet & { mmio: Fix Device Tree example


Minor fix: the size of 0x100 was obviously wrong,
as it didn't allow for configuration space.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@283} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
768063f & 26 Feb 2014 & hornet & { mmio: Fix double register macro


Minor fix: commit 238 wrapped register names in \textbackslash field\{\}s
and modified one of the register table macros, but missed
the other one.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@284} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5223bff & 26 Feb 2014 & hornet & { mmio: Clarify normative requirement on QueueNum


Minor fix: add explicit reference to QueueNumMax in the
normative paragraph describing QueueNum.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@285} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
46b77c2 & 27 Feb 2014 & rusty & { Fixed path of linux version of virtio_ring.h


Signed-off-by: Holm Rauchfuss <holm.rauchfuss@huawei.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@286} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
77f7e6a & 02 Mar 2014 & mstsirkin & { drop /* LEGACY version was not little endian */


Two issues with the comment:
	- it mixes legacy documentation in main part of the spec
	- it says what format *isn't* - instead of what it *is*
Now that we have documented that LE can mean
legacy endian, there's no need for the comment.

Resolves issues:
	VIRTIO-58

Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@287} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e0c73f5 & 02 Mar 2014 & mstsirkin & { content: explain that legacy support is optional


Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@288} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
61e9694 & 02 Mar 2014 & mstsirkin & { legacy: clarify general note on endian-ness


Change accepted on VIRTIO TC Meeting, 3 December 2013

this is a non normative section.
we merely mention that details are given
for each device.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@289} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f0b0069 & 02 Mar 2014 & mstsirkin & { Legacy Interface: Device Configuration Space


Change accepted on VIRTIO TC Meeting, 3 December 2013

legacy has no generation field.
add SHOULD statement to document multi-byte field
access rules.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@290} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2cb11d1 & 02 Mar 2014 & mstsirkin & { legacy: make note on legacy VQ endian-ness normative


Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@291} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1c8e63c & 02 Mar 2014 & mstsirkin & { legacy: make message framing normative


Change accepted on VIRTIO TC Meeting, 3 December 2013

TODO: we really should be more specific

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@292} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c8d6408 & 02 Mar 2014 & mstsirkin & { legacy pci layout: confirmance statements


Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@293} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4b7a5dc & 02 Mar 2014 & mstsirkin & { legacy pci layout: extra confirmance statement


Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@294} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ea07d76 & 02 Mar 2014 & mstsirkin & { leacy: layout detection confirmance


Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@295} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6c55d86 & 02 Mar 2014 & mstsirkin & { legacy feature bits: confirmance statements


Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@296} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c560b6f & 02 Mar 2014 & mstsirkin & { legacy: make all notes on endian-ness confirmance clauses


Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@297} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
53b9bba & 02 Mar 2014 & mstsirkin & { legacy virtqueue layout: confirmance


Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@298} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b4072ed & 02 Mar 2014 & mstsirkin & { legacy device initialization: confirmance statements


Change accepted on VIRTIO TC Meeting, 3 December 2013

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@299} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6b0a544 & 02 Mar 2014 & mstsirkin & { conformance: document two types of devices


Change accepted on VIRTIO TC Meeting, 3 December 2013

document that there are two conformance levels

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@300} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
df9e9d2 & 02 Mar 2014 & mstsirkin & { non-transitional devices with legacy drivers


Change accepted on VIRTIO TC Meeting, 3 December 2013

weaken hacky requirements helpful for graceful failure
for non transitional PCI devices from MUST to SHOULD.
It's nice to have but it's not like it makes things work, and you
can avoid trouble simply by using the most recent drivers.
also move them out to a separate section

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@301} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
423d24a & 02 Mar 2014 & mstsirkin & { introduction: add link to 0.9.5 specification


Change accepted on VIRTIO TC Meeting, 3 December 2013

this version replaces it, so it's a non normative reference.

VIRTIO-69

note: the link is added here but isn't used yet: will be used
when we cleanup terminology definitions, by
addressing VIRTIO-64

Cc: Patrick Durusau <patrick@durusau.net

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@302} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7232c52 & 02 Mar 2014 & mstsirkin & { legacy interface: move to terminology


Change accepted on VIRTIO TC Meeting, 3 December 2013

VIRTIO-64

Cc: Patrick Durusau <patrick@durusau.net

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@303} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
757d875 & 02 Mar 2014 & mstsirkin & { feedback: clarify device status bits


Change accepted on VIRTIO TC Meeting, 3 December 2013

VIRTIO-70

Cc: Patrick Durusau <patrick@durusau.net>

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@304} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0787aaf & 02 Mar 2014 & mstsirkin & { VIRTIO-67: fix html redirects


Change accepted on VIRTIO TC Meeting, 3 December 2013

1. oasis switched to https
2. Red Hat  is www.redhat.com

Cc: Patrick Durusau <patrick@durusau.net>

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@305} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
264a8d9 & 02 Mar 2014 & mstsirkin & { fix rfc2119 reference


Change accepted on VIRTIO TC Meeting, 3 December 2013

VIRTIO-68

Cc: Patrick Durusau <patrick@durusau.net>

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@306} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
64d4d1a & 02 Mar 2014 & mstsirkin & { initialization: minor clarification


Change accepted on VIRTIO TC Meeting, 3 December 2013

"it" could refer to failed bit or the driver.
clarify.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@307} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1bf79ad & 03 Mar 2014 & rusty & { PCI: Tighten requirements.


1) make it clear that queue_enable is 0 on reset.
2) device MUST present a  VIRTIO_PCI_CAP_DEVICE_CFG if needed for type.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@308} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c438d86 & 03 Mar 2014 & rusty & { Use ellipsis (aka \textbackslash ldots) everywhere.


And use the ellipsis package, which makes it symmetrical.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@309} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
67b4254 & 03 Mar 2014 & rusty & { Formatting: use latex-style quoting everywhere.


Doesn't look any different, but consistent.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@310} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
77cb18f & 05 Mar 2014 & mstsirkin & { transitional driver features: fix typos noted by Rusty


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@311} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0a10ee7 & 05 Mar 2014 & mstsirkin & { legacy devices: get rid of MUST assume


as Rusty points out MUST assume is not very good requirement.
clarify it.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@312} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f3d15f2 & 05 Mar 2014 & mstsirkin & { message framing: rusty's comments


generic note on message framing
specific requirements listed for net device only

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@313} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
431a52f & 05 Mar 2014 & mstsirkin & { block: legacy message framing


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@314} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b25b5ba & 05 Mar 2014 & mstsirkin & { legacy message framing: console device


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@315} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
065be53 & 05 Mar 2014 & mstsirkin & { legacy framing: scsi host


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@316} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fd7ba0a & 11 Mar 2014 & mstsirkin & { getchangelog.pl: script to generate changelog


simply output into text file

uses REVISION history to guess revision range

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@317} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
716fe04 & 13 Mar 2014 & rusty & { VIRTIO-81: MUST vs must


Clean up the remaining lowercase "musts".  We actually introduce a
new normative section in the balloon; for the rest we clarify them
one way or another.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@318} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
92c4e78 & 13 Mar 2014 & rusty & { VIRTIO-74: required vs REQUIRED.


Some really are clearest as they are, but most are changed to avoid
confusion.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@319} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
48c20d7 & 13 Mar 2014 & rusty & { VIRTIO-73: MAY/may.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@320} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5b8e984 & 13 Mar 2014 & rusty & { VIRTIO-72: SHOULD/should


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@321} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
09574c6 & 13 Mar 2014 & rusty & { VIRTIO-63: Make sure examples are marked clearly.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@322} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d4f6100 & 13 Mar 2014 & rusty & { VIRTIO-62: Explicit and specific.


Avoid these words where they are redundant.  This also lead me to
notice that we were not consistent in the use of the term
"device-specific configuration" in the PCI section, so cleaned that up
too.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@323} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f702038 & 13 Mar 2014 & rusty & { net: clean up mq definition, receive buf size (VIRTIO-84)


1) Instead of using N-1 everywhere, use N, and start receiveq etc at 1.
   This is less C like, but less confusing in english.
2) Weaken requirements for automatic steering to SHOULD, as otherwise
   we're insisting device record all flows forever.
3) Receive buffers must be able to hold data, so must be > header.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

Conflicts:
	content.tex

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@324} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
44ea291 & 13 Mar 2014 & rusty & { block: deprecate FLUSH_OUT (VIRTIO-85)


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@325} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c4ab14e & 13 Mar 2014 & rusty & { net: make num_buffers field compulsory (VIRTIO-86)


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@326} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
711c774 & 13 Mar 2014 & rusty & { VIRTIO-60: avoid vring and VIRTIO_RING.


These are never introduced, so use simpler names: virtq* for structures
and VIRTIO_ for features.

I added two notes about the old names, for helping people coming from
the old spec.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@327} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6cf21c5 & 13 Mar 2014 & rusty & { title.tex: Change TeX version to be authoritative.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@328} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
bbb9c15 & 13 Mar 2014 & rusty & { title.tex: Reference previous version.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@329} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a03d457 & 13 Mar 2014 & rusty & { Update revision to create Committee Specification Draft 02.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@330} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f100e75 & 13 Mar 2014 & rusty & { Public Review Draft 02.


As approved at meeting 2014-03-11:

	\url{https://lists.oasis-open.org/archives/virtio/201403/msg00044.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@331} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
105c4bb & 13 Mar 2014 & rusty & { REVISION: wd03


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@332} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
feeca25 & 17 Mar 2014 & cornelia.huck & { conformance.tex: fix references to mmio


Both device and driver conformance referred to ccw twice; let's add the
correct mmio references.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@333} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6e7d6e3 & 07 Apr 2014 & mstsirkin & { Revert "conformance.tex: fix references to mmio"


This reverts commit feeca2541850c2e1e03ed5ec3b98a5e75ccb4053.

Revert temporarily so we are back to text matching WD02.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@334} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
51b7fd5 & 07 Apr 2014 & mstsirkin & { Revert "REVISION: wd03"


This reverts commit 105c4bb6ca75fd223bbb4644d214ce21da677da4.

revert temporarily so we are back to text matching wd02

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@335} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c9d3a9a & 07 Apr 2014 & mstsirkin & { make-setup-generated.sh: pick up date from file


If file named DATE is present, pick up date from there.
Useful so people can re-generate the exact output
from TeX.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@336} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b861cd0 & 07 Apr 2014 & mstsirkin & { DATE: set date when draft 02 was voted on


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@337} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1d0d889 & 07 Apr 2014 & mstsirkin & { makeall.sh: reorder zip file generation


in preparation to splitting it up

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@338} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0d72c03 & 07 Apr 2014 & mstsirkin & { makeall: move parts out to makezip.sh


Useful to pack up tex source in a zip file.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@339} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e6872b3 & 07 Apr 2014 & mstsirkin & { README.txt: list relevant files for TeX source


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@340} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ac4c77c & 07 Apr 2014 & mstsirkin & { Revert "Public Review Draft 02."


This reverts commit f100e75c50a3ae77fcce6da75078fbe3f08d5efb.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@341} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d38952d & 07 Apr 2014 & mstsirkin & { title.tex: fix up link to previous version


Previous version is csprd01, not csd01.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@342} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
af2f315 & 07 Apr 2014 & mstsirkin & { title: label previous pdf version as authoritative


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@343} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
50df99d & 07 Apr 2014 & mstsirkin & { maketex.sh: create zip file with fill tex source


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@344} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d5d2f0f & 07 Apr 2014 & mstsirkin & { title.tex: mark tex as authoritative source


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@345} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3a8d313 & 07 Apr 2014 & mstsirkin & { title.tex: drop tex files from Additional files


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@346} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
83521d7 & 07 Apr 2014 & mstsirkin & { title: fix link to arm.com


\url{https://arm.com} goes to a download page not to the company page.
Should be changed to \url{http://www.arm.com}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@347} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
917a0be & 07 Apr 2014 & mstsirkin & { make-setup: prefix "OASIS"


Note that OASIS is also added before Committee Specification
Draft 02 for the csd and before "Committee Specification Draft
02 / Public Review Draft 02" for the csprd.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@348} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d0af331 & 07 Apr 2014 & mstsirkin & { title: set OASIS copyright year to 2014


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@349} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4386505 & 07 Apr 2014 & mstsirkin & { Revert "Update revision to create Committee Specification Draft 02."


This reverts commit a03d4573e95f6769e4e1ecafab5c8e39b7cfb7f7.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@350} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5ab7cbd & 07 Apr 2014 & mstsirkin & { rename  DATE -> REVISION-DATE


makes sure README.txt is first alphabetically

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@351} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
08034a8 & 07 Apr 2014 & mstsirkin & { README.txt: add abstract


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@352} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
05e6d69 & 07 Apr 2014 & mstsirkin & { README.txt: add acknowledgements


Let's be nice to participants.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@353} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5070ef4 & 07 Apr 2014 & mstsirkin & { title.tex: add editors in citation


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@354} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
16a69b4 & 07 Apr 2014 & mstsirkin & { Revert "make-setup: prefix "OASIS""


This reverts commit 1efe46ce1791c7e43940d7f1e2ec0aea8378f670.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@355} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
00b4d3a & 07 Apr 2014 & mstsirkin & { make-setup: prepend OASIS properly


The logic was reverted: it would add OASIS twice,
or never.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@356} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
287ebe2 & 07 Apr 2014 & mstsirkin & { makepdf: remove out file, could be corrupted


makes build more robust

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@357} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a816843 & 07 Apr 2014 & mstsirkin & { makezip: fix cleanups


blow away the zip file, spec file
without extension is never here.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@358} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f5f26cf & 07 Apr 2014 & mstsirkin & { Update revision to create Committee Specification Draft 02.


Now that all technicalities have been fixed, tweak REVISION
back to csd02 so it's easy for people to retrieve.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

(cherry picked from commit a03d4573e95f6769e4e1ecafab5c8e39b7cfb7f7)

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@359} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ec1ffbf & 07 Apr 2014 & mstsirkin & { Public Review Draft 02.


As approved at meeting 2014-03-11:

	\url{https://lists.oasis-open.org/archives/virtio/201403/msg00044.html}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@360} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
dc868bb & 07 Apr 2014 & mstsirkin & { conformance.tex: fix references to mmio


Both device and driver conformance referred to ccw twice; let's add the
correct mmio references.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

(cherry picked from commit feeca2541850c2e1e03ed5ec3b98a5e75ccb4053)

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@361} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f3bcccf & 07 May 2014 & cornelia.huck & { net: fix device conformance sections


For the network device, we had two device normative sections both called
"setting up receive buffers", neither of which was referenced in the
conformance section.

Let's rename the second one to "processing of packets" which seems to
better match the actual contents and reference both of them from the
conformance statement for network devices.

Resolves VIRTIO-97.

Agreed on the 2014/05/06 TC meeting.

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@362} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d14253c & 12 May 2014 & rusty & { VIRTIO-99: Typo fixes.


As passed at meeting 2014-05-06:
	\url{https://lists.oasis-open.org/archives/virtio/201405/msg00016.html}

Reported-by: Thomas Huth <thuth@linux.vnet.ibm.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@363} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
21f3413 & 12 May 2014 & rusty & { VIRTIO-103: PCI: require read-after-write on device_status reset.


As passed at meeting 2014-05-06:
        \url{https://lists.oasis-open.org/archives/virtio/201405/msg00016.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@364} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c6cdebe & 12 May 2014 & rusty & { VIRTIO-103: PCI: Note that turning off queue_enable is not supported.


As passed at meeting 2014-05-06:
        \url{https://lists.oasis-open.org/archives/virtio/201405/msg00016.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@365} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
aa97782 & 12 May 2014 & rusty & { VIRTIO-87: limit descriptor chain length even with INDIRECT.


As passed at meeting 2014-05-06:
        \url{https://lists.oasis-open.org/archives/virtio/201405/msg00016.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@366} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
59cd205 & 12 May 2014 & rusty & { VIRTIO-98: Add DEVICE_NEEDS_RESET.


As passed at meeting 2014-05-06:
        \url{https://lists.oasis-open.org/archives/virtio/201405/msg00016.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@367} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5fb5a95 & 12 May 2014 & rusty & { VIRTIO-107: Clarify net mac commands.


As passed at meeting 2014-05-06:
    \url{https://lists.oasis-open.org/archives/virtio/201405/msg00016.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@368} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c374da2 & 12 May 2014 & rusty & { VIRTIO-52: Make mac field read only.


As passed at meeting 2014-05-06:
	\url{https://lists.oasis-open.org/archives/virtio/201405/msg00016.html}

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@369} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
24d4065 & 12 May 2014 & rusty & { VIRTIO-96: Assign device id to virtio input


Assign device id to virtio input

As passed at meeting 2014-05-06:
	\url{https://lists.oasis-open.org/archives/virtio/201405/msg00016.html}

Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@370} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ad147dd & 22 May 2014 & rusty & { content.tex: add support for protection information (VIRTIO-108)


This is a new feature that was suggested by Nicholas Bellinger, who
also provided a prototype implementation for vhost-scsi.

(As per minutes of meeting 2014-05-20:
	\url{https://lists.oasis-open.org/archives/virtio/201405/msg00034.html} )

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@371} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d71f9f1 & 22 May 2014 & rusty & { content.tex: virtio-scsi review (VIRTIO-106)


As prompted by Rusty, add a few more MUST/SHOULD items for both devices
and drivers.  Clarify semantics of max_channel/max_id/max_lun, task_attr
and task management functions.

(As per minutes of meeting 2014-05-20:
    \url{https://lists.oasis-open.org/archives/virtio/201405/msg00034.html} )

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@372} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
93cd93e & 22 May 2014 & rusty & { Fix build of document


Error introduced in 59cd205cea "VIRTIO-98: Add DEVICE_NEEDS_RESET":
seems that underscores in labels are verboten:

[133] [134] (./virtio-v1.0-csprd02.aux
! Missing \textbackslash endcsname inserted.
<to be read again>
                   \textbackslash unhbox
l.45 ...ts: Device Status Field\}\}\{subsection.1\}\{\}.


Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@373} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e81e656 & 31 May 2014 & mstsirkin & { NEEDS_RESET: trivial clarification


If device sets NEEDS_RESET before DRIVER_OK, it
can't send notifications to driver.
Make this clear.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@374} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6a83c1d & 05 Jun 2014 & rusty & { pci: set ISR bit on config change with MSI-X


config changes are slow path anyway, so we
can as well set ISR bit to help drivers detect changes.

This allows sharing config interrupts which is what
issue reporter seems to ask for.

VIRTIO-104

(Approved at 2014-06-04 meeting:
  \url{https://lists.oasis-open.org/archives/virtio/201406/msg00013.html} )
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@375} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fffcbe3 & 05 Jun 2014 & rusty & { pci: switch from subsystem id to device id


Switch virtio pci to use standard device id instead of using the
subsystem id.

Unfortunately, there's no system to the way KVM allocated
device IDs to virtio devices, we'll just have to
specify these using a table, and use a new range for
future devices. For existing devices this results in
two possible IDs that all drivers will need to match.
Unfortunate, but the cost is small.

As a nice side effect, this allows us to make non-transitional
devices use IDs 0x40 and up, this reduces even further the
chance that a non transitional device will match legacy drivers.

And, it's probably a good idea to allow drivers to match
specific subsystem IDs if they
want to, so relax requirement for drivers to match all
subsystem/vendor ID configurations, but allow them to do so.

To avoid confusion, say "PCI Device ID" and
"PCI Subsystem ID" everywhere, prefix "PCI"
for other standard registers, for consistency.

VIRTIO-102

Note: issue reporter suggested 0x10XX where XX is the virtio
device ID. This would conflict with legacy devices, which seem
to have used 7 IDs in the range 0x1000 to 0x103f without any
system. Let's use a new range 0x1040 to 0x107f for
non-transitional devices, and add a table documenting the
transitional IDs used by in practice.

(Approved at 2014-06-04 meeting:
  \url{https://lists.oasis-open.org/archives/virtio/201406/msg00013.html} )

Cc: Andrew Thornton <andrewth@google.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@376} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a445ec1 & 05 Jun 2014 & rusty & { PCI: remove duplicate paragraph.


I chose the one which used the full nomenclature.

Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@377} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
cd77492 & 09 Jun 2014 & pbonzini & { virtio-scsi: fixes to protection information


pi_bytesin is in the device-readable section.  Document lack of residual
field.  Use le32 instead of u32.

This matches the new patch series that Nicholas sent for vhost-scsi.

Cc: <nab@daterainc.com>
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@378} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2928b3c & 09 Jun 2014 & pbonzini & { virtio-scsi: additional SHOULDification


Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@379} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
37fd080 & 09 Jun 2014 & pbonzini & { consistent formatting of footnotes


Put the indicator before punctuation, and terminate the footnote with
a period.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@380} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5d5206b & 09 Jun 2014 & pbonzini & { virtio-scsi: support well-known logical units


The REPORT LUNS well-known logical unit is useful because it lets you
retrieve information about all targets with a single command.  It
also provides an easy way to send a no-op request.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@381} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
185283a & 16 Jun 2014 & rusty & { small virtio-serial fix


nr_ports does not exist in the spec.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Rusty Russell <rusty@au1.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@382} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6585339 & 16 Jun 2014 & pbonzini & { fix erroneous reference to Subsystem Device ID


Subsystem device ID only exists for PCI.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@383} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a250348 & 17 Jun 2014 & pbonzini & { content.tex: VIRTIO-106: mention possibility of failing TMFs


This completes the review of virtio-scsi based on observations
from Google.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@384} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0c7e55a & 25 Jun 2014 & mstsirkin & { fixup pci: switch from subsystem id to device id


Patch sent to list (and applied by Rusty in
commit fffcbe327c69e510239fff5627034aa2ab4b2d84
    pci: switch from subsystem id to device id
) did not actually implement what commit log said
it implements.

The result is wrong for transitional devices:
Adding 0xfff works for for net+block only;
for transitional pci devices there is no fixed scheme:

\~{}/projects/qemu/include \# grep VIRTIO_ID hw/virtio/*.h
hw/virtio/virtio-balloon.h:\#define VIRTIO_ID_BALLOON 5
hw/virtio/virtio-blk.h:\#define VIRTIO_ID_BLOCK 2
hw/virtio/virtio-net.h:\#define VIRTIO_ID_NET   1
hw/virtio/virtio-rng.h:\#define VIRTIO_ID_RNG    4
hw/virtio/virtio-scsi.h:\#define VIRTIO_ID_SCSI  8
hw/virtio/virtio-serial.h:\#define VIRTIO_ID_CONSOLE             3

\~{}/projects/qemu/include \# grep VIRTIO hw/pci/*.h
hw/pci/pci.h:\#define PCI_DEVICE_ID_VIRTIO_NET         0x1000
hw/pci/pci.h:\#define PCI_DEVICE_ID_VIRTIO_BLOCK       0x1001
hw/pci/pci.h:\#define PCI_DEVICE_ID_VIRTIO_BALLOON     0x1002
hw/pci/pci.h:\#define PCI_DEVICE_ID_VIRTIO_CONSOLE     0x1003
hw/pci/pci.h:\#define PCI_DEVICE_ID_VIRTIO_SCSI        0x1004
hw/pci/pci.h:\#define PCI_DEVICE_ID_VIRTIO_RNG         0x1005
hw/pci/pci.h:\#define PCI_DEVICE_ID_VIRTIO_9P          0x1009

I am guessing TC went by commit log when it approved the change,
so fixing it up directly.

Cc: Andrew Thornton <andrewth@google.com>
Cc: Rusty Russell <rusty@ozlabs.org>
Cc: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@385} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
74e8f14 & 25 Jun 2014 & mstsirkin & { pci: minor fomatting tweak


Make table look better. Drop spaces that make
latexdiff stumble.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@386} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
34cff3f & 26 Jun 2014 & mstsirkin & { makediffpdf.sh: tool to create marked-up diff


make pdf diff using latexpand and latexdiff-fast

styles are set in diffpreamble.tex

in diff, links are coloured green instead of blue

Must be run within a git-svn clone of the spec repository.

Note: latexdiff has --flatten option, this and options
to select diff style don't seem to work well.
So flatten by script myself, and add our own preamble.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@387} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2cb1be8 & 26 Jun 2014 & mstsirkin & { diffpreamble: remove duplicate text


latexdiff adds some

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@388} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b665b31 & 26 Jun 2014 & mstsirkin & { work around xetex bug


Too many \textbackslash color directives produce corrupted output
and this warning:
WARNING ** Color stack overflow. Just ignore.

Use script to reduce \# of these directives.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@389} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b614cfe & 26 Jun 2014 & mstsirkin & { diffpreamble: fix colors for links within diff


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@390} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fc27ea1 & 26 Jun 2014 & mstsirkin & { more latexdiff hacks



- change link color from green to pinegreen. Looks better to me.

- split footnotes out from their text, so that latexdiff
  does not consider them as a unit

- mark field command as safe for latexdiff, otherwise it's not shown in red

- hack adding DIFaddtext within footnotes could not handle
  case where latexdiff inserted multiple DIFadd within the
  footnote. Instead, detect when footnote is within
  DIFaddbegin/DIFdelbegin, add an extra DIFaddbegin/DIFdelbegin
  within the footnote.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@391} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ccac3cd & 26 Jun 2014 & mstsirkin & { script to create html diff as well


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@392} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ef519a8 & 26 Jun 2014 & mstsirkin & { makediff: cleanup using begingroup/endgroup


Pawel Moll found a way to work around xetex bugs
without mangling latexdiff output using perl:

- define DIFbegin/DIFFend commands in preample

- pass --config FLOATENV= to latexdiff

Use this in preference to the fixupdiff perl script.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@393} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2a1c8b7 & 26 Jun 2014 & mstsirkin & { remove fixupdiff script


remove fixupdiff.pl, it's unused now

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@394} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5de86e7 & 26 Jun 2014 & mstsirkin & { makehtml: fix bad fontpath detection


Fix wanring when run this shell script.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@395} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0529224 & 26 Jun 2014 & mstsirkin & { diff: back to green for added text


using blue does not work well for html

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@396} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
32aedbc & 27 Jun 2014 & mstsirkin & { add draft2 acknowledgements


List people that provided comments on draft01 in the
acknowledgements section. Might be a nice way to encourage
reviews.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@397} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b147281 & 27 Jun 2014 & mstsirkin & { acknowledgements: add draft 3 reviewers, sort


Add new reviewers and sort by name.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@398} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
35178bc & 27 Jun 2014 & mstsirkin & { changelog: fill changelog since draft2


This will make review easier.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@399} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3534065 & 27 Jun 2014 & mstsirkin & { getchangelog: add paragraphs when escaping latex


makes change log easier to read.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@400} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
722dfaf & 27 Jun 2014 & mstsirkin & { changelog: add two last commits


Not critical but just for completeness...

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@401} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
90223ca & 27 Jun 2014 & mstsirkin & { makediff: add longtable as floatenv


fix latex error in diff generation

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@402} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
77f6b28 & 27 Jun 2014 & mstsirkin & { makediffall.sh: script to build all, include diff


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@403} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e318ba3 & 27 Jun 2014 & mstsirkin & { title: update previous version link


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@404} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3766328 & 27 Jun 2014 & mstsirkin & { setup: allow overriding date from environment


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@405} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8a3d152 & 23 Jul 2014 & hornet & { VIRTIO-111: Fix minor typos


Fix minor typos as reported in ARM's feedback.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@406} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f96e609 & 30 Jul 2014 & mstsirkin & { title page fixes for csd03


Address comments by Paul Knight:

- list Rusty as an editor as well

- add MST as co-chair

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@407} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c8669d9 & 30 Jul 2014 & mstsirkin & { suppress diff for list of chairs


output looks ugly, and this isn't of interest for reviewers

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@408} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
695f937 & 30 Jul 2014 & mstsirkin & { Revert "VIRTIO-111: Fix minor typos"


This reverts commit 8a3d1521930d9dacca4972d591ff720d614e37e8.

Was not in CSD03, will re-apply immediately after updating
REVISION.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@409} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
91c83b2 & 30 Jul 2014 & mstsirkin & { REVISION: update for csd03


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@410} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
40ba298 & 30 Jul 2014 & mstsirkin & { REVISION: update for csprd03


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@411} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6646302 & 30 Jul 2014 & mstsirkin & { VIRTIO-111: Fix minor typos


Fix minor typos as reported in ARM's feedback.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@412} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
31e5624 & 04 Aug 2014 & mstsirkin & { legacy: consistently use past tense


Paragraph with general description of feature negotiation
for legacy devices mixed present and past tense.
As rest of legacy sections all use past tense,
fix the only instance of the present tense:
s/do/did/ for consistency.

It might be argued that legacy devices still have these
properties so present tense is more appropriate, on the
other hand, using the past tense helps stress the fact
that current spec does not attempt to fully describe the legacy
device/driver behaviour: this text is only here to serve as
motivation for the transitional device/driver requirements.

VIRTIO-112

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@413} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d1bf734 & 04 Aug 2014 & mstsirkin & { legacy: grammar fixup


Legacy devices are "they" not "it".

VIRTIO-113

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@414} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ebbf33b & 05 Aug 2014 & hornet & { VIRTIO-110: ARM's feedback for MMIO chapter, trivial changes


Those changes do not add nor remove any features and constitutes
only error correction and editorial changes.

* Typos and language mistakes in 4.2, 4.2.1, 4.2.2 and 4.2.2.2.
* Extra clarifications for InterruptACK.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@415} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
369a0bd & 05 Aug 2014 & hornet & { VIRTIO-110: ARM's feedback for MMIO chapter, legacy section


This patch makes clear that the legacy section is non-normative,
removing all MUSTs.

Those changes do not add nor remove any features and constitues
only error correction and editorial changes.

Signed-off-by: Pawel Moll <pawel.moll@arm.com>


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@416} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7799fc5 & 31 Aug 2014 & mstsirkin & { VIRTIO-110: ARM's feedback for MMIO chapter, clarifications


Those changes do not add nor remove any features and constitutes
only error correction and editorial changes.

* Extra clarifications for QueueReady and ConfigGeneration
* Added alignment requirement section, to formalise
  hidden assumptions about register accesses

Signed-off-by: Pawel Moll <pawel.moll@arm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@417} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d9ed78f & 31 Aug 2014 & mstsirkin & { acknowledge input from Brian Foley


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@418} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0adee48 & 31 Aug 2014 & mstsirkin & { title: update previous version link


csprd02->csprd03

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@419} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
01a9a26 & 31 Aug 2014 & mstsirkin & { makediff: update after csprd03


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@420} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a41f381 & 31 Aug 2014 & mstsirkin & { changelog: update with changes since draft03


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@421} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9d5c375 & 31 Aug 2014 & mstsirkin & { makediff: fix diff generation for mmio section


teach script that last argument to "mmio" macro
is text

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@422} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fbfb402 & 31 Aug 2014 & mstsirkin & { add cross references to changelog


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@423} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
63e4445 & 31 Aug 2014 & mstsirkin & { makediff; mask changes in title, changelog


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@424} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9f240fe & 31 Aug 2014 & mstsirkin & { acknowledgements: add cross reference


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@425} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a02605f & 31 Aug 2014 & mstsirkin & { changelog: list change adding brian foley


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@426} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
67dd3ce & 31 Aug 2014 & mstsirkin & { makediff: mask more changelog changes


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@427} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
70c19d1 & 19 Oct 2014 & mstsirkin & { makeall: document cs as option


it's already supported, just undocumented

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@428} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
67dbeff & 19 Oct 2014 & mstsirkin & { makediff: force revision and date in environment


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@429} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
bc8a296 & 19 Oct 2014 & mstsirkin & { Update revision and date for cs01


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@430} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
175e797 & 19 Oct 2014 & mstsirkin & { make-setup: add missing WD number of CS files


E.g. committee specification 01, not committee specification.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@431} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8099431 & 19 Oct 2014 & mstsirkin & { title: add link to other work by TC


add:
Any other numbered Versions and other technical work produced by
the Technical Committee (TC) are listed at
\url{https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=virtio\#technical.}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@432} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8d80171 & 19 Oct 2014 & mstsirkin & { REVISION: update date to when ballot closed


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@433} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9b142d4 & 19 Oct 2014 & mstsirkin & { makediff: skip change adding WD \# for CS


diffs in too many places, looks ugly.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@434} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8de7942 & 19 Oct 2014 & mstsirkin & { makediff: fix up to cherry-picks


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio@435} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9b42e66 & 18 Dec 2014 & mstsirkin & { v1.0 branch - bugfixes for 1.0 only



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@437} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1343397 & 18 Dec 2014 & mstsirkin & { Copy revision 435 to trunk.


From now on, for development, use:
 git svn clone -s \url{https://tools.oasis-open.org/version-control/svn/virtio}
(note -s flag)



git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@438} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
cb4e80b & 22 Dec 2014 & mstsirkin & { formatting: drop \textbackslash ldots in lstlisting


\textbackslash ldots does not work within lstlisting, the result is
\textbackslash ldots verbatim in the PDF output.

To fix, replace with a literal ...

VIRTIO-115

Cc: Thomas Huth <thuth@linux.vnet.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@440} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
431eae1 & 22 Dec 2014 & mstsirkin & { virtio: fix used element size


General ring description lists size for
used ring elements as 4, it must be 8.

VIRTIO-120

Cc: "Dr. David Alan Gilbert" <dgilbert@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@441} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
42180b0 & 22 Dec 2014 & mstsirkin & { block: fixup section levels


The specification for the configuration layout for block devices
should be its own subsection as for all other devices and not be
hidden beneath "Feature bits".

The normative sections for device operation should appear under
the device operation section.

VIRTIO-125

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@442} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
008ede5 & 22 Dec 2014 & mstsirkin & { ccw: two-stage indicators for legacy devices


Some legacy devices will support two-stage queue indicators and therefore
won't reject CCW_CMD_SET_IND_ADAPTER. Note this.

VIRTIO-127

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@443} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
897a5d2 & 22 Dec 2014 & mstsirkin & { makediff: fix up using git-svn commit IDs


It turns out makediff.sh used commit IDs that weren't
pushed to svn. commit ID changes on dcommit so
these don't work. Rewrite using correct commit IDs from git svn.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@444} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5f50f60 & 22 Dec 2014 & mstsirkin & { makediff: fix up using git-svn commit IDs


It turns out makediff.sh used commit IDs that weren't
pushed to svn. commit ID changes on dcommit so
these don't work. Rewrite using correct commit IDs from git svn.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@446} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9327a1c & 22 Dec 2014 & mstsirkin & { formatting: drop \textbackslash ldots in lstlisting


\textbackslash ldots does not work within lstlisting, the result is
\textbackslash ldots verbatim in the PDF output.

To fix, replace with a literal ...

VIRTIO-115

Cc: Thomas Huth <thuth@linux.vnet.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@447} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
981987a & 22 Dec 2014 & mstsirkin & { virtio: fix used element size


General ring description lists size for
used ring elements as 4, it must be 8.

VIRTIO-120

Cc: "Dr. David Alan Gilbert" <dgilbert@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@448} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e0e9143 & 22 Dec 2014 & mstsirkin & { block: fixup section levels


The specification for the configuration layout for block devices
should be its own subsection as for all other devices and not be
hidden beneath "Feature bits".

The normative sections for device operation should appear under
the device operation section.

VIRTIO-125

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@449} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1e1210c & 22 Dec 2014 & mstsirkin & { ccw: two-stage indicators for legacy devices


Some legacy devices will support two-stage queue indicators and therefore
won't reject CCW_CMD_SET_IND_ADAPTER. Note this.

VIRTIO-127

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Reviewed-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@450} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ebc8f97 & 23 Dec 2014 & mstsirkin & { Revert "formatting: drop \textbackslash ldots in lstlisting"


This reverts commit 9327a1c9966ec9752aaafa420c7bf2b345cdc9fe.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@451} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d858fdb & 23 Dec 2014 & mstsirkin & { formatting: escape \textbackslash ldots in lstlisting


\textbackslash ldots does not work within lstlisting, the result is
\textbackslash ldots verbatim in the PDF output.

To fix, make \$ an escape character, and escape the sequence:
\$\textbackslash ldots.


VIRTIO-115

Cc: Thomas Huth <thuth@linux.vnet.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@452} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
669eb85 & 23 Dec 2014 & mstsirkin & { cl: remove changelog for cs01.


will replace with new changelog.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@453} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f1b4fcc & 23 Dec 2014 & mstsirkin & { add legacy tag for makediff between cs02 and cs01


This is here merely as a work-around for latex-diff producing
broken cross-references when labels are re-named.
Not needed on trunk.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@454} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
bd4a967 & 23 Dec 2014 & mstsirkin & { acknowledgements: acknowledge dgilbert


For reporting VIRTIO-120

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@455} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7cc4f07 & 23 Dec 2014 & mstsirkin & { cl-os: prepare changelog for v1.0 cs02


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@456} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e3ee47b & 23 Dec 2014 & mstsirkin & { tweak dgilbet's name, for consistency


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@457} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
beba1e5 & 23 Dec 2014 & mstsirkin & { commands: add DIFdeltextcstwo/DIFaddtextcstwo


Can be used to manually mark up cs02 changes where
latexdiff didn't go a good job.
We make them nop outside latexdiff.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@458} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d0ea186 & 23 Dec 2014 & mstsirkin & { formatting: mark change manually as changed in cs02


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@459} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
9b202ac & 23 Dec 2014 & mstsirkin & { makediff: works well. todo: fix commit ids


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@460} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3c9def2 & 23 Dec 2014 & mstsirkin & { makediff: exit on makediff.sh failure


Properly propagate errors from sub-scripts.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@461} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d54bb60 & 23 Dec 2014 & mstsirkin & { makediff: cherry-pick some changes to avoid markup


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@462} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
14b2ce1 & 23 Dec 2014 & mstsirkin & { title: update previous version to cs01


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@463} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0ebeb90 & 23 Dec 2014 & mstsirkin & { makediff: cherry-pick title changes


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@464} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0be6c18 & 23 Dec 2014 & mstsirkin & { feedback: drop unused feedback files


So that we don't need to remove them manually.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@465} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
19d0931 & 23 Dec 2014 & mstsirkin & { makezip: minor fixes



- preserve spec name and date in REVISION/REVISION-DATE

- clean out listings directory before packing

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@466} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
5f33ce4 & 23 Dec 2014 & mstsirkin & { changelog: list acknowledgement change


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@467} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
220bd6d & 23 Dec 2014 & mstsirkin & { makediff: cherry-pick more changelog commits


We really should automate this going forward.
For now - cherry-pick manually.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@468} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
92a1916 & 23 Dec 2014 & mstsirkin & { changelog: typo fixup: formatting: formatting


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@469} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c40d15e & 23 Dec 2014 & mstsirkin & { makediff: cherry-pick more changelog changes


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@470} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1ed00b1 & 05 Feb 2015 & mstsirkin & { oasis: update copyright to 2015


Update the copyright date on Notices page and footer of PDF to
2015, as requested by OASIS admin.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@471} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
07ebecd & 05 Feb 2015 & mstsirkin & { REVISION: update for virtio 1.0 cs02


Set revision date and revision correctly, as
requested by OASIS admin.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@472} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d9a174c & 05 Feb 2015 & mstsirkin & { headerfile: fix link to header file in html output


Using macros within \textbackslash url doesn't work for html output.
To fix, put \textbackslash url within macro.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@473} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
86e51b4 & 05 Feb 2015 & mstsirkin & { html: work around bug in html generation


Using texlive on Fedora 21, \textbackslash url for some reason replaces
hypen - with -_ in html output only.

This is only a formatting issue: the link itself is correct.
For example:
<A HREF="\url{http://docs.oasis-open.org">}
\url{http://docs.oasis-_open.org</A>}

I don't know why this happens, but it seems to go away if we
override - within urls inserting an mbox around it.
makeatletter \textbackslash g@addto@macro\textbackslash UrlSpecials\{\textbackslash do\textbackslash -\{\textbackslash mbox\{-\}\}.


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@474} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f64afc0 & 05 Feb 2015 & mstsirkin & { makehtml: only pack one html file


We used to have multiple html files, but no more, so
packing files using * glob doesn't make sense -
and tends to include random unnecessary files
if the names happen to match.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@475} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
00c5a09 & 15 Feb 2015 & mstsirkin & { Merge remote-tracking branch 'origin/v1.0'


Conflicts:
	content.tex
	makediff.sh

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@477} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
db51737 & 15 Mar 2015 & mstsirkin & { legacy: clean up virtqueue layout definitions


Generalize "Legacy Interfaces: A Note on Virtqueue Layout" to allow
for different alignment requirements. Have pci and ccw refer to that
section for legacy devices. Remove the double definition of virtqueue
alignment (which referred to legacy, but was not tagged as such) from
the ccw section.

VIRTIO-129

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

Approved unanimously:
\url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=2756}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@478} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4e07396 & 15 Mar 2015 & mstsirkin & { ccw: allow WRITE_STATUS to fail


We want to be able to fail setting a status on the device (e.g.
FEATURES_OK if the device can't work with the features negotiated).
The easiest way to do that is to allow the device to fail the
WRITE_STATUS command by posting a command reject.

VIRTIO-116

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

Approved unanimously:
\url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=2762}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@479} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1b94350 & 15 Mar 2015 & mstsirkin & { ccw: clarify basic channel commands


"Basic channel commands" seems to be not as clear as it could,
so let's spell out which channel commands we refer to.

VIRTIO-118

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

Approved unanimously:
\url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=2763}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@480} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
be29845 & 15 Mar 2015 & mstsirkin & { Revert: formatting: mark change manually as changed in cs02


This reverts commit d0ea186fe547a0e7ae4baeb623cf764a3f1ace65.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@481} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
298278d & 15 Mar 2015 & mstsirkin & { cl: move out cs02 changelog


start adding one for cs03

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@482} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c987334 & 15 Mar 2015 & mstsirkin & { makediff: update for cs03


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@483} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f612f68 & 15 Mar 2015 & mstsirkin & { makediff: work around for lstlisting


latexdiff seems to go wild trying to diff lstlisting.
But marking lstlisting as picture - so old text is
commented out - then removing the comment sign -
seems to work, with the only disadvantage being
that listing is diffed as a whole.
Seems to be the best I can come up with ATM.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@484} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c407b04 & 25 Mar 2015 & mstsirkin & { virtio-ring: comment fixup


virtio_ring.h included with spec has this text:
/* Support for avail_idx and used_idx fields */
it should really refer to avail_event and used_event.

VIRTIO-135.

Reported-by: Jason Wang <jasowang@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@485} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
d5d4b0c & 25 Mar 2015 & mstsirkin & { document idx field in virtqueue used ring


Section 2.4.8 The Virtqueue Used Ring
lists the idx field, but never documents it.

VIRTIO-136.

Reported-by: Jason Wang <jasowang@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@486} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
525835c & 25 Mar 2015 & mstsirkin & { ISR status: Fix incorrect diagram


ISR status capability diagram has the "Device Configuration
Interrupt " as bit 0, and the "Queue Interrupt" as bit 1. This is
the wrong way around: it disagrees with the legacy
implementations, as well as the spec elsewhere.

All current guests correctly follow the text, fix
up the diagram to match.

VIRTIO-130

Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@487} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0bc9dbd & 25 Mar 2015 & mstsirkin & { Change 4.1.5.1.2.1 to device requirement


4.1.5.1.2.1 is incorrectly labelled as a driver requirement; it's
self-evidently referring to the device.

VIRTIO-133

Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@488} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
27e14c7 & 25 Mar 2015 & mstsirkin & { cl: drop contents temporarily


This is helpful for diff generation.
Will re-add shortly.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@489} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2f59b7e & 25 Mar 2015 & mstsirkin & { changelog: comment out header


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@490} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
dc05355 & 25 Mar 2015 & mstsirkin & { changelog: uncomment header


This reverts commit d9536a52200d9f9f5048fd6534605ec75aadb08f.

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@491} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b03b568 & 25 Mar 2015 & mstsirkin & { cl: list virtio-129


This reverts commit de1e7c191a168195f67aa5259603f83264b35e28.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@492} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
76341d2 & 25 Mar 2015 & mstsirkin & { cl: list virtio-116 change


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@493} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4c2ad7e & 25 Mar 2015 & mstsirkin & { cl: list more changes


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@494} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6e02591 & 25 Mar 2015 & mstsirkin & { changelog: disable markup


Doesn't work properly with latexdiff anyway.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@495} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ab5fb8d & 25 Mar 2015 & mstsirkin & { makediff: cherry pick cl changes


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@496} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
86ef236 & 25 Mar 2015 & mstsirkin & { cl: add cross-references to changes since cs02


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@497} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1132bfe & 25 Mar 2015 & mstsirkin & { makediff: cherry-pick header removal


makes changelog diff slightly prettier.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@498} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6e7b257 & 25 Mar 2015 & mstsirkin & { cl: tweak changelog slightly


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@499} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8bce9fc & 25 Mar 2015 & mstsirkin & { cl: add more changelog text


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@500} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
930364b & 25 Mar 2015 & mstsirkin & { cl: list virtio-130


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@501} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
54f331f & 25 Mar 2015 & mstsirkin & { cl: add virtio-133


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@502} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3764870 & 25 Mar 2015 & mstsirkin & { cl: tweak revisions


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@503} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2488010 & 22 Apr 2015 & mstsirkin & { VIRTIO-137: used ring: define the meaning and requirements of the len field.


We said what it was for, and noted why.  We didn't place any requirements
on it, nor clearly spell out the implications of its use.

This clarification comes particularly from noticing that QEMU didn't
set len correctly, and philosophising over the correct value when
an error has occurred.

(Wording precision feedback from Michael and Cornelia - Thanks!)

Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@504} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3199466 & 22 Apr 2015 & mstsirkin & { makediff: mark note as floatenv


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@505} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8028f89 & 22 Apr 2015 & mstsirkin & { multiple errors: Non-transitional With Legacy


virtio 1.0 has two sections titled "Non-transitional Device With
Legacy Driver" the first says devices SHOULD fail, the second
says devices MUST fail.  Clearly a mistake.

Other issues: devices don't really fail - they cause drivers to
fail. second section seems to be in the wrong place, and also
have a section followed by subsection with no explanatory text in
between, which is ugly.
Finally, this text was originally ritten to handle buggy windows
drivers gracefully, but later we changed device IDs so it's not
really required there. Might be handy for some other buggy legacy
drivers, though no such drivers are known.

To fix, drop the duplicate section variant, add some explanatory
text, clarify what does "same ID" mean here, and clarify
that the work-around is only needed if a buggy driver
is known to bind to a transitional device.

VIRTIO-138

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@506} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a75a70b & 22 Apr 2015 & mstsirkin & { mark diff for non-transitional with legacy


latexdiff doesn't handle changing labels well,
causes latex unresolved reference errors.

opencode and mark up diff manually.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@507} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fdc047c & 22 Apr 2015 & mstsirkin & { pci: missing documentation for dealing with 64 bit config fields


pci spec says what width access to use for 32, 16 and 8
bit fields, but does not explicitly say what to do for
32 bit fields. As we have text that says driver must
treat 64 bit accesses as non-atomic, this seems
to imply driver should always do two 32 bit wide accesses.

Let's make this an explicit requirement, and require
devices to support this.

VIRTIO-139

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@508} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
74fc1ee & 22 Apr 2015 & mstsirkin & { balloon: MUST -> has to


MUST shouldn't be used outside normative statements,
that's confusing. Replace with "has to".

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@509} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e8ea9dd & 22 Apr 2015 & mstsirkin & { conformance: add VIRTIO-137 to statements


Add links to new conformance statements added to
resolve VIRTIO-137 (describing used ring entry len usage).

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@510} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8aaa8ec & 22 Apr 2015 & mstsirkin & { makediff: cherry pick disabling markup on cl


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@511} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c8fa7c1 & 22 Apr 2015 & mstsirkin & { diffpreamble: redefine colors in nomarkup section


Changelog appears within DIFaddbegin/DIFaddend,
suppress marking it as added text, that's confusing.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@512} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e0ce988 & 22 Apr 2015 & mstsirkin & { cl: document VIRTIO-137


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@513} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
8aae503 & 22 Apr 2015 & mstsirkin & { cl: document r508: VIRTIO-139


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@514} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
29b3906 & 22 Apr 2015 & mstsirkin & { cl: list r506 and VIRTIO-138


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@515} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4a135df & 22 Apr 2015 & mstsirkin & { cl: document r509


wording tweak in balloon.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@516} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
464653c & 22 Apr 2015 & mstsirkin & { acknowledgements: contributors+minor fixup


acknowledge feedback by Jason Wang, add Richard Sohn who joined
the TC, sort acknowledged reviewers alphabetically.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@517} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
1a776d9 & 22 Apr 2015 & mstsirkin & { cl: document r517


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@518} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4ce5417 & 22 Apr 2015 & mstsirkin & { cl: fix name for MST


Should be Michael S. Tsirkin, not Michael Tsirkin.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@519} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
12e4378 & 29 Apr 2015 & mstsirkin & { give explicit guidance on the use of 64 bit fields


Just saying 64 bit fields may not be atomic is true, but less helpful
than it might be.  Add explicit guidance about what the consequences of
non-atomicity are.

VIRTIO-140

Signed-off-by: James Bottomley <JBottomley@Odin.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@520} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3b676c2 & 29 Apr 2015 & mstsirkin & { VIRTIO-134: Spell out details of indirect elements in chains


1) It's implied that a chain terminates with an indirect descriptor (since
   VIRTIO-15) but we didn't spell out that a device MUST NOT continue it.

2) We allow [direct]->[direct]->[indirect], and qemu and bhyve both accept
   it.  Make it clear that this is valid, thus devices MUST handle it.

Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@521} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3470801 & 29 Apr 2015 & mstsirkin & { used ring: specify legacy behaviour for len field


many hypervisors implemented len field incorrectly.
Document existing bugs in the legacy sections.

VIRTIO-141

Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
Cc: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@522} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
99aacda & 29 Apr 2015 & mstsirkin & { entropy device: typo fix


The driver MUST examine the length written by the driver

makes no sense. length is written by the device.

VIRTIO-142

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@523} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
dfb4b9c & 29 Apr 2015 & mstsirkin & { conformance: add missing links


previous commit "used ring: specify legacy behaviour for len field"
to resolve VIRTIO-141 added new sections with normative
statements for legacy balloon and scsi devices. Link them from
the conformance section.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@524} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
c6f96d6 & 29 Apr 2015 & mstsirkin & { cl: document VIRTIO-134, VIRTIO-140, VIRTIO-141, VIRTIO-142


document changes made by commits r520 to r523 inclusive

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@525} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0eb5a23 & 18 May 2015 & mstsirkin & { balloon: transitional device support


Virtio 1.0 cs02 doesn't include a modern balloon device.  At some
point we'll likely define an incompatible interface with a
different ID and different semantics.  But for now, it's not a
big effort to support a transitional balloon device: this has the
advantage of supporting existing drivers, transparently, as well
as transports that don't allow mixing virtio 0 and virtio 1
devices. And balloon is an easy device to test, so it's also
useful for people to test virtio core handling of transitional
devices.

Three issues with legacy hypervisors have been identified:
1. Actual value is actually used, and is necessary for management
   to work. Luckily 4 byte config space writes are now atomic.
   When using old guests, hypervisors can detect access to the last byte.
   When using old hypervisors, drivers can use atomic 4-byte accesses.
2. Hypervisors actually didn't ignore the stats from the first
   buffer supplied. This means the values there would be
   incorrect until hypervisor resends the request.
   Add a note suggesting hypervisors ignore the 1st buffer.
3. QEMU simply over-writes stats from each buffer it gets.
   Thus if driver supplies a different subset of stats
   on each request, stale values will be there.
   Require drivers to supply the same subset on each
   request. This also gives us a simple way to figure out
   which stats are supported.

VIRTIO-143

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@526} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
36780da & 18 May 2015 & mstsirkin & { balloon: document deflate on oom


Document the new option, and also clarify behaviour
without it.

In particular, I noticed that actual field is not the
actual number of pages in the balloon as
driver might do inflate followed by deflate.

Also, device isn't always driven by interrupts,
driver can inflate/deflate in response to e.g.
memory compaction.

VIRTIO-126

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@527} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
aa8bdde & 18 May 2015 & mstsirkin & { network device: xmit/receive cleanup


Fix up multiple issues in xmit/receive sections:

- drop MAY/MUST/SHOULD outside normative statements

- spell out conformance requirements for both drivers and
  devices, for xmit and receive paths

- document the missing VIRTIO_NET_HDR_F_DATA_VALID

- document handling of unrecognized flag bits so we can extend
  flags in the future, similar to VIRTIO_NET_HDR_F_DATA_VALID

VIRTIO-123

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@528} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
dbd41a9 & 18 May 2015 & mstsirkin & { network device: document VIRTIO_NET_F_CTRL_RX_EXTRA


VIRTIO-124

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@529} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2cf3b86 & 21 May 2015 & mstsirkin & { conformance: link in new conformance statements


Link new conformance statements added by commit
    network device: document VIRTIO_NET_F_CTRL_RX_EXTRA

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@530} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
12527ec & 21 May 2015 & mstsirkin & { cl-os: VIRTIO-123, VIRTIO-124, VIRTIO-126, VIRTIO-143


Document resolutions to VIRTIO-123, VIRTIO-124, VIRTIO-126 and
VIRTIO-143.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@531} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2e49873 & 21 May 2015 & mstsirkin & { content: replace \textbackslash \textbackslash note with note environment


\textbackslash \textbackslash note just before start of subsection seems to
confuse latex, resulting in incorrect text alignment.
Replace with \textbackslash begin\{note\} \textbackslash end\{note\}.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@532} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
077b7f2 & 21 May 2015 & mstsirkin & { makediff: mark enumerate/itemize as floats


Helps detect begin/end crossing these environments
and fix up automatically.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@533} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e06b2ff & 21 May 2015 & mstsirkin & { fixupdiff.pl: more work-arounds for latexdiff


work around more latexdiff issues:

- force FL style within headers

- fix beginFL ending with end and vice versa
  across begin/end of enum or itemize

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@534} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
601882e & 21 May 2015 & mstsirkin & { fixupdiff: better diff for lstlisting


Actually strike out deleted text.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@535} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2c9cd1c & 21 May 2015 & mstsirkin & { title: update previous version link


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@536} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6233eae & 02 Aug 2015 & mstsirkin & { admin: set date and revision for cs03


Approved Aug 2:
\url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=2843}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@537} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
87b53c4 & 02 Aug 2015 & mstsirkin & { Merge remote-tracking branch 'origin/v1.0'


Update trunk to virtio-v1.0-cs03

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@539} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
15d8b24 & 11 Oct 2015 & mstsirkin & { virtqueues: fix trivial typo


Signed-off-by: Greg Kurz <gkurz@linux.vnet.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@540} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
de6c79f & 11 Oct 2015 & mstsirkin & { virtio-blk: fix typo in legacy framing requirements section


Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@541} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f15b53c & 11 Oct 2015 & mstsirkin & { virtio-blk: flush: Fix driver vs. device typo


This is a simple non-material change.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@542} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b76aef3 & 11 Oct 2015 & mstsirkin & { cl: clear it out for cs03


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@543} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3d96d16 & 11 Oct 2015 & mstsirkin & { cl: list changes 540-542


all of them non-material

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@544} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
cff819e & 21 Oct 2015 & mstsirkin & { Revert: makediff: cleanup using begingroup/endgroup


This reverts commit
	commit ef519a86f046d1be22f82f32d845653a850c21dd
	Author: mstsirkin <mstsirkin@0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652>
	Date:   Thu Jun 26 16:50:13 2014 +0000

	makediff: cleanup using begingroup/endgroup

This seemed like a good idea originally: replace perl hacks with
tex hacks. However adding \textbackslash begingroup and \textbackslash endgroup within macros
used by latex-diff breaks its assumption that these are low level
tex and can be used in arbitrary situations, e.g.  cross the
boundaries of environments, use mis-matching begin and end
instructions (DIFaddbegin with DIFaddendFL), etc.

Let's go back to the original work-around:

commit b665b3165b454b98c782617e37a128b53b56c89c
Author: mstsirkin <mstsirkin@0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652>
Date:   Thu Jun 26 12:34:38 2014 +0000

    work around xetex bug

    Too many \textbackslash color directives produce corrupted output
    and this warning:
    WARNING ** Color stack overflow. Just ignore.

    Use script to reduce \# of these directives.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@545} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
ff6b2bb & 21 Oct 2015 & mstsirkin & { virtio-blk: restore VIRTIO_BLK_F_FLUSH and VIRTIO_BLK_F_CONFIG_WCE


VIRTIO_BLK_F_CONFIG_WCE is important in order to achieve good performance
(up to 2x, though more realistically +30-40\%) in latency-bound workloads.
However, it was removed by mistake together with VIRTIO_BLK_F_FLUSH.

In addition, even removing VIRTIO_BLK_F_FLUSH was probably not a great
idea, because it simplifies simple drivers (e.g. firmware) that are okay
with a writethrough cache but still need data to persist after power loss.
What really should have been removed is just the possibility that devices
not propose VIRTIO_BLK_F_FLUSH, but even that only deserves a "SHOULD" in
the new world of conformance statements.

Restore these, with the following changes:

* clarify and use conformance statements in order to define writeback
and writethrough caching according to what is commonly done by high-end
storage.

* clarify (with conformance statements) the influence of the
VIRTIO_BLK_F_FLUSH feature on caching and how to proceed if only one of
VIRTIO_BLK_F_FLUSH and VIRTIO_BLK_F_CONFIG_WCE is negotiated.

* strengthen the requirement for persisting writes to MUST after
a VIRTIO_BLK_T_FLUSH request (and in other cases too involving the
new features).

The suggested behavior upon feature negotiation is okay for the Linux
implementation of virtio1, even after the implementation is modified to
support the two new features.

This fixes VIRTIO-144.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Accepted by electronic ballot:
\url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=2864}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@546} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f8d4460 & 21 Oct 2015 & mstsirkin & { pci: clarify configuration access capability rules


The point of the configuration access capability is to enable
access to other capabilities.  The intent never was to allow
writes to a random place within device BARs.
Limiting drivers simplifies devices - and devices can always
add another capability if drivers ever want to access
some other range.

This resolves VIRTIO-145.

Cc: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

Accepted by electronic ballot:
\url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=2865}

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@547} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7317dc5 & 21 Oct 2015 & mstsirkin & { intro: add advice on transition from legacy interfaces


Reading legacy chapters gives a hint about what changed,
let's help readers discover this useful shortcut.

This resolves VIRTIO-146.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cornelia.huck@de.ibm.com>

Accepted by electronic ballot:
\url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=2866}

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@548} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6e97337 & 21 Oct 2015 & mstsirkin & { cl: document resolution for VIRTIO-144


virtio-blk: restore VIRTIO_BLK_F_FLUSH and VIRTIO_BLK_F_CONFIG_WCE

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@549} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
cbeb3b6 & 21 Oct 2015 & mstsirkin & { cl: document resolution for VIRTIO-145.


pci: clarify configuration access capability rules

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@550} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
84b37a2 & 21 Oct 2015 & mstsirkin & { cl: document resolution for VIRTIO-146.


add advice on transition from earlier drafts.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@551} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f885416 & 16 Feb 2016 & mstsirkin & { title: fix previous link to cs03


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@552} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
66f4d84 & 16 Feb 2016 & mstsirkin & { REVISION: update for csprd05


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@553} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
06149c8 & 16 Feb 2016 & mstsirkin & { virtio-net: fix inconsistent legacy header size


Current text says:
	The legacy driver only presented num_buffers in the struct
	virtio_net_hdr when VIRTIO_NET_F_MRG_RXBUF was not negotiated;

Should be:
	"... was negotiated ..." instead of "... was not negotiated ..."

To be consistent with the following:
	without that feature the structure was 2 bytes shorter.

Reported-by: Thomas Huth <thuth@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@554} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
bbc0cd3 & 16 Feb 2016 & mstsirkin & { virtio header: tweak change motivation


The changes are not just to remove Linux assumptions,
we have also renamed ring->queue.
Tweak the header description accordingly.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@555} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
3426a40 & 16 Feb 2016 & mstsirkin & { headerfile: rename virtio_ring to virtio queue


Done as a separate commit for benefit of latexdiff.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@556} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
bf1f8ad & 16 Feb 2016 & mstsirkin & { Revert "headerfile rename virtio_ring to virtio queue"


This immediately reverts the previous commit, solely for the
benefit of latexdiff.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@557} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
4331df8 & 16 Feb 2016 & mstsirkin & { virtio-ring.h -> virtio-queue.h


Since vring* and VRING* have been replaced with virtq* and VIRTQ*
respectively, rename the header virtio_ring.h to virtio_queue.h.

Suggested-by: Kevin Lo <kevlo@kevlo.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@558} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
be7a82c & 16 Feb 2016 & mstsirkin & { init: sort status bits


Status bit order is inconsistent: they are neither in increasing
order nor in the order they are likely to be used.

The second approach seems more useful since there aren't
that many bits, so the numerical order does not help much.

A typical order of use would be:

ACKNOWLEDGE
DRIVER
then either FAILED or FEATURES_OK
then either FAILED or DRIVER_OK
then DEVICE_NEEDS_RESET (if device detects an error)

Sort the bits accordingly.

Reported-by: Kevin Lo <kevlo@kevlo.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@559} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
910b352 & 16 Feb 2016 & mstsirkin & { fixupdiff: update for latest perl


Escape \{\} in regexes to avoid warnings in latest perl.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@560} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
6dc3e40 & 16 Feb 2016 & mstsirkin & { virtio header: fix diff generation


add old cross reference as well as an chapter parameter
to avoid latexdiff errors when chapter is renamed.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@561} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
caaf1f0 & 16 Feb 2016 & mstsirkin & { fixupdiff: actually apply the DIFadd/DIFdel hack


looks like recent changes made it inactive: must
change \$line, not \$_.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@562} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a510be9 & 16 Feb 2016 & mstsirkin & { makediff: cherry pick file name change


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@563} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
cf56d82 & 16 Feb 2016 & mstsirkin & { cl: list changes since CSPRD05


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@565} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
fed7c98 & 16 Feb 2016 & mstsirkin & { makediff: suppress diff for chater names


Temporary hack since we have nameref pointing
to a chapter name, and that conflicts with latexdiff.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@566} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
dea81ca & 16 Feb 2016 & mstsirkin & { acknowledgements: update affiliation for Thomas Huth


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@567} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
e16283e & 16 Feb 2016 & mstsirkin & { acknowledgements: acknowledge review by Kevin Lo


Cc: Kevin Lo <kevlo@kevlo.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@568} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
472df8f & 16 Feb 2016 & mstsirkin & { title: drop Rusty's email from chair/editor list


I kept Rusty's name in the acknowledgements section,
but listing him as Chair/Editor does not help since
the email listed bounces.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@569} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2aa7268 & 22 Jul 2016 & mstsirkin & { REVISION: update for cs04


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/branches/v1.0@570} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
713d75d & 22 Jul 2016 & mstsirkin & { Merge remote-tracking branch 'origin/v1.0'


git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@572} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
91b94dd & 10 Oct 2016 & mstsirkin & { ccw: add CCW_CMD_READ_STATUS


ccw currently allows the driver to update the status via the
CCW_CMD_WRITE_STATUS command; however, it does not allow the driver to
retrieve the current status at the device, which is needed to properly
support DEVICE_NEEDS_RESET.

Therefore, provide a new command CCW_CMD_READ_STATUS allowing the driver
to retrieve the device status. Provide this command when revision 2 has
been negotiated.

VIRTIO-117

Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Message-Id: <1445243513-2263-2-git-send-email-cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@579} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
b40a1b7 & 10 Oct 2016 & mstsirkin & { vsock: reserve device ID


Add a device ID for the Socket device.  The draft specification is
currently under review but it helps to reserve the ID to avoid
collisions with other new virtio devices.

VIRTIO-147

Suggested-by: Ian Campbell <ian.campbell@docker.com>
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Message-Id: <1458729661-7514-1-git-send-email-stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@580} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
f7df876 & 10 Oct 2016 & mstsirkin & { virtio: reserve device id for virtio crypto


Reserve a device ID for virtio crypto device to
avoid collisions with other new virtio devices.

Because 19 had been reserved for virtio socket
device, I'd like to reserve 20 for crypto device.

VIRTIO-148

Suggested-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Gonglei <arei.gonglei@huawei.com>
Message-Id: <1460685060-5904-1-git-send-email-arei.gonglei@huawei.com>
Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@581} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
11d93e9 & 10 Oct 2016 & mstsirkin & { content: reserve virtio device ID for sdm


VIRTIO-149

Signed-off-by: Christian Pinto <c.pinto@virtualopensystems.com>
Signed-off-by: Baptiste Reynal <b.reynal@virtualopensystems.com>
Message-Id: <1467111824-11548-2-git-send-email-c.pinto@virtualopensystems.com>
Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@582} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
0e05ee7 & 10 Oct 2016 & mstsirkin & { content: Reserve virtio device ID for pstore


This patch just reserve next available device ID for pstore device
type.  The device specification for pstore will come later.

VIRTIO-150

Signed-off-by: Namhyung Kim <namhyung@kernel.org>
Message-Id: <1468941217-12904-1-git-send-email-namhyung@gmail.com>
Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@583} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
58bc22e & 11 Oct 2016 & mstsirkin & { virtio-net: add Max MTU configuration field


It is helpful for a host to indicate it's MTU to be set on guest NICs
other than the assumed 1500 byte value.  This helps in situations where
the host network is using Jumbo Frames, or aiding in PMTU discovery by
configuring a homogenous network.  It is also helpful for sizing receive
buffers correctly.

The change adds a new field to configuration area of network
devices.  It will be used to pass a maximum MTU from the device to
the driver.  This will be used by the driver as a maximum value for
packet sizes during transmission, without segmentation offloading.

In addition, in order to support backward and forward compatibility,
we introduce a new feature bit called VIRTIO_NET_F_MTU.

VIRTIO-152

Signed-off-by: Aaron Conole <aconole@redhat.com>
Cc: Victor Kaplansky <victork@redhat.com>
Reviewed-by: Hannes Reiencke <hare@suse.de>
Acked-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Maxime Coquelin <maxime.coquelin@redhat.com>
Acked-by: Cornelia Huck <cornelia.huck@de.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@585} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
a5d961b & 11 Oct 2016 & mstsirkin & { git-svn: instructions for faster init


initial svn clone takes ages. A faster way is to copy history
from a git mirror. Document this.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@586} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
2124da1 & 10 Jan 2017 & mstsirkin & { context: Document VIRTIO_F_IOMMU_PLATFORM reserved feature bit (33)


On most virtio systems, physical addresses are provided from the driver
to the device and subsequently used to access memory directly. However,
some systems feature an IOMMU that complicates things slightly:

  - The IOMMU might require configuration for DMA to work at all. Once
    configured, the driver must pass bus addresses to the device, which
    are then translated by the IOMMU into physical addresses in memory.

  - The IOMMU might be bypassed by virtio DMA. In this case, physical
    addresses must still be provided to the device by the driver, even
    though an IOMMU appears to be present.

This has been solved by the addition of a new reserved feature bit,
VIRTIO_F_IOMMU_PLATFORM, to describe the two cases above. Legacy systems
will not negotiate the feature, and therefore continue to operate
directly on physical addresses.

VIRTIO-154

Cc: Michael S. Tsirkin <mst@redhat.com>
Cc: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Will Deacon <will.deacon@arm.com>

git-svn-id: \url{https://tools.oasis-open.org/version-control/svn/virtio/trunk@587} 0c8fb4dd-22a2-4bb5-bc14-6c75a5f43652

 } \\
\hline
7b1913e & 07 Sep 2017 & robincover & { Initial commit

 } \\
\hline
29c2fb5 & 07 Sep 2017 & Robin Cover & { update README with noilerplate


 } \\
\hline
b6830de & 07 Sep 2017 & robincover & { Create CONTRIBUTING.md

 } \\
\hline
8af53d5 & 07 Sep 2017 & robincover & { create boilerplate LICENSE text

 } \\
\hline
702ea21 & 07 Sep 2017 & Robin Cover & { typo, case


 } \\
\hline
725ffa9 & 08 Sep 2017 & Michael S. Tsirkin & { Merge \url{https://github.com/oasis-tcs/virtio-spec} into trunk


This merges in the OASIS boilerplate files in preparation to
moving virtio spec development to git, as approved at:

\url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3120}

Files added:

CONTRIBUTING.md
LICENSE.md
README.md

TODO: tweak boilerplate files as appropriate/needed.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
849b35c & 08 Sep 2017 & Cornelia Huck & { title, acknowledgements: update my affiliation


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
81e0eec & 08 Sep 2017 & Cornelia Huck & { virtio-net: fix virtqueue numbering error


receiveq(n) is at position 2(n-1), not 2n. Same error for transmitq(n)
and controlq.

VIRTIO-161

Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Halil Pasic <pasic@linux.vnet.ibm.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
4efd303 & 11 Sep 2017 & Michael S. Tsirkin & { net: clarify device rules for mergeable buffers


The idea behind mergeable buffers was to simply use them in a way
similar to a chain of descriptors.  Unfortunately the current text does
not say so - apparently nothing says device can't spread a packet over
as many buffers as it likes - but this didn't prevent drivers from
relying on buffers being used as a chain of descriptors, completely -
and blindly accessing it without checking the length at least for the
packet header.

Let's just make the spec match this reality - if devices ever want more
flexibility, we can add a feature bit.

Further, correct all misuses of a "descriptor" to "buffer" as that
is the entity that is being merged.

VIRTIO-160

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Message-Id: <1490655576-12173-1-git-send-email-mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
2faf9b0 & 11 Sep 2017 & Michael S. Tsirkin & { net: relax buf size requirements for mrg buffers


VIRTIO-84 added a requirement that each buffer is > header size but
there's no reason to require that for merge-able buffers since data can
be placed in follow-up buffers.

The current wording seems confusing enough that it seems likely
no one relies on this.

VIRTIO-159

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Message-Id: <1490654778-11857-1-git-send-email-mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
8d3e3b7 & 12 Dec 2017 & Jean-Philippe Brucker & { content: reserve virtio device ID for IOMMU


Reserve device ID 23 for virtio-iommu devices.

Resolved VIRTIO-162
Approved \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3155}

Signed-off-by: Jean-Philippe Brucker <jean-philippe.brucker@arm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
0b404d2 & 09 Mar 2018 & Michael S. Tsirkin & { README.md: add hints for contributors


Add links to admin repo and mailing lists.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
3ab4fa4 & 09 Mar 2018 & Paolo Bonzini & { virtio-scsi: fix typos


Fixes: VIRTIO-155
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3118}

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
4f27513 & 14 Mar 2018 & Michael S. Tsirkin & { github: PULL_REQUEST_TEMPLATE.md


Document that we don't accept pull requests at this point.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
4aa4668 & 20 Mar 2018 & Michael S. Tsirkin & { introduction: document bitfield notation


Bitfields are a useful and familiar way to specify sub-byte structure
layout. The only issue is that bitfield order isn't portable across
architectures.  Document that we list bitfields from least to
most significant one, and warn about portability issues.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
2c0ec7d & 20 Mar 2018 & Michael S. Tsirkin & { content: move 1.0 queue format out to a separate section


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
6131f8d & 20 Mar 2018 & Michael S. Tsirkin & { content: move ring text out to a separate file


Will be easier to manage this way.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
967ae52 & 20 Mar 2018 & Michael S. Tsirkin & { content: move virtqueue operation description


virtqueue operation description is specific to the virtqueue
format. Move it out to split-ring.tex and update all
references.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
fac073a & 20 Mar 2018 & Michael S. Tsirkin & { content: len -> used length, used ring -> vq


Document buffer used len and use that terminology everywhere in the
generic section.

Further, drop the 'used ring' terminology and just say virtqueue.

Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
ae98c6b & 20 Mar 2018 & Michael S. Tsirkin & { content: generalize transport ring part naming


Replace descriptor table/available ring/used ring
with descriptor area/driver area/device area
in all transports.

Document what's in which area.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
323f819 & 20 Mar 2018 & Michael S. Tsirkin & { content: generalize rest of text


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
619a278 & 20 Mar 2018 & Michael S. Tsirkin & { split-ring: generalize text


Update generic text to talk about available/used buffers, not rings.
Move some split-ring specific text to the correct section.

Update conformance section with link to the new conformance clause.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
8ff142a & 20 Mar 2018 & Michael S. Tsirkin & { split-ring: typo: aligment

Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
40d6ce0 & 20 Mar 2018 & Michael S. Tsirkin & { packed virtqueues: more efficient virtqueue layout


Performance analysis of this is in my kvm forum 2016 presentation.  The
idea is to have a r/w descriptor in a ring structure, replacing the used
and available ring, index and descriptor buffer.

This is also easier for devices to implement than the 1.0 layout.
Several more enhancements will be necessary to actually make this
efficient for devices to use.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Cornelia Huck <cohuck@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
1f4a79e & 20 Mar 2018 & Michael S. Tsirkin & { content: in-order buffer use


Using descriptors in-order is sometimes beneficial.  Add an option for
that - per-format detail allowing more optimizations will be added by
follow-up patches.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
9111276 & 20 Mar 2018 & Michael S. Tsirkin & { packed-ring: add in order support


Support in-order requests for packed rings.
This allows selective write-out of used descriptors.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
ad89d36 & 20 Mar 2018 & Michael S. Tsirkin & { split-ring: in order feature


For a split ring, require that drivers use descriptors in order too.
This allows devices to skip reading the available ring.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3177}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/3}

 } \\
\hline
88c8553 & 20 Mar 2018 & Changpeng Liu & { virtio-blk: add discard and write zeroes features to specification


Existing virtio-blk protocol doesn't have DISCARD/WRITE ZEROES support,
this will impact the performance when using SSD backend over file systems.

Here is the proposal to extend existing virtio-blk protocol to support
DISCARD/WRITE ZEROES commands.

Basic idea here is using 16 Bytes payload to support 1 descriptor, users
can put several segments together with 1 DISCARD/WRITE ZEROES command.

struct virtio_blk_discard_write_zeroes .

       le64 sector;
       le32 num_sectors;
       struct .

               le32 unmap:1;
               le32 reserved:31;
       \} flags;
\};

For the purpose to support such feature, we need to introduce 2 new feature
flags: VIRTIO_BLK_F_DISCARD/VIRTIO_BLK_F_WRITE_ZEROES, and 2 new command
types: VIRTIO_BLK_T_DISCARD/VIRTIO_BLK_T_WRITE_ZEROES. Also we introduce
several new parameters in the configuration space of virtio-blk:
max_discard_sectors/max_discard_seg/max_write_zeroes_sectors.
These parameters will tell the OS what's the granularity when
issuing such commands.

If both DISCARD and WRITE ZEROES are supported, unmap flag bit maybe used
for WRITE ZEROES command with DISCARD bit enabled.

Signed-off-by: Changpeng Liu <changpeng.liu@intel.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3181}
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/5}

 } \\
\hline
5862219 & 20 Mar 2018 & Tom Golembiovsk & { content: document balloon memory statistics


Linux kernel provides some balloon memory statistics that were not
included in the specs. Include them to avoid any ID clashes in the
future.

Signed-off-by: Tom Golembiovsk <tgolembi@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/4}
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3180}

 } \\
\hline
602987f & 20 Mar 2018 & sameehj & { virtio-net: Add missing flag define to struct


The flag VIRTIO_NET_HDR_F_DATA_VALID is aleady  mentioned in the virtio-net
spec however it is not defined in the struct. This flag is already defined
and used in virtio-net device in Qemu as well as some of it's drivers.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/6}
Approved-by: \url{https://www.oasis-open.org/apps/org/workgroup/virtio/ballot.php?id=3182}

 } \\
\hline
0b0fc84 & 26 Mar 2018 & Stefan Hajnoczi & { packed-ring: add missing articles to sentences


There are several sentence structures used throughout the text where an
article is missing.  For example:

  ... allocated by driver.

or

  Driver then notifies the device.

Standards documents normally use complete sentences so this patch adds
the missing articles required before the noun ("driver"):

  ... allocated by the driver.

or

  The driver then notifies the device.

Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/7}
Approved-by: \url{https://www.oasis-open.org/committees/ballot.php?id=3184}

 } \\
\hline
5c9f1f6 & 26 Mar 2018 & Stefan Hajnoczi & { packed-ring: add missing comma


Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/7}
Approved-by: \url{https://www.oasis-open.org/committees/ballot.php?id=3184}

 } \\
\hline
1b355f1 & 26 Mar 2018 & Stefan Hajnoczi & { packed-ring: fix 'contigious' typo


Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/7}
Approved-by: \url{https://www.oasis-open.org/committees/ballot.php?id=3184}

 } \\
\hline
336d94f & 26 Mar 2018 & Stefan Hajnoczi & { packed-ring: fix capitalization of names


Names are capitalized, like the Element Length field.  General terms
like descriptor are not capitalized.

This patch fixes two instances where this is inconsistent.

Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/7}
Approved-by: \url{https://www.oasis-open.org/committees/ballot.php?id=3184}

 } \\
\hline
bb4c655 & 26 Mar 2018 & Stefan Hajnoczi & { packed-ring: fix plurals


There are two instances where plural needs to be used instead of
singular:

1. "descriptor(s)" is used later in the text, so use it consistently
   instead of starting with "descriptor" and switching later.

2. "What follows is the requirements" ->
   "What follows are the requirements"

Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/7}
Approved-by: \url{https://www.oasis-open.org/committees/ballot.php?id=3184}

 } \\
\hline
624fab7 & 26 Mar 2018 & Stefan Hajnoczi & { packed-ring: fix "the descriptor flags +field+ is updated"


Either it needs to be "the descriptors flags are update" (since "flags"
is plural) or "the descriptor flags field is updated".  Since "flags" is
a name of a specific field, I chose the latter solution.

Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/7}
Approved-by: \url{https://www.oasis-open.org/committees/ballot.php?id=3184}

 } \\
\hline
91d9850 & 26 Mar 2018 & Stefan Hajnoczi & { packed-ring: rephrase "an example driver code"


Either "an example of driver code" or "a driver code example" would
work.

Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/7}
Approved-by: \url{https://www.oasis-open.org/committees/ballot.php?id=3184}

 } \\
\hline
396b195 & 27 Mar 2018 & Michael S. Tsirkin & { VIRTIO_F_NOTIFICATION_DATA: extra data to devices


Some devices benefit from ability to find out the number of available
descriptors in the ring: for efficiency or as a debugging aid.

To help with these optimizations, add a new feature:
VIRTIO_F_NOTIFICATION_DATA. When negotiated, driver notifications to the
device include this extra information.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
26b3760 & 16 Apr 2018 & Michael S. Tsirkin & { tex: drop unused todonotes


We don't really use todonotes, this dependency can be dropped.  We do
need to import xcolor which was previously pulled in by todonotes.

Tested-by: Mihai Carabas <mihai.carabas@oracle.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
d4fec51 & 16 Apr 2018 & Michael S. Tsirkin & { tex: enable build on systems without ellipsis.sty


Unfortunately some systems (e.g. RHEL7.5 and derivatives) lack
the ellipsis package. As it's function is merely cosmetic,
support these systems by loading the package conditionally.

Tested-by: Mihai Carabas <mihai.carabas@oracle.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
09255de & 26 Apr 2018 & Michael S. Tsirkin & { Revert "VIRTIO_F_NOTIFICATION_DATA: extra data to devices"


This reverts commit 396b1957817e0bd14697e28d9fe61bfc80f1350f.

Was pushed by mistake.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
545c92f & 23 May 2018 & Christoffer Dall & { split-ring: Fix typo in used ring description


Only the device updates the used ring.

This looks like a typo as a result of copy-paste from the description of
the Available Ring.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/12}
Signed-off-by: Christoffer Dall <christoffer.dall@arm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Laszlo Ersek <lersek@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
846540e & 23 May 2018 & Michael S. Tsirkin & { README: supply link to the authoritative source


authoritative source is the tagged version.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
64d1a58 & 23 May 2018 & Jonathan Helman & { content: document hugetlb page allocation counts


The Linux kernel exports the number of successful and failed
hugetlb page allocations via the virtio balloon driver. These
two counts need to be documented in this specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/8}
Signed-off-by: Jonathan Helman <jonathan.helman@oracle.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
12fe939 & 23 May 2018 & Tiwei Bie & { VIRTIO_F_IO_BARRIER: use I/O barriers in driver


There will be hardware virtio devices in the future, which
require drivers to use the barriers suitable for I/O devices,
compared with software virtio devices which just require
drivers to use the barriers suitable for CPU cores.

To fix the ordering issue for hardware virtio devices, add
a new feature: VIRTIO_F_IO_BARRIER. When negotiated, driver
will use the barriers suitable for I/O devices.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/10}
Signed-off-by: Tiwei Bie <tiwei.bie@intel.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
89dd55f & 07 Jun 2018 & Tiwei Bie & { content: support SR-IOV


Allocate a feature bit for virtio devices which support SR-IOV.
Note: at proposer's request, driver requirements have been
omitted - a reworked version is now being discussed.

Suggested-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Tiwei Bie <tiwei.bie@intel.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/11}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
a3b726c & 07 Sep 2018 & Sridhar Samudrala & { content: Introduce VIRTIO_NET_F_STANDBY feature


VIRTIO_NET_F_STANDBY feature enables hypervisor to indicate virtio_net
device to act as a standby for another device with the same MAC address.

Signed-off-by: Sridhar Samudrala <sridhar.samudrala@intel.com>
Acked-by: Cornelia Huck <cohuck@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/18}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
fed6423 & 07 Sep 2018 & Gerd Hoffmann & { Add virtio gpu device specification.


Support for 2d mode (3d/virgl mode is not covered by this patch) has
been added to the linux kernel version 4.2 and to qemu version 2.4.

Cc: Laszlo Ersek <lersek@redhat.com>
Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Laszlo Ersek <lersek@redhat.com>
Tested-by: Laszlo Ersek <lersek@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/17}

 } \\
\hline
139e051 & 19 Oct 2018 & Halil Pasic & { notifications: unify notifications wording in core


Let us unify the wording when talking about notifications. This change
establishes the terms available buffer notification for what was usually
simply called notification or virtqueue notification in v1.0 and used
buffer notification for what was usually called interrupt.

The term configuration change notification in kept where called so and
consolidated where it's called configuration change interrupt or
similar.

The changes done here are limited to the core part, and don't
conceptually involve neither the transports nor the devices (references
are updated though). Future changes should address these parts.

Signed-off-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
f5f10de & 19 Oct 2018 & Halil Pasic & { notifications: notifications as basic virtio facility


Let's introduce notifications as basic virtio facility early on. This
shall not only increase the cohesion between core and transport
description by having a well-defined  place where notifications are
introduced, but also give us the opportunity to explain some
discrepancies.

Namely notifications sent by the device to the driver were often called
interrupts prior to v1.1. Getting completely rid of that terminology is
however not viable in case of some names.

Signed-off-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
c478392 & 19 Oct 2018 & Halil Pasic & { ccw: map common notifications terminology to ccw


The various notifications are introduced and specified in the common
(i.e. transport agnostic) portion of this specification. How
notifications are realised for a given transport is something each
transport has to specify.

Let's make the relationship between the virtio-ccw terms and the common
terms more obvious.

Signed-off-by: Halil Pasic <pasic@linux.ibm.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
9ded7d7 & 19 Oct 2018 & Halil Pasic & { pci: map common notifications terminology to PCI


The various notifications are introduced and specified in the common
(i.e. transport agnostic) portion of this specification. How
notifications are realised for a given transport is something each
transport has to specify.

Let's make the relationship between the PCI terms and the common
terms more obvious.

Signed-off-by: Halil Pasic <pasic@linux.ibm.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
0ec888d & 19 Oct 2018 & Halil Pasic & { mmio: map common notifications terminology to MMIO


The various notifications are introduced and specified in the common
(i.e. transport agnostic) portion of this specification. How
notifications are realised for a given transport is something each
transport has to specify.

Let's make the relationship between the virtio over MIIO terms and the
common terms more obvious.

Signed-off-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
a2e22e2 & 19 Oct 2018 & Halil Pasic & { notifications: update notifications terminology for devices


The specifications of some virtio device types are still using the old
terminology for used buffer notifications and configuration change
notifications calling these interrupts.

Let us fix that.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/16}
Signed-off-by: Halil Pasic <pasic@linux.ibm.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
a385dd3 & 19 Oct 2018 & Longpeng(Mike) & { virtio-crypto: Add virtio crypto device specification


The virtio crypto device is a virtual crypto device (ie. hardware
crypto accelerator card). Currently, the virtio crypto device provides
the following crypto services: CIPHER, MAC, HASH, and AEAD.

In this patch, CIPHER, MAC, HASH, AEAD services are introduced.

VIRTIO-153

Signed-off-by: Gonglei <arei.gonglei@huawei.com>
Signed-off-by: Zhoujian <jianjay.zhou@huawei.com>
Signed-off-by: Longpeng(Mike) <longpeng2@huawei.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
8b7260d & 19 Oct 2018 & Longpeng(Mike) & { virtio-crypto: Add virtio crypto device specification


The virtio crypto device is a virtual crypto device (ie. hardware
crypto accelerator card). Currently, the virtio crypto device provides
the following crypto services: CIPHER, MAC, HASH, and AEAD.

In this patch, CIPHER, MAC, HASH, AEAD services are introduced.

VIRTIO-153

Signed-off-by: Gonglei <arei.gonglei@huawei.com>
Signed-off-by: Zhoujian <jianjay.zhou@huawei.com>
Signed-off-by: Longpeng(Mike) <longpeng2@huawei.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
e15f78d & 19 Oct 2018 & Longpeng(Mike) & { virtio-crypto: Add conformance clauses


Add the conformance targets and clauses for
virtio-crypto device.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/19}
Signed-off-by: Gonglei <arei.gonglei@huawei.com>
Signed-off-by: Zhoujian <jianjay.zhou@huawei.com>
Signed-off-by: Longpeng(Mike) <longpeng2@huawei.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
7e4d8df & 19 Oct 2018 & Michael S. Tsirkin & { crypto: fix label name


fixes multiply defined label error

 } \\
\hline
ec2e253 & 19 Oct 2018 & Michael S. Tsirkin & { crypto: fix label name typos


fixes undefined reference errors

 } \\
\hline
a6ab4eb & 19 Oct 2018 & Tiwei Bie & { content: use a consistent wording for device status


There is a part called "device status field" in a
Virtio device. Currently, both of \textbackslash field\{status.

and \textbackslash field\{device status\} are used to refer to it,
which is a bit confusing. This patch changes spec
to use \textbackslash field\{device status\} consistently.

Suggested-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Tiwei Bie <tiwei.bie@intel.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/15}
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
13671b9 & 19 Oct 2018 & Tiwei Bie & { content: enhance device requirements for feature bits


Suggested-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Tiwei Bie <tiwei.bie@intel.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/14}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Acked-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
04eaf2b & 19 Oct 2018 & David Hildenbrand & { content: reserve virtio device ID for memory devices


Reserve device ID 24 for virtio-mem devices.

Signed-off-by: David Hildenbrand <david@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Acked-by: Cornelia Huck <cohuck@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/9}

 } \\
\hline
a01bce8 & 30 Nov 2018 & Tiwei Bie & { content: document SR-IOV driver requirements


Document the driver requirements for the VIRTIO_F_SR_IOV
feature bit.

Suggested-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Tiwei Bie <tiwei.bie@intel.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/13}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
9438414 & 30 Nov 2018 & Yuri Benditovich & { content: Declare virtio-net legacy feature bits 41-42


These bits are in use by current Windows production driver
for virtio-net. If virtio-net device uses one of them
the driver will not function. Reserving these bits for
virtio-net device until current production driver reaches EOL.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/21}

Signed-off-by: Yuri Benditovich <yuri.benditovich@daynix.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
31d2e35 & 30 Nov 2018 & Gerd Hoffmann & { Add VIRTIO_GPU_F_EDID to virtio-gpu.


The feature allows the guest request an EDID blob (describing monitor
capabilities) for a given scanout (aka virtual monitor connector).

It brings a new command message, which has just a scanout field (beside
the standard virtio-gpu header) and a response message which carries the
EDID data.

Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/22}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
b50f8e6 & 30 Nov 2018 & Gerd Hoffmann & { Add virtio input device specification.


Support has been added to the linux kernel version 4.1
and to qemu version 2.4.

Signed-off-by: Ladi Prosek <lprosek@redhat.com>
Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/23}

 } \\
\hline
09245d6 & 30 Nov 2018 & Daniel Marcovitch & { packed-ring/split-ring/content: fixed misc typos


Signed-off-by: Daniel Marcovitch <danielm@mellanox.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/24}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
58b1cd6 & 30 Nov 2018 & Daniel Marcovitch & { queue_size: renamed "hypervisor" to "device"


fixed to be consistent with the device/driver terminology in other surrounding descriptions

Signed-off-by: Daniel Marcovitch <danielm@mellanox.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/24}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
9ac151a & 30 Nov 2018 & Michael S. Tsirkin & { editing: update to the new OASIS logo


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
adb6c13 & 30 Nov 2018 & Michael S. Tsirkin & { edit: update to new OASIS color


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
5c3e232 & 30 Nov 2018 & Michael S. Tsirkin & { edit: update title links to previous version


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
ea3e8b3 & 30 Nov 2018 & Michael S. Tsirkin & { edit: update REVISION and date


Set to wd01 for now.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
5067859 & 30 Nov 2018 & Michael S. Tsirkin & { edit: drop Pawel as an editor


As he's not a TC member right now.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
9e57474 & 30 Nov 2018 & Michael S. Tsirkin & { edit: drop cs04 changelog


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
66631da & 12 Dec 2018 & Stefan Hajnoczi & { vsock: add vsock device


The virtio vsock device is a zero-configuration socket communications
device.  It is designed as a guest<->host management channel suitable
for communicating with guest agents.

vsock is designed with the sockets API in mind and the driver is
typically implemented as an address family (at the same level as
AF_INET).  Applications written for the sockets API can be ported with
minimal changes (similar amount of effort as adding IPv6 support to an
IPv4 application).

Unlike the existing console device, which is also used for guest<->host
communication, multiple clients can connect to a server at the same time
over vsock.  This limitation requires console-based users to arbitrate
access through a single client.  In vsock they can connect directly and
do not have to synchronize with each other.

Unlike network devices, no configuration is necessary because the device
comes with its address in the configuration space.

The vsock device was prototyped by Gerd Hoffmann and Asias He.  I picked
the code and design up from them.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/27}
Cc: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
3c19f4b & 12 Dec 2018 & Michael S. Tsirkin & { ACCESS_PLATFORM/ORDER_PLATFORM


This is an attempt to clarify the intent behind
VIRTIO_F_IOMMU_PLATFORM and VIRTIO_F_IO_BARRIER
which based on recent discussions appear to be hard to understand.


- rename VIRTIO_F_IOMMU_PLATFORM to ACCESS_PLATFORM
  It is already the fact that the DMA API that Linux
  uses does more than just IOMMUs - it includes
  cache flushing, bounce buffers for limited
  addressing, etc.
  Update spec to match this reality.


- rename VIRTIO_F_IO_BARRIER to VIRTIO_F_ORDER_PLATFORM
  this is after all what device is telling driver:
  its memory accesses are only ordered weakly,
  this is why a stronger barrier is required.


- As no one yet implemented IO_BARRIER yet, add a recommendation
  to have a software fallback so that existing drivers
  aren't broken.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/25}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
4ca1311 & 12 Dec 2018 & Michael S. Tsirkin & { VIRTIO_F_NOTIFICATION_DATA: extra data to devices


Some devices benefit from ability to find out the number of available
descriptors in the ring: for efficiency or as a debugging aid.

To help with these optimizations, add a new feature:
VIRTIO_F_NOTIFICATION_DATA. When negotiated, driver notifications to the
device include this extra information.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/26}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
8a5ce09 & 12 Dec 2018 & Michael S. Tsirkin & { packed-ring: fix queue size for pci


PCI is the only transport that has text enforcing
a power of two size for VQs. There's no real reason
for it to do it, so document that it does not apply
with the packed rings.

Accordingly, drop the text "unless enforced by a transport"
from packed ring description.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/28}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
af42ed7 & 12 Dec 2018 & Yuri Benditovich & { content: RSC extension support for virtio-net


Allocates feature bit for extended RSC (receive
side coalescing) support. If the device supports
this feature, it is able to process duplicated
ACKs and report number of coalesced TCP segments
amd number of received duplicated ACKs.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/20}

Signed-off-by: Yuri Benditovich <yuri.benditovich@daynix.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
e952fd5 & 12 Dec 2018 & Michael S. Tsirkin & { Revert "edit: drop cs04 changelog"


This reverts commit c036ac7b4b507a3bbb9c74a9a941bcb611c96b4b.

 } \\
\hline
68a31cf & 12 Dec 2018 & Michael S. Tsirkin & { edit: drop cs04 changelog


move to cl-cs04.tex

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
52e2045 & 12 Dec 2018 & Michael S. Tsirkin & { edit: update VERSION


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
133c895 & 12 Dec 2018 & Yuri Benditovich & { virtio-net: changing VIRTIO_NET_F_RSC_EXT from 38 to 61


Changing feature bit per TC request.

Signed-off-by: Yuri Benditovich <yuri.benditovich@daynix.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
0a4ff10 & 12 Dec 2018 & Michael S. Tsirkin & { split-ring: document in-order operation


The point of in-order for the device is to be able to skip
writing out some used descriptors, but the documentation
that we have was put in the packed ring section and
written in a way specific to the packed ring.

Writing it in a generic way is tricky, for now this patch just copies
the text from the packed ring to the split ring section, with minor
tweaks.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/30}
Suggested-by: Jason Wang <jasowang@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
a8b7841 & 11 Jan 2019 & Michael S. Tsirkin & { packed-ring: put normative on one line


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
c3c0bcc & 11 Jan 2019 & Michael S. Tsirkin & { edit: don't stop on empty cherry-picks


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
36da9bf & 11 Jan 2019 & Michael S. Tsirkin & { edit: more fixup diff hacks


Tweak latex diff output some more to fix up failures.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
c8cf815 & 11 Jan 2019 & Michael S. Tsirkin & { edit: teach diff to re-add back missing labels


For now just rely on a manual list.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
70e1f04 & 11 Jan 2019 & Michael S. Tsirkin & { edit: drop obsolete commands related to cs02


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
e31a363 & 11 Jan 2019 & Michael S. Tsirkin & { edit: fixupdiff: fix more unresolved references


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
4d823ad & 11 Jan 2019 & Michael S. Tsirkin & { edit: minor diffpreable cleanup


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
b94db01 & 11 Jan 2019 & Michael S. Tsirkin & { edit: pick up a cleanup commit for diff


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
6a19063 & 11 Jan 2019 & Michael S. Tsirkin & { edit: use dark green for diffs


plays better with nw color scheme

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
31746f8 & 11 Jan 2019 & Michael S. Tsirkin & { edit: drop hyperlink coloring from diff


Looks nice but creates lots of problems with coloring
as packages begin to conflict.
Drop it for now.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
15b16c1 & 11 Jan 2019 & Michael S. Tsirkin & { edit: drop groups from DIFnomarkup


not needed anymore and just confuses latex

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
1f6e12c & 11 Jan 2019 & Michael S. Tsirkin & { edit: diff: color added listings green


Note: does not apply to lstinputlisting .

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
bb32d2a & 11 Jan 2019 & Tiwei Bie & { packed-ring: fix used descriptor checking in example code


When the driver is processing used descriptors in parallel
with adding new available descriptors, the driver can't just
check whether USED bit equals to the used wrap counter when
checking whether a descriptor is a used descriptor, because
the driver also needs to check whether the descriptor has
been made available. Below is an example:

Assuming ring size is 4, ring's initial state will be:

+----+----+----+----+
| 00 | 00 | 00 | 00 |
+----+----+----+----+

00 means AVAIL=0 USED=0, 01 means AVAIL=0 USED=1
10 means AVAIL=1 USED=0, 11 means AVAIL=1 USED=1

After the driver made two descriptor chains available and
each chain consists of two descriptors, the ring could be:

+----+-----------+----+-----------+
| 10 | 10 (id=0) | 10 | 10 (id=1) |
+----+-----------+----+-----------+

After the device processed all the available descriptors and
made them used (e.g. in order), the ring could be:

+-----------+----+-----------+----+
| 11 (id=0) | 10 | 11 (id=1) | 10 |
+-----------+----+-----------+----+

After the driver processed all the used descriptors and made
one descriptor (not chained, just one descriptor) available,
the ring could be:

+-----------+----+----+----+
| 01 (id=0) | 10 | 11 | 10 |
+-----------+----+----+----+

After the device made that descriptor used, the ring will be:

+-----------+----+----+----+
| 00 (id=0) | 10 | 11 | 10 |
+-----------+----+----+----+

If the driver just checks whether USED bit equals to the used
wrap counter when checking whether a descriptor is a used
descriptor, after processing the first descriptor (whose
AVAIL and USED bits are both 0), and advancing vq->next_used
pointer, it will then also treat the next descriptor, i.e.
the second descriptor (whose AVAIL and USED bits are 1 and
0 respectively) as a used descriptor which is wrong.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/29}
Signed-off-by: Tiwei Bie <tiwei.bie@intel.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Approved-by: \url{https://www.oasis-open.org/committees/ballot.php?id=3184}

 } \\
\hline
990739a & 11 Jan 2019 & Michael S. Tsirkin & { revision: update to 20 dec 2018


note: previous commit (fixup example code)
was missing in that revision. Will tag accordingly.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
1a6406d & 11 Jan 2019 & Michael S. Tsirkin & { edit: address comments by Paul Knight


Several changes will be needed to the documents prepared by the TC:


- date should be set to "20 December 2018" in subtitle, page footers, and
citation format

- "Previous version" should just show "N/A" instead of URIs from v1.0-cs04
(this is a new Version)

-  use "https" instead of http for all URIs for this specification. (including
citation format)

-  insert actual stage name - "csprd01" instead of "wd12122018" in all of the URIs

-  replace "Working Draft" with "Committee Specification Draft 01 / Public
Review Draft 01" in subtitle and in Citation format text.

-  change the "title" attribute/tag in the HTML file to be "Virtual I/O Device
(VIRTIO) Version 1.1" instead of "... Version 1.0"

-  add reference to VIRTIO v1.0 in the "Related work" section, similar to the
0.9.5 reference (replaces or supersedes) - (Virtual I/O Device (VIRTIO) Version
1.0. Edited by Rusty Russell, Michael S. Tsirkin, Cornelia Huck, and Pawel
Moll. Latest version: \url{http://docs.oasis-open.org/virtio/virtio/v1.0/}
virtio-v1.0.html.) - copied from v1.0-cs04 citation format block, with specific
stage removed

- set the copyright year to be 2018. (in "Notices" and in page footers (PDF))

- in "Citation format" only list the currently identified Editors - Michael S.
Tsirkin and Cornelia Huck (or add other names into "Editors" list near top)

- change "Chairs" to "Chair" near top

- add the new IPR Policy text in the Status section and as Section 1.1 in the
body (details below)

- add the note on machine-readable content as the fourth paragraph in Status
section (details below)

Paragraph 3 of Status section AND Section 1.1 of the specification body "1.1
IPR Policy":   <visible text><hyperlink>

This specification is provided under the <Non-Assertion><\url{https://}
www.oasis-open.org/policies-guidelines/ipr\#Non-Assertion-Mode> Mode of the
<OASIS IPR Policy><\url{https://www.oasis-open.org/policies-guidelines/ipr>,} the
mode chosen when the Technical Committee was established. For information on
whether any patents have been disclosed that may be essential to implementing
this specification, and any offers of patent licensing terms, please refer to
the Intellectual Property Rights section of the TC's web page (<\url{https://}
www.oasis-open.org/committees/virtio/ipr.php><\url{https://www.oasis-open.org/}
committees/virtio/ipr.php>).

Paragraph 4 of Status section:

Note that any machine-readable content (<Computer Language Definitions><\url{https:/}
/www.oasis-open.org/policies-guidelines/tc-process\#wpComponentsCompLang>)
declared Normative for this Work Product is provided in separate plain text
files. In the event of a discrepancy between any such plain text file and
display content in the Work Product's prose narrative document(s), the content
in the separate plain text file prevails.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
372937f & 11 Jan 2019 & Michael S. Tsirkin & { edit: drop more obsolete commands related to cs02


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
5c43ad7 & 27 Feb 2019 & Halil Pasic & { ccw: be more precise about the semantic of revision 1


Revision 1 of the CCW transport is currently defined as virtio 1.0. This
could become confusing when we bump the version of the virtio
specification to 1.1, in a sense that it could be interpreted like one
can not use any features not part of the 1.0 specification.

So let us try to avoid confusion regarding the semantic of virtio-ccw
revision 1.

VIRTIO-163

Signed-off-by: Halil Pasic <pasic@linux.vnet.ibm.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
d348ac0 & 27 Feb 2019 & Halil Pasic & { introduction: simplify the designation of legacy


The sentence designating the documents defining what later
became known as the legacy virtio interface had the most
important piece of information placed in parenthesis.

Let's reword this sentence so we avoid using an ambiguous designation
based on a relative anchor (i.e. 'earlier drafts of this specification')
and just use the absolute anchor (version 1.0).

VIRTIO-164

Signed-off-by: Halil Pasic <pasic@linux.vnet.ibm.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
bef3ff7 & 07 Mar 2019 & Stefan Hajnoczi & { virtio-blk: document data[] size constraints


The struct virtio_blk_req->data[] field is a multiple of 512 bytes long
for read and write requests.  Flush requests don't use data[] at all.

The new discard and write zeroes requests being introduced in VIRTIO 1.1
put struct virtio_blk_discard_write_zeroes elements into data[], so it
must be a multiple of the struct size.

The uint8_t data[][512] pseudo-code makes it look like discard and write
zeroes requests must pad to 512 bytes.  This wastes memory since struct
virtio_blk_discard_write_data is only 16 bytes long.

Furthermore, all known implementations wishing to take advantage of this
upcoming VIRTIO 1.1 feature do not use 512-byte padding (Linux
virtio_blk.ko, QEMU virtio-blk device emulation, the SPDK virtio-blk
driver, and the SPDK vhost-user-blk device backend).

This patch documents the data[] size constraints clearly in the driver
normative section.  This is clearer than the current pseudo-code.

Cc: Michael S. Tsirkin <mst@redhat.com>
Cc: Changpeng Liu <changpeng.liu@intel.com>
Cc: Stefano Garzarella <sgarzare@redhat.com>
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
c5c0ce7 & 07 Mar 2019 & Stefan Hajnoczi & { virtio-blk: move virtio_blk_discard_write_zeroes definition


struct virtio_blk_discard_write_zeroes is defined alongside
struct virtio_blk_req but only discussed later in the text.  Move it to
where it belongs.

Suggested-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
caffe5c & 07 Mar 2019 & Stefan Hajnoczi & { virtio-blk: describe write zeroes unmap semantics


Explain the meaning of the unmap flag.  The details are already covered
in the device normative section but mentioning it here makes the text
easier to understand.

Suggested-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
5f1e981 & 07 Mar 2019 & Stefan Hajnoczi & { virtio-blk: avoid inconsistent "DISCARD" term


"discard" (lowercase) is used throughout the text.  Remove a lone
instance of "DISCARD" (uppercase).

Suggested-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
31a52d2 & 07 Mar 2019 & Stefan Hajnoczi & { virtio-blk: clarify semantics of multi-segment discard/write zeroes commands


Describe the failure case and maximum number of segments in a
multi-segment discard/write zeroes command.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/34}
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
22d214b & 08 Mar 2019 & Michael S. Tsirkin & { close issue 32


Previous changes:
5f1e981 virtio-blk: avoid inconsistent "DISCARD" term
caffe5c virtio-blk: describe write zeroes unmap semantics
c5c0ce7 virtio-blk: move virtio_blk_discard_write_zeroes definition
bef3ff7 virtio-blk: document data[] size constraints
addressed the issue.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/32}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
90047f5 & 21 Mar 2019 & Michael S. Tsirkin & { format: replace "- i.e." with ", i.e.,"


This seems to be preferred by native speakers, and
seems just as effective as a sentence device.

Fixes: \url{https://issues.oasis-open.org/browse/VIRTIO-171}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
c7b2503 & 21 Mar 2019 & Michael S. Tsirkin & { conformance: add links to crypto and input devices


Fixes: \url{https://issues.oasis-open.org/browse/VIRTIO-174}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
0b5288f & 21 Mar 2019 & Michael S. Tsirkin & { signal start and end of structures consistently


Make sure all structs have the format:

struct X .

...
\};

Fixes: \url{https://issues.oasis-open.org/browse/VIRTIO-170}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
69daf06 & 21 Mar 2019 & Michael S. Tsirkin & { editorial: explain each structure before use


Several structures are listed before they are
introduced in some way. Add a sentence before each one
so they don't appear prior to any prose.

Fixes: \url{https://issues.oasis-open.org/browse/VIRTIO-166}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d608f47 & 21 Mar 2019 & Michael S. Tsirkin & { conformance: tweak to match OASIS requirements


Number clauses as required by OASIS.

Also reference the transitional clause.

Fixes: \url{https://issues.oasis-open.org/browse/VIRTIO-168}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
0dbd52d & 21 Mar 2019 & Michael S. Tsirkin & { introduction: update link to IEEE 802


Looks like all GETIEEE links got broken.
Let's just point to their main page.

Fixes: \url{https://issues.oasis-open.org/browse/VIRTIO-175}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Jens Freimann <jfreimann@redhat.com>

 } \\
\hline
7b361ea & 21 Mar 2019 & Michael S. Tsirkin & { editorial: upgrade links to https


Several links have been upgraded and now redirect to the https
version. Upgrade our version accordingly.

Note that some other links use the status 301 - moved permanently
apparently in error (e.g. for a language specific redirect), not
updating these.

Fixes: \url{https://issues.oasis-open.org/browse/VIRTIO-173}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Jens Freimann <jfreimann@redhat.com>

 } \\
\hline
3e49aec & 21 Mar 2019 & Michael S. Tsirkin & { conformance: fix confusion about legacy interface


The text describing the legacy interface also obliquely refers to a
non-transitional implementation. This seems to cause confusion
and there's no good reason to do it here: this section
is about legacy interface and transitional devices,
it add not value at all. Just drop it.

Note: the spec does not make it clear whether description of the legacy
interface is normative or not, and in particular, this section is not
linked to from any conformance targets.
Resolving that is left for later.

Fixes: \url{https://issues.oasis-open.org/browse/VIRTIO-167}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Acked-by: Halil Pasic <pasic@linux.ibm.com>

 } \\
\hline
4cc8a4d & 21 Mar 2019 & Michael S. Tsirkin & { block: drop duplicate text


In version 1.1 draft 01 - Section 5.2.6.4 - second bullet:

Duplicated text "errors, data_len, sense_len and residual MUST reside in
a single, separate device-writable descriptor" appears +both in the
beginning and at the end of the 2nd sentence.

The original text:

For SCSI commands there are additional constraints. errors, data_len,
sense_len and residual MUST reside in a single, separate device-writable
descriptor, sense MUST reside in a single separate device-writable
descriptor of size 96 bytes, and errors, data_len, sense_len and
residual MUST reside a single separate device-writable descriptor.
I suggest to delete the 1st one, so in the end result, fields are
described in same order as appear in struct virtio_scsi_pc_req.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/39}
Reported-by: Gil Savir <gil.savir@intel.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
585673d & 24 Mar 2019 & Michael S. Tsirkin & { editorial: add labels


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
0f30c7a & 24 Mar 2019 & Michael S. Tsirkin & { editorial: add changelog since csprd01


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
c61e411 & 24 Mar 2019 & Michael S. Tsirkin & { editorial: gitlog.pl: generate the changelog


Incomplete: need to massage the changelog manually.
But it's a start.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
87d65d2 & 24 Mar 2019 & Michael S. Tsirkin & { editorial: changelog: tweak formatting


Drop space at beginning of cells.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
11b8efe & 24 Mar 2019 & Michael S. Tsirkin & { gitattributes: make git diff easier to read


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
751cb57 & 25 Mar 2019 & Michael S. Tsirkin & { scripts: ability to diff with multiple versions


Useful for releases with non-material changes.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
fbdea64 & 27 Mar 2019 & Michael S. Tsirkin & { acknowledgements: add members and non-members


Add all current members as participants.
Add all participant names collected from list, jira and github.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
3705705 & 27 Mar 2019 & Michael S. Tsirkin & { REVISION: update to wd02


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
58181f3 & 02 Apr 2019 & Michael S. Tsirkin & { acknowledgements: fix spill over


Use a subsection instead of a title page, otherwise
list of acknowledged people spills over to the next page.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
05eed16 & 03 Apr 2019 & Michael S. Tsirkin & { acknowledgements: add commenters from mailing list


Not all commenters sent an orderly "Reviewed-by" tag.  Some just
contributed to the discussion on the mailing list.
Add their names and affiliation from the mailing list archives.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
422aab5 & 03 Apr 2019 & Michael S. Tsirkin & { acknowledgements: use org names consistently


OASIS: same as other companies, just list the name, not the role.
M2Mi: use the short version of the name.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
33e6aba & 08 Apr 2019 & Michael S. Tsirkin & { REVISION-DATE: approval date for 1.1-cs01


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
f22d5d7 & 18 Jun 2019 & Michael S. Tsirkin & { README.md: describe preferred flow for comments


We prefer receiving comments as patches.
Describe how to generate them.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
d519c22 & 20 Jun 2019 & Stefan Hajnoczi & { content: reserve virtio device ID for file system devices


Reserve device ID 26 for virtio-fs devices.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/31}
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
9454b56 & 20 Jun 2019 & Pankaj Gupta & { content: reserve device ID for virtio-pmem devices


We need a device ID for virtio-pmem devices. As 25 is requested by
audio device and 26 is requested by virtio-fs, so requesting
next available(27). Also, updated the previously requested github
issue[1] for voting.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/38}
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Pankaj Gupta <pagupta@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
5be8f0c & 23 Jul 2019 & Michael S. Tsirkin & { README.md: document github use


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
efd4028 & 25 Jul 2019 & Dr. David Alan Gilbert & { shared memory: Define shared memory regions


Define the requirements and idea behind shared memory regions.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/40}
Signed-off-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
39dfc8a & 25 Jul 2019 & Dr. David Alan Gilbert & { pci: Define id field


For the virtio-fs device we require multiple large shared memory
regions.  Differentiate these by an 'id' field in the base capability.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/40}
Signed-off-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
8100dcf & 25 Jul 2019 & Dr. David Alan Gilbert & { pci: Define virtio_pci_cap64


Define 'virtio_pci_cap64' to allow capabilities to describe
memory regions larger than, or with an offset larger than 4GiB.

This will be used by the shared memory region capability.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/40}
Signed-off-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
855ad7a & 25 Jul 2019 & Dr. David Alan Gilbert & { shared memory: Define PCI capability


Define the PCI capability used for enumerating shared memory regions.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/40}
Signed-off-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
2dd2d46 & 25 Jul 2019 & Dr. David Alan Gilbert & { shared memory: Define mmio registers


Define an MMIO interface to discover and map shared
memory regions.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/40}
Signed-off-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
4237d22 & 08 Sep 2019 & Nikos Dragazis & { content: fix typo


Signed-off-by: Nikos Dragazis <ndragazis@arrikto.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
1571d74 & 08 Sep 2019 & Dr. David Alan Gilbert & { shared memory: Typo fix


Fix double hex in SHM*High defs.

Signed-off-by: Dr. David Alan Gilbert <dgilbert@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
7a25d74 & 08 Sep 2019 & Tiwei Bie & { content: fix typo in feature bit name


Signed-off-by: Tiwei Bie <tiwei.bie@intel.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/46}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
6aecd69 & 08 Sep 2019 & Tiwei Bie & { content: explicitly document the VLAN filtering as best-effort


Similar to the MAC address based filtering, the VLAN filtering
is also best-effort in implementations, but it's not quite clear
in the spec. So document this behaviour explicitly to reflect
the way implementations behave.

Signed-off-by: Tiwei Bie <tiwei.bie@intel.com>
Acked-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/47}

 } \\
\hline
2954077 & 25 Sep 2019 & Stefan Hajnoczi & { content: add virtio file system device


The virtio file system device transports Linux FUSE requests between a
FUSE daemon running on the host and the FUSE driver inside the guest.

The actual FUSE request definitions are not duplicated in the virtio
specification, similar to how virtio-scsi does not document SCSI
command details.  FUSE request definitions are available here:
\url{https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/fuse.h}

This patch documents the core virtio file system device, which is
functional but lacks the DAX feature introduced in the next patch.

Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/49}

 } \\
\hline
ef5a7f4 & 25 Sep 2019 & Stefan Hajnoczi & { virtio-fs: add DAX window


Describe how shared memory region ID 0 is the DAX window and how
FUSE_SETUPMAPPING maps file ranges into the window.

Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/49}

 } \\
\hline
1e155e4 & 25 Sep 2019 & Yoni Bettan & { Changed fonts to freely-available fonts when built locally.


'Arial' and 'Courier New' fonts are not installed in TeX Live by default
therefore when building the spec document using 'makeall.sh' on a Linux machine,
that usually have Tex Live installed, we get fonts error for those fonts.

This patch is checking if those fonts exist on the machine inside the
tex document and if not change them to freely-available fonts:

    Arial -> Liberation Sans
    Courier New -> Liberation Mono

Signed-off-by: Yoni Bettan <ybettan@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Eduardo Habkost <ehabkost@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
31f4e0e & 25 Sep 2019 & Yoni Bettan & { README.md: Added building instructions.


Signed-off-by: Yoni Bettan <ybettan@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Eduardo Habkost <ehabkost@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
56e5599 & 25 Sep 2019 & Michael S. Tsirkin & { README.md: clean up build instructions


Switch to <DL> from manual formatting with <BR> and <P>.
Clarify wording a bit.
Add hints on what to do in case of missing fonts.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
1e30753 & 12 Oct 2019 & Jan Kiszka & { Fix ^= in example code


Trying to escaping ^ here only leaves the backslash in the output.

Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
f9bed5b & 12 Oct 2019 & Jan Kiszka & { Lift "Driver Notifications" to section level


Currently, it slips under the Packed Virtqueues section while it is not
specific to this format.

At this chance, capitalize "Notifications".

Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
8f2c4e0 & 27 Oct 2019 & Eugenio Prez & { block: Add multiqueue


The spec miss that field. Add the field, some description around.

I've followed the network device's multiqueue mentions, and copied /
adapted when needed.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/50}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Eugenio Prez <eperezma@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
f1f2f85 & 27 Oct 2019 & Jan Kiszka & { Console Device: Add a missing word


Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>

 } \\
\hline
b0b43d8 & 27 Oct 2019 & Stefan Hajnoczi stefanha@redhat.com & { ack! Console Device: Add a missing word


Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
da17c7f & 27 Oct 2019 & Paolo Bonzini & { virtio_pci_common_cfg: fix field name


The field is named config_msix_vector in the rest of the document,
use the same name in the struct.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/41}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
89ab113 & 27 Oct 2019 & Michael S. Tsirkin & { README: fix Tex->TeX


Also let's not include the link as that's not the best place
to get it (TeX-Live is).

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
f459b9e & 27 Oct 2019 & Eugenio Prez & { virtio-blk: typo: Capitalization in Device Initialization item


Signed-off-by: Eugenio Prez <eperezma@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/51}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
30d8e1a & 27 Oct 2019 & Philipp Hahn & { Balloon: Fix Memory Statistics structure size


5.5.6.3 Memory Statistics: 6 -> 10 byte

> Within the buffer, statistics are an array of 6-byte entries.
                                                ^
> Each statistic consists of a 16 bit tag and a 64 bit value.
...
> struct virtio_balloon_stat .

...
>         le16 tag;
>         le64 val;
> \} __attribute__((packed));

If my calculation is right that is a (16 + 64) = 80 bits which is a
10-byte sized entry - not 6-byte.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/45}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
acfe7bd & 27 Oct 2019 & Michael S. Tsirkin & { README.md: document the minor cleanups standing rule


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
a610121 & 24 Nov 2019 & Jan Kiszka & { virtio-mmio: Rename remaining QueueAvail/Used references


These have been changed in ae98c6bc21bc. Convert the rest.

Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/52}

 } \\
\hline
4be5d38 & 24 Nov 2019 & Stefan Fritsch & { Fix typo


It's balloon, not ballon.

Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Stefan Fritsch <sf@sfritsch.de>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
3109be8 & 24 Nov 2019 & Paolo Bonzini & { Reserve id for virtio-audio device


Project ACRN has a virtio-audio device. Unfortunately, the id they are using is
already reserved in the virtio specification, but it is nevertheless useful to
have one.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/42}
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
4f1981a & 24 Nov 2019 & Vitaly Mireyno & { virtio-net: Add support for correct hdr_len field.


Includes device implementation note for using hdr_len

Signed-off-by: Vitaly Mireyno <vmireyno@marvell.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/57}

 } \\
\hline
2c77526 & 24 Nov 2019 & Cornelia Huck & { virtio-net: add missing articles for new hdr_len feature


And tweak a sentence slightly.

Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
111d65c & 24 Nov 2019 & Michael S. Tsirkin & { content: add vendor specific cfg type


Vendors might want to add their own capability in the PCI capability
list. However, Virtio already uses the vendor specific capability ID
(0x09) for its own purposes.

Provide a structure for vendor specific extensions.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/62}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
bc2cf84 & 24 Nov 2019 & Michael S. Tsirkin & { pci: strengthen requirement of the correct subsystem id


If a hardware implementation of virtio does not have
the correct subsystem id, then drivers can't report
ir properly, or detect and work around bugs.
Change the requirement from MAY to SHOULD.

We can't make it a MUST since we did not require this
historically.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/61}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
72a801b & 24 Nov 2019 & Michael S. Tsirkin & { content: document speed, duplex


Document as used by Linux.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/59}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
3ea1af6 & 24 Nov 2019 & Michael S. Tsirkin & { virtio-rng: fix device/driver confusion


The point of rng is to give data to driver so of course
all buffers are driver readable. What shouldn't be there
is device readable buffers - this matches our terminology
elsewhere too (read/write-ability is from POV of device).

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/55}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
f6fa722 & 24 Nov 2019 & Michael S. Tsirkin & { Revert "virtio-rng: fix device/driver confusion"


This reverts commit 3ea1af6afb4cccb9a12c59c27e9df74505e5289e.
Pushed by mistake.

 } \\
\hline
27988b4 & 24 Nov 2019 & Michael S. Tsirkin & { Revert "content: document speed, duplex"


This reverts commit 72a801b9a53a4aeca759458c50be67cc32914a71.
Pushed by mistake.

 } \\
\hline
3d0b991 & 24 Nov 2019 & Michael S. Tsirkin & { Revert "pci: strengthen requirement of the correct subsystem id"


This reverts commit bc2cf84cc7b29349b6f7effdb955b83afaf298f7.
Pushed by mistake.

 } \\
\hline
8c6acac & 27 Nov 2019 & Huang Yang & { Add virtio rpmb device specification


Add virtio RPMB (Replay Protected Memory Block) device documentation to
spec.

Signed-off-by: Yang Huang <yang.huang@intel.com>
Reviewed-by: Bing Zhu <bing.zhu@intel.com>
Reviewed-by: Tomas Winkler <tomas.winkler@intel.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/53}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
e8ba780 & 27 Nov 2019 & Huang Yang & { Reserve device id 28 for virtio RPMB device


Signed-off-by: Huang Yang <yang.huang@intel.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/58}

 } \\
\hline
94520b3 & 27 Nov 2019 & Michael S. Tsirkin & { Revert "content: add vendor specific cfg type"


This reverts commit 111d65c69c47090525eaa1ce43831e20657cbef3.

 } \\
\hline
356aeeb & 20 Jan 2020 & Michael S. Tsirkin & { content: add vendor specific cfg type


Vendors might want to add their own capability in the PCI capability
list. However, Virtio already uses the vendor specific capability ID
(0x09) for its own purposes.

Provide a structure for vendor specific extensions.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/62}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
50049af & 20 Jan 2020 & Michael S. Tsirkin & { virtio_pci_cap64: bar/BAR cleanups


When we mean PCI register we should say BAR.
When we mean a virtio config register we should say \textbackslash field\{cap.bar\}.

Finally, offset_hi/length_hi are not within the cap structure.

Tweak wording slightly: "A,B,C" are fields, there's no need
to say that.

Reported-by: Christophe de Dinechin <cdupontd@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
ab88988 & 20 Jan 2020 & Michael S. Tsirkin & { README.md: document use of virtio-dev


People still seem to be confused which list is for what.
Add a bit more text.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
b6e992c & 20 Jan 2020 & Yuri Benditovich & { virtio-net: define support for receive-side scaling


Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/48}
Added support for RSS receive steering mode.

Signed-off-by: Yuri Benditovich <yuri.benditovich@daynix.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
8361dd6 & 20 Jan 2020 & Michael S. Tsirkin & { virtio-net: receive-side scaling


Typo/grammar fixes as suggested by Cornelia (and a couple
noticed by myself).

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
1efcda8 & 20 Jan 2020 & Michael S. Tsirkin & { virtio-net: missing "." for feature descriptions


At end of each sentence, for consistency.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
652237e & 20 Jan 2020 & Jean-Philippe Brucker & { Add virtio-iommu device specification


The IOMMU device allows a guest to manage DMA mappings for physical,
emulated and paravirtualized endpoints. Add device description for the
virtio-iommu device and driver. Introduce PROBE, ATTACH, DETACH, MAP and
UNMAP requests, as well as translation error reporting.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/37}
Signed-off-by: Jean-Philippe Brucker <jean-philippe.brucker@arm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
6914d2d & 28 Jan 2020 & Keiichi Watanabe & { content: Reserve device ID for video encoder and decoder device


Reserve device ID 30 for video encoder device and 31 for video decoder device.

Signed-off-by: Keiichi Watanabe <keiichiw@chromium.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Gerd Hoffmann <kraxel@redhat.com>

 } \\
\hline
d7e91b5 & 28 Jan 2020 & Michael S. Tsirkin & { virtio-rng: fix device/driver confusion


The point of rng is to give data to driver so of course
all buffers are driver readable. What shouldn't be there
is device readable buffers - this matches our terminology
elsewhere too (read/write-ability is from POV of device).

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/55}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Pankaj Gupta <pagupta@redhat.com>

 } \\
\hline
da60923 & 28 Jan 2020 & Michael S. Tsirkin & { content: document speed, duplex


Document as used by Linux.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/59}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
6112433 & 27 Feb 2020 & Gerd Hoffmann & { virtio-gpu: add 3d command overview


Add 3d commands to the command enumeration.
Add a section with a very short overview.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/65}
Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
0c0dd71 & 27 Feb 2020 & Gerd Hoffmann & { virtio-gpu: some edid clarifications


Add some notes about fetching the EDID information.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/64}
Signed-off-by: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
f42cc75 & 01 Mar 2020 & Michael S. Tsirkin & { virtio-net/rss: maximal -> maximum


Maximal can mean "local as opposed to a global maximum".  Rest of the
spec says maximum everywhere.  Let's be consistent.

Cc: Yuri Benditovich <yuri.benditovich@daynix.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
54806cd & 04 May 2020 & Alex Benne & { makeall.sh: add explicit shebang to script


Signed-off-by: Alex Benne <alex.bennee@linaro.org>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Approved-by: \url{https://www.oasis-open.org/committees/ballot.php?id=3184}

 } \\
\hline
baf58fe & 04 May 2020 & Alex Benne & { Remove all mentioned of subversion


The repo hasn't been hosted in subversion for a while so the documents
are no longer relevant to working with the repo. Also remove the
unused code in the makezip.sh tool.

Signed-off-by: Alex Benne <alex.bennee@linaro.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
089bc59 & 04 May 2020 & Jean-Philippe Brucker & { virtio-iommu: Remove invalid requirement about padding


This reference to 'padding' is a leftover from a previous draft of the
virtio-iommu device. The field doesn't exist anymore, remove the
requirement.

Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
e73c8cd & 01 Sep 2020 & Anton Yakovlev & { virtio-snd: add virtio sound device specification


This patch proposes virtio specification for a new virtio sound device,
that may be useful in case when having audio is required but a device
passthrough or emulation is not an option.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/54}
Signed-off-by: Anton Yakovlev <anton.yakovlev@opensynergy.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
3f27648 & 01 Sep 2020 & Jan Kiszka & { split-ring: Demand that a device must not change descriptor entries


So far the spec only indirectly says that a descriptor table entry is
not modified by a device when processing it. Make this explicit by
adding it as normative requirement. Existing drivers already depend on
this.

See also \url{https://lists.oasis-open.org/archives/virtio-dev/201910/msg00057.html.}

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/56}
Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
3353ed1 & 01 Sep 2020 & Yuri Benditovich & { virtio-net: Define per-packet hash reporting feature


Define respective feature bit for virtio-net.
Extend packet layout to populate hash value and type.
Move the definition of IP/TCP/UDP header fields to
calculate the hash out of RSS section to common network
device section.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/66}
Signed-off-by: Yuri Benditovich <yuri.benditovich@daynix.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
51cad55 & 01 Sep 2020 & Johannes Berg & { reserve device ID for hwsim wireless simulation


The Linux mac80211-hwsim module currently allows simulation of
multiple wireless radios on a shared medium, and has an existing
API for this to work through a userspace implementation of the
medium simulation (e.g. implemented by wmediumd).

In order to simplify working with virtual machines and to enable
(time-compressed) simulation use cases, allocate a virtio device
ID to allow carrying this protocol over virtio in addition to
the current netlink sockets.

Since device ID 28 was previously requested, use 29.

Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/68}

 } \\
\hline
832099d & 01 Sep 2020 & Vitaly Mireyno & { virtio-net: Fix VIRTIO_NET_F_GUEST_HDRLEN feature definition.


Fix driver and device requirements with regards to the VIRTIO_NET_F_GUEST_HDRLEN feature - 'hdr_len' must be accurate only for TSO/UFO packets.

Signed-off-by: Vitaly Mireyno <vmireyno@marvell.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/72}

 } \\
\hline
5d9444d & 01 Sep 2020 & Peter Hilber & { Reserve device ID 32 for SCMI device


Signed-off-by: Peter Hilber <peter.hilber@opensynergy.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/74}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
68f66ff & 01 Sep 2020 & David Stevens & { content: define what an exported object is


Define a mechanism for sharing objects between different virtio
devices.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/76}
Signed-off-by: David Stevens <stevensd@chromium.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
162578b & 01 Sep 2020 & David Stevens & { virtio-gpu: add the ability to export resources


Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/76}
Signed-off-by: David Stevens <stevensd@chromium.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
12d7484 & 01 Sep 2020 & Petre Eftime & { content: Reserve virtio-nsm device ID


The NitroSecureModule is a device with a very stripped down
Trusted Platform Module functionality, which is used in the
context of a Nitro Enclave (see \url{https://lkml.org/lkml/2020/4/21/1020)}
to provide boot time measurement and attestation.

Since this device provides some critical cryptographic operations,
there are a series of operations which are required to have guarantees
of atomicity, ordering and consistency: operations fully succeed or fully
fail, including when some external events might interfere in the
process: live migration, crashes, etc; any failure in the critical
section requires termination of the enclave it is attached to, so
the device needs to be as resilient as possible, simplicity is
strongly desired.

To account for that, the device and driver are made to have very few
error cases in the critical path and the operations themselves can be
rolled back and retried if events happen outside the critical
area, while processing a request. The driver itself can be made very
simple and thus is easily portable.

Since the requests can be handled directly in the virtio queue, serving
most requests requires no additional buffering or memory allocations
on the host side.

Signed-off-by: Petre Eftime <epetre@amazon.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/81}

 } \\
\hline
7a46ee5 & 01 Sep 2020 & David Hildenbrand & { conformance: make driver conformance list easier to read and maintain


Let's define it just like the device conformance list.

Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: David Hildenbrand <david@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
9abf00f & 01 Sep 2020 & David Hildenbrand & { conformance: Reference RPMB Driver Conformance


We forgot to reference the driver conformance.

Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Cc: Yang Huang <yang.huang@intel.com>
Signed-off-by: David Hildenbrand <david@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Alex Benne <alex.bennee@linaro.org>

 } \\
\hline
af6b93b & 01 Sep 2020 & David Hildenbrand & { Add virtio-mem device specification


The virtio memory device provides and manages a memory region in guest
physical address space. This memory region is partitioned into memory
blocks of fixed size that can either be in the state plugged or unplugged.

Specify the device configuration, initialization, and operation.
Introduce PLUG, UNPLUG, UNPLUG ALL and STATE requests.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/82}
Cc: teawater <teawaterz@linux.alibaba.com>
Signed-off-by: David Hildenbrand <david@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
28ea45d & 11 Nov 2020 & Jie Deng & { content: Reserve device ID 34 for I2C adapter


Request the ID 34 for I2C adapter.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/85}
Signed-off-by: Jie Deng <jie.deng@intel.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d44895c & 11 Nov 2020 & Rob Bradford & { content: Reserve virtio-watchog device ID


Reserve an ID for a watchdog device which may be used to ensure that the
guest is responsive. This is equivalent of a hardware watchdog device
and will trigger the reboot of the guest if the the host does not
periodic ping from the the guest.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/87}
Signed-off-by: Rob Bradford <robert.bradford@intel.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
3844826 & 11 Nov 2020 & Alexander Duyck & { content: Document balloon feature free page hints


Free page hints allow the balloon driver to provide information on what
pages are not currently in use so that we can avoid the cost of copying
them in migration scenarios. Add a feature description for free page hints
describing basic functioning and requirements.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/84}
Acked-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: David Hildenbrand <david@redhat.com>
Signed-off-by: Alexander Duyck <alexander.h.duyck@linux.intel.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
4749f03 & 11 Nov 2020 & Alexander Duyck & { content: Document balloon feature page poison


Page poison provides a way for the guest to notify the host that it is
initializing or poisoning freed pages with some specific poison value. As a
result of this we can infer a couple traits about the guest:

1. Free pages will contain a specific pattern within the guest.
2. Modifying free pages from this value may cause an error in the guest.
3. Pages will be immediately written to by the driver when deflated.

There are currently no existing features that make use of this data. In the
upcoming feature free page reporting we will need to make use of this to
identify if we can evict pages from the guest without causing data
corruption.

Add documentation for the page poison feature describing the basic
functionality and requirements.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/84}
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: David Hildenbrand <david@redhat.com>
Signed-off-by: Alexander Duyck <alexander.h.duyck@linux.intel.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d917d4a & 11 Nov 2020 & Alexander Duyck & { content: Document balloon feature free page reporting


Free page reporting is a feature that allows the guest to proactively
report unused pages to the host. By making use of this feature is is
possible to reduce the overall memory footprint of the guest in cases where
some significant portion of the memory is idle. Add documentation for the
free page reporting feature describing the functionality and requirements.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/84}
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: David Hildenbrand <david@redhat.com>
Signed-off-by: Alexander Duyck <alexander.h.duyck@linux.intel.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
9164d35 & 13 Nov 2020 & Alexander Duyck & { content: Minor change to clarify free_page_hint_cmd_id


The original wording was a bit unclear and could have been misinterpreted
as indicating that VIRTIO_BALLOON_FREE_PAGE_HINT was read-only instead of
the field free_page_hint_cmd_id. To clarify that break it up into two
sentences making it clear that the field is only available if the feature
is negotiated, and that the field is read-only.

Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Alexander Duyck <alexander.h.duyck@linux.intel.com>
Acked-by: Michael S. Tsirkin <mst@redhat.com>
[CH: included under the minor cleanup rule]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
b342d29 & 19 Nov 2020 & Stefan Hajnoczi & { virtio-blk: document VIRTIO_BLK_T_GET_ID


The VIRTIO_BLK_T_GET_ID request type was implemented in Linux and QEMU
in 2010.  It does not have a feature bit but devices respond with
VIRTIO_BLK_S_UNSUPP if a request type is unimplemented.

This patch documents the VIRTIO_BLK_T_GET_ID request type as currently
implemented in Linux and QEMU.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/63}
Suggested-by: Jan Kiszka <jan.kiszka@siemens.com>
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
89e7eb5 & 19 Nov 2020 & Gurchetan Singh & { virtio-gpu: add resource create blob


Blob resources are size-based containers for host, guest, or
host+guest allocations.  These resources are designed with
mulit-process 3D support in mind, but also usable in virtio-gpu 2d
with guest memory.

Many hypercalls are reused, since a image view into the blob resource
is possible.

Blob resources are both forward and backward looking.

v2: Add TRANSFER_BLOB, SET_SCANOUT_BLOB, SCANOUT_FLUSH
v3: Remove SCANOUT_FLUSH and add notes
v4: Remove TRANSFER_BLOB for now.
v5: clarify interactions with ATTACH_BACKING / DETACH_BACKING.
    This is to preserve the possibility of guest swap-in and guest
    swap-out, while acknowledging this feature may never be implemented
    and may not be applicable for all future planned values of
    `blob_mem` or context types.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/86}
Signed-off-by: Gurchetan Singh <gurchetansingh@chromium.org>
Acked-by: Chia-I Wu <olvaffe@gmail.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
87fa6b5 & 19 Nov 2020 & Gurchetan Singh & { virtio-gpu: add support for mapping/unmapping blob resources


This defines a virtgpu shared memory region, with the possibilty
of more in the future.  This is required to implement VK/GL coherent
memory semantics, among other things.

v6: disallow mapping an already mapped blob resource as a
    simplification

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/86}
Signed-off-by: Gurchetan Singh <gurchetansingh@chromium.org>
Acked-by: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
2ff0d5c & 03 Dec 2020 & Vitaly Mireyno & { virtio-net: Add support for the flexible driver notification structure.


When the driver is required to send an available buffer notification
to the device, it sends the virtqueue number to be notified.

With this new feature, the device can optionally provide a per-virtqueue
value for the driver to use in driver notifications, instead of the
virtqueue number.

Some devices may benefit from this flexibility by providing, for example,
an internal virtqueue identifier, or an internal offset related to the
virtqueue number.

Changes from v8:
 * Incorporated comments for v8:
     - moved the feature from a network device to a global section
     - few minor changes

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/89}
Signed-off-by: Vitaly Mireyno <vmireyno@marvell.com>
[CH: wrapped overlong lines in commit message]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
bccdda7 & 15 Dec 2020 & Michael S. Tsirkin & { typo: VIRTIO_NET_F_MAC_ADDR -> VIRTIO_NET_F_MAC


VIRTIO_NET_F_MAC_ADDR isn't defined. It's clear from context
that what is meant is VIRTIO_NET_F_MAC which controls whether
mac in config space is valid.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/90}
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
87de713 & 15 Dec 2020 & David Hildenbrand & { virtio-mem: minor clarification regarding read-access to unplugged blocks


Let's clarify that we don't expect all DMA to work with unplugged blocks.
We really only give guarantees when reading from unplugged memory blocks
via the CPU, e.g., as done by Linux when creating a system dump via
kdump: the new kernel will copy the content of the old (crashed) kernel
via the CPU to user space, from where it will find its final destination
inside the dump file. Note that dumping via makedumpfile under Linux will
avoid reading unplugged blocks completely.

This is a preparation for device passthrough to VMs, whereby such
dedicated devices might not be able to read from unplugged memory blocks.

Let's document that this scenario is possible, and why this handling is
in place at all.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/91}
Cc: teawater <teawaterz@linux.alibaba.com>
Cc: Marek Kedzierski <mkedzier@redhat.com>
Cc: Michael S. Tsirkin <mst@redhat.com>
Cc: Cornelia Huck <cohuck@redhat.com>
Acked-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: David Hildenbrand <david@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
840ed7b & 18 Jan 2021 & Cornelia Huck & { title: fix duplicate URL


The link to the 0.9.5 spec was listed twice.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f725281 & 25 Jan 2021 & Jie Deng & { virtio-i2c: add the device specification


virtio-i2c is a virtual I2C adapter device. It provides a way
to flexibly communicate with the host I2C slave devices from
the guest.

This patch adds the specification for this device.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/88}
Signed-off-by: Jie Deng <jie.deng@intel.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
6ee5e4b & 26 Jan 2021 & Felipe Franciosi & { content: Fix driver/device wording on ISR bits


Section "ISR status capability" incorrectly worded that the bits part of
the register allows the device to distinguish between interrupt types.
It is the driver that needs access to that distinction, not the device.

Signed-off-by: Felipe Franciosi <felipe@nutanix.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
a17c29e & 26 Jan 2021 & Alex Benne & { virtio-gpu.tex: fix some UTF-8 damage


While building I got a warning about:

  ! Package utf8x Error: MalformedUTF-8sequence.

Fixes: 87fa6b5 ("virtio-gpu: add support for mapping/unmapping blob resources")
Signed-off-by: Alex Benne <alex.bennee@linaro.org>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
a306bf4 & 09 Feb 2021 & Cornelia Huck & { clarify device reset


Properly specify that the method for the driver to request a
device reset is transport specific, and some action the device
has to take.

Reviewed-by: Jason Wang <jasowang@redhat.com>
Reviewed-by: Halil Pasic <pasic@linux.ibm.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/93}
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f5fd3fc & 10 Feb 2021 & Peter Hilber & { content: reserve device ID 36 for CAN device


The CAN device sends and receives CAN (Controller Area Network)
messages. CAN is a communication protocol used in embedded systems.

Signed-off-by: Peter Hilber <peter.hilber@opensynergy.com>
Reviewed-by: Matti Mll <matti.moell@opensynergy.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/95}
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
30e6526 & 25 Feb 2021 & Cornelia Huck & { virtio-ccw: relax device requirement for revision-specific command rejection


The device is currently required to reject any command that is
not contained in the negotiated revision. Some implementations
did not actively check for the revision when processing a command;
retroactively changing these implementations can break existing
drivers.

Relaxing the rejection requirement to SHOULD makes these existing
device implementations compliant, and will not have any effect on
drivers that did not send any commands for wrong revisions.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/96}
Reviewed-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
5e9a37b & 30 Mar 2021 & Enrico Granata & { Add lifetime metrics to virtio-blk


In many embedded systems, virtio-blk implementations are
backed by eMMC or UFS storage devices, which are subject to
predictable and measurable wear over time due to repeated write
cycles.

For such systems, it can be important to be able to track
accurately the amount of wear imposed on the storage over
time and surface it to applications. In a native deployments
this is generally handled by the physical block device driver
but no such provision is made in virtio-blk to expose these
metrics for devices where it makes sense to do so.

This patch adds support to virtio-blk for lifetime and wear
metrics to be exposed to the guest when a deployment of
virtio-blk is done over compatible eMMC or UFS storage.

Signed-off-by: Enrico Granata <egranata@google.com>
Fixes: \url{https://github.org/oasis-tcs/virtio-spec/issues/97}
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
80b54cf & 30 Mar 2021 & Peter Hilber & { Add virtio SCMI device specification


This patch proposes a new virtio device for the Arm SCMI protocol.

The device provides a simple transport for the Arm SCMI protocol[1]. The
*S*ystem *C*ontrol and *M*anagement *I*nterface protocol allows speaking
to system controllers that allow orchestrating things like power
management, system state management and sensor access. The SCMI protocol
is used on SoCs where multiple cores and co-processors need access to
these resources.

The virtio transport allows making use of this protocol in virtualized
systems.

[1] \url{https://developer.arm.com/docs/den0056/c}

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/100}
Signed-off-by: Peter Hilber <peter.hilber@opensynergy.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f144e18 & 06 Apr 2021 & Cornelia Huck & { title: list myself as Chair


Reflect my position in the document as well.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
2d827b0 & 14 Apr 2021 & Michael S. Tsirkin & { introduction: document \#define syntax


We use the C \#define syntax to refer to numeric values.
Let's document that.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/101}

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
b19f28e & 14 Apr 2021 & Hao Chen & { Reserve device id for parameter server


Use device ID 38

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/102}

Signed-off-by: Hao Chen <chenhaosjtuacm@google.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
22179bb & 14 Apr 2021 & Hao Chen & { Reserve device id for audio policy device


Use device ID 39

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/103}

Signed-off-by: Hao Chen <chenhaosjtuacm@google.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
0711d7f & 14 Apr 2021 & Cornelia Huck & { editorial: fix missing escape of '\#'


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
3590a07 & 03 May 2021 & Marcel Holtmann & { Reserve device id for Bluetooth device


Use device ID 40

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/108}
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
5749014 & 17 May 2021 & Yuri Benditovich & { virtio-net: fix mistake: segmentation -> fragmentation


The VIRTIO_NET_F_HOST_UFO feature fragments the packet. Only
first fragment has a UDP header.

Signed-off-by: Yuri Benditovich <yuri.benditovich@daynix.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d1471fd & 17 May 2021 & Yuri Benditovich & { virtio-net: define USO feature


Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/104}

Unlike UFO (fragmenting the packet) the USO splits large UDP packet
to several segments when each of these smaller packets has UDP
header. In Linux see SKB_GSO_UDP_L4.

Signed-off-by: Yuri Benditovich <yuri.benditovich@daynix.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
c6f7149 & 10 Jun 2021 & Joel Nider & { Make global flag names consistent


The global flags VIRTIO_F_EVENT_IDX and VIRTIO_F_INDIRECT_DESC
have inconsistent naming throughout the document. This change
removes the _RING designation from the flag names to make the
usage consistent.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/36}
Signed-off-by: Joel Nider <joel@nider.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
a57fb86 & 10 Jun 2021 & Jiang Wang & { virtio-net: fix a display for num_buffers


One of num_buffers does not display correctly in
the html. The _b becomes a subscript b. This will
prevent it from being searched by using keyword num_buffers.

Fix it by adding a field keyword.

Signed-off-by: Jiang Wang <jiang.wang@bytedance.com>
Message-Id: <20210601172139.3725854-1-jiang.wang@bytedance.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
eddd555 & 17 Jun 2021 & Viresh Kumar & { Reserve device id for GPIO device


Use device ID 41

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/109}
Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
63236f1 & 08 Jul 2021 & Stefan Hajnoczi & { virtio-fs: add file system device to Conformance chapter


The file system device is not listed in the Conformance chapter. Fix
this.

Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
3881c6b & 08 Jul 2021 & Stefan Hajnoczi & { virtio-fs: add notification queue


The FUSE protocol allows the file server (device) to initiate
communication with the client (driver) using FUSE notify messages.
Normally only the client can initiate communication. This feature is
used to report asynchronous events that are not related to an in-flight
request.

This patch adds a notification queue that works like an rx queue in
other VIRTIO device types. The device can emit FUSE notify messages by
using a buffer from this queue.

This mechanism was designed by Vivek Goyal <vgoyal@redhat.com>.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/111}
Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
1ca33cf & 19 Jul 2021 & Viresh Kumar & { Add .gitignore file


Add .gitignore to not see the unnecessary list of build generated files
with commands like git status.

Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
eb6ef45 & 26 Jul 2021 & Cornelia Huck & { Reserved feature bits: fix missing verb


Reviewed-by: David Hildenbrand <david@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
74822ee & 27 Jul 2021 & Gaetan Harter & { content: fix a typo


Signed-off-by: Gaetan Harter <gaetan.harter@opensynergy.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
23d3f7a & 27 Jul 2021 & Gaetan Harter & { virtio-gpu: fix a typo


Signed-off-by: Gaetan Harter <gaetan.harter@opensynergy.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
247709f & 29 Jul 2021 & Gaetan Harter & { virtio-crypto: fix missing conjunction and verb


The condition sentences were incomplete:
"guarantee THAT the size IS within the max_len".

Signed-off-by: Gaetan Harter <gaetan.harter@opensynergy.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
1dc3ff8 & 10 Aug 2021 & Max Gurtovoy & { virtio-blk: fix virtqueues accounting


Virtqueue index is zero based, thus virtqueue (N-1) refers to requestqN.

Signed-off-by: Max Gurtovoy <mgurtovoy@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
b73b74a & 16 Aug 2021 & Alex Benne & { virtio-rpmb: fix the description for multi-block reads


Previously the text said we fail if block count is set to 1 despite
language elsewhere in the text referring to:

  "For RPMB read request, one virtio buffer including request command
  and the subsequent [block_count] virtio buffers for response data
  are placed in the queue."

and the existence of both max_wr_cnt and max_rd_cnt configuration
variables certainly implying devices should be able to handle
multi-block reads just like writes.

Fix the description as well as format the steps as an enumerated list
to match the style of the previous section describing write handling.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/113}
Reported-by: Ruchika Gupta <ruchika.gupta@linaro.org>
Signed-off-by: Alex Benne <alex.bennee@linaro.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
9547f52 & 18 Aug 2021 & Viresh Kumar & { virtio-gpio: Add the device specification


virtio-gpio is a virtual GPIO controller. It provides a way to flexibly
communicate with the host GPIO controllers from the guest.

Note that the current implementation doesn't provide atomic APIs for
GPIO configurations. i.e. the driver (guest) would need to implement
sleep-able versions of the APIs as the guest will respond asynchronously
over the virtqueue.

This patch adds the specification for it.

Based on the initial work posted by:
"Enrico Weigelt, metux IT consult" <lkml@metux.net>.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/110}
Reviewed-by: Arnd Bergmann <arnd@arndb.de>
Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
4b65fb2 & 17 Sep 2021 & Viresh Kumar & { virtio-gpio: Specify character encoding for gpio names


Specify 7-bit ASCII character encoding for GPIO names strings.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/115}
Suggested-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
c833833 & 17 Sep 2021 & Michael S. Tsirkin & { virtio-net: fix speed, duplex


Speed values have an extra "f" - they are 32 bit, not 36 bit.  Duplex is
implemented in Linux and QEMU as 0x01 for full duplex and 0x00 for half
duplex.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/75}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
a4bb001 & 24 Sep 2021 & Gurchetan Singh & { virtio-gpu: clarify spec regarding capability sets


Capability sets will be used as a proxy for the context type,
so add more detail regarding their use.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/117}
Reviewed-by: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Gurchetan Singh <gurchetansingh@chromium.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
aad2b6f & 24 Sep 2021 & Gurchetan Singh & { virtio-gpu: add context init support


This brings explicit context initialization and different types
to virtio-gpu.

In the past, VIRTIO_GPU_F_VIRGL meant the virglrenderer support.
With VIRTIO_GPU_F_VIRGL + VIRTIO_GPU_F_CONTEXT_INIT, this means
generic 3D virtualization defined by the context type.  It's
entirely possible the virglrenderer project isn't available on
the host in this scenario.  The VIRTIO_GPU_F_VIRGL naming
convention is kept since it's easier to redefine the meaning
rather than changing header files.

The context type is associated an particular capset id.  Virgl
has two capsets due a prior bug, but for other cases the 1:1
mapping between context type and capset id is valid.

In addition, fencing needs to be fixed to accomodate multiple
context types.  In the past, there was one global timeline
associated witht the OpenGL rendering.  Now, there are multiple
timelines which can be associated with GL, VK or even display
contexts.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/117}
Reviewed-by: Gerd Hoffmann <kraxel@redhat.com>
Signed-off-by: Gurchetan Singh <gurchetansingh@chromium.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
e0e8f9a & 04 Oct 2021 & Junji Wei & { Reserve device id for RDMA device


Use device ID 42

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/116}
Signed-off-by: Junji Wei <weijunji@bytedance.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f5a8d38 & 04 Oct 2021 & Max Gurtovoy & { Fix copy/paste bug in PCI transport paragraph


Refer to "Shared memory capability" and not to "Device-specific
configuration".

Signed-off-by: Max Gurtovoy <mgurtovoy@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
bcf4bdd & 07 Oct 2021 & Jean-Philippe Brucker & { content: Remove duplicate paragraph


It looks like commit 356aeeb40d7a ("content: add vendor specific cfg
type") had a merge issue. It includes the device normative paragraph for
Shared memory capability, which was already added right above it by
commit 855ad7af2bd6 ("shared memory: Define PCI capability").

The two paragraphs differ, and the first paragraph is correct. It refers
to struct virtio_pci_cap64 which embeds struct virtio_pci_cap:

  struct virtio_pci_cap64 .

    struct virtio_pci_cap .

      ...
      le32 offset;
      le32 length;
    \} cap;
    u32 offset_hi;
    u32 length_hi;
  .


Merge the two paragraph while keeping the best of both. Drop the spaces
after \textbackslash field to stay consistent with the rest of the document.

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
591eb4c & 07 Oct 2021 & Cornelia Huck & { PCI: fix level for vendor data capability


The normative statements for the vendor data capability need
to be at paragraph level insted of subsection level.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
2f4a36d & 14 Oct 2021 & Enrico Granata & { Provide detailed specification of virtio-blk lifetime metrics


In the course of review, some concerns were surfaced about the
original virtio-blk lifetime proposal, as it depends on the eMMC
spec which is not open

Add a more detailed description of the meaning of the fields
added by that proposal to the virtio-blk specification, as to
make it feasible to understand and implement the new lifetime
metrics feature without needing to refer to JEDEC's specification

This patch does not change the meaning of those fields nor add
any new fields, but it is intended to provide an open and more
clear description of the meaning associated with those fields.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/106}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Enrico Granata <egranata@google.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
fc387ff & 15 Oct 2021 & Pankaj Gupta & { virtio-pmem: PMEM device spec


Posting virtio specification for virtio pmem device. Virtio pmem is a
paravirtualized device which allows the guest to bypass page cache.
Virtio pmem kernel driver is merged in Upstream Kernel 5.3. Also, Qemu
device is merged in Qemu 4.1.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/78}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Pankaj Gupta <pankaj.gupta.linux@gmail.com>
[CH: editorial update to fix conformance section]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
b5115a8 & 15 Oct 2021 & David Hildenbrand & { virtio-mem: simplify statements that express unexpected behavior on memory access


Some statements express that the device MAY allow access to memory inside
unplugged memory blocks, although it's really just unexpected behavior and
conforming drivers MUST NOT perform such access.

Clarify that, and move the special CPU vs. DMA handling for some
unplugged memory blocks to the driver section instead.

While at it, start rephrasing our statements to clarify and prepare for
further changes.

Signed-off-by: David Hildenbrand <david@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
708ef82 & 15 Oct 2021 & David Hildenbrand & { virtio-mem: rephrase remaining memory access statements


Let's rephrase the remaining statements regarding memory access to unify
and prepare for further changes.

Signed-off-by: David Hildenbrand <david@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f579906 & 15 Oct 2021 & David Hildenbrand & { virtio-mem: document basic memory access to plugged memory blocks


Let's cleanly document that the driver just has to allow for access to
plugged memory blocks.

Signed-off-by: David Hildenbrand <david@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
5b6a9d2 & 15 Oct 2021 & David Hildenbrand & { virtio-mem: introduce VIRTIO_MEM_F_UNPLUGGED_INACCESSIBLE


Until now, we allowed a driver to read unplugged memory within the
usable device-managed region: this simplified bring-up of virtio-mem in
Linux quite a bit, especially when it came to physical memory dumping.

When the device is using a memory backend that supports a shared
zeropage, such as virtio-mem in QEMU under Linux on anonymous memory, the
old behavior could be realized easily.

However, when using other memory backends (such as hugetlbfs or shmem)
or architectures, such as s390x, where a shared zeropage either does not
exist or cannot be used, letting the driver read unplugged memory can
result in undesired memory consumption in the hypervisor. The device
wants to make sure that the guest is aware and will not read unplugged
memory, not even in corner cases.

In the meantime, the Linux implementation matured such that it will no
longer access unplugged memory, for example, during kdump, when reading
/proc/kcore, or via (now removed) /dev/kmem.

Similar to VIRTIO_F_ACCESS_PLATFORM, this change will be disruptive and
require driver adaptions -- even if it's just accepting the new feature.
Devices are expected to only set the bit when really required, to keep
existing setups working.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/118}
Signed-off-by: David Hildenbrand <david@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
26947c3 & 15 Oct 2021 & David Hildenbrand & { virtio-mem: describe interaction with memory properties


Let's describe how we expect the interaction with memory properties that
might be available on a specific platform for ordinary system RAM.

This is primarily a preparation for s390x support, which provides
storage keys and may provide storage attributes, depending on the system
configuration.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/118}
Signed-off-by: David Hildenbrand <david@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
ca1463d & 03 Nov 2021 & Viresh Kumar & { virtio: i2c: No need to have separate read-write buffers


The virtio I2C protocol allows to contain multiple read-write requests
in a single I2C transaction using the VIRTIO_I2C_FLAGS_FAIL_NEXT flag,
where each request contains a header, buffer and status.

There is no need to pass both read and write buffers in a single
request, as we have a better way of combining requests into a single I2C
transaction. Moreover, this also limits the transactions to two buffers,
one for read operation and one for write. By using
VIRTIO_I2C_FLAGS_FAIL_NEXT, we don't have any such limits.

Remove support for multiple buffers within a single request.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/112}
Reviewed-by: Arnd Bergmann <arnd@arndb.de>
Reviewed-by: Jie Deng <jie.deng@intel.com>
Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
69d399b & 03 Nov 2021 & Viresh Kumar & { virtio: i2c: Allow zero-length transactions


The I2C protocol allows zero-length requests with no data, like the
SMBus Quick command, where the command is inferred based on the
read/write flag itself.

In order to allow such a request, allocate another bit,
VIRTIO_I2C_FLAGS_M_RD(1), in the flags to pass the request type, as read
or write. This was earlier done using the read/write permission to the
buffer itself.

Add a new feature flag for zero length requests and make it mandatory
for it to be implemented, so we don't need to drag the old
implementation around.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/112}
Reviewed-by: Arnd Bergmann <arnd@arndb.de>
Reviewed-by: Jie Deng <jie.deng@intel.com>
Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
ca32527 & 03 Nov 2021 & Viresh Kumar & { virtio-gpio: Add support for interrupts


This patch adds support for interrupts to the virtio-gpio specification.
This uses the feature bit 0 for the same.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/114}
Cc: Marc Zyngier <maz@kernel.org>
Cc: Thomas Gleixner <tglx@linutronix.de>
Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Arnd Bergmann <arnd@arndb.de>

 } \\
\hline
48340e8 & 29 Nov 2021 & Halil Pasic & { split-ring: clarify the field len in the used ring


The current description is misleading: "the descriptor chain which was
used" generally includes both the descriptors that map the device read
only, and descriptors that  map the device write only portions of the
buffer described by the descriptor chain. The argument that "used" means
"written to" does not stand because one has to "use" the descriptor
chain even when the whole buffer is device read only.

One can argue, that the most straightforward way to interpret the phrase
"total length of that descriptor chain" (without context) like the
length of the  list is usually defined: i.e. like the number of
descriptors that constitute the chain. This is clearly not what we want
here. Another intuitive way to interpret "total length of that
descriptor chain" is size of the buffer mapped by the descriptor chain.
This is not what we want either. In fact such wrongful interpretations
have caused bugs in the wild.

On the other hand, the text below the listing that gets modified here
clearly describes the semantics of \textbackslash field\{len\}. So let us replace
the ambiguous explanation in the listing, with a hopefully non-ambiguous
one.

Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Halil Pasic <pasic@linux.ibm.com>
[CH: fixed up commit message typo and tabs-vs-spaces]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
7953913 & 30 Nov 2021 & Taylor Stark & { virtio-pmem: Support describing pmem as shared memory region


Update the virtio-pmem spec to add support for describing the pmem region as a
shared memory window. This is required to support virtio-pmem in Hyper-V, since
Hyper-V only allows PCI devices to operate on memory ranges defined via BARs.
When using the virtio PCI transport, shared memory regions are described via
PCI BARs.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/121}
Reviewed-by: Pankaj Gupta <pankaj.gupta.linux@gmail.com>
Signed-off-by: Taylor Stark <tstark@microsoft.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
ec3997b & 30 Nov 2021 & Cornelia Huck & { pmem: correct wording


s/guest absolute/physical/

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d664597 & 07 Dec 2021 & Cornelia Huck & { ccw: clarify device reset


Unlike other transports, a reset triggered by the driver is actually
complete once the command has been completed. Make this behaviour
and the requirements more explicit.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/123}
Reviewed-by: Jason Wang <jasowang@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
41644c1 & 09 Dec 2021 & Jean-Philippe Brucker & { virtio-iommu: Rework the bypass feature


The VIRTIO_IOMMU_F_BYPASS feature is awkward to use and incomplete.
Although it is implemented by QEMU, it is not supported by any driver as
far as I know. Replace it with a new VIRTIO_IOMMU_F_BYPASS_CONFIG
feature.

Two features are missing from virtio-iommu:

* The ability for an hypervisor to start the device in bypass mode. The
  wording for VIRTIO_IOMMU_F_BYPASS is not clear enough to allow it at
  the moment, because it only specifies the behavior after feature
  negotiation.

* The ability for a guest to set individual endpoints in bypass mode
  when bypass is globally disabled. An OS should have the ability to
  allow only endpoints it trusts to bypass the IOMMU, while keeping DMA
  disabled for endpoints it isn't even aware of. At the moment this can
  only be emulated by creating identity mappings.

The VIRTIO_IOMMU_F_BYPASS_CONFIG feature adds a 'bypass' config field
that allows to enable and disable bypass globally. It also adds a new
flag for the ATTACH request.

* The hypervisor can start the VM with bypass enabled or, if it knows
  that the software stack supports it, disabled. The 'bypass' config
  fields is initialized to 0 or 1. It is sticky and isn't affected by
  device reset.

* Generally the firmware won't have an IOMMU driver and will need to be
  started in bypass mode, so the bootloader and kernel can be loaded
  from storage endpoint.

  For more security, the firmware could implement a minimal virtio-iommu
  driver that reuses existing virtio support and only touches the config
  space. It could enable PCI bus mastering in bridges only for the
  endpoints that need it, enable global IOMMU bypass by flipping a bit,
  then tear everything down before handing control over to the OS. This
  prevents vulnerability windows where a malicious endpoint reprograms
  the IOMMU while the OS is configuring it [1].

  The isolation provided by vIOMMUs has mainly been used for securely
  assigning endpoints to untrusted applications so far, while kernel DMA
  bypasses the IOMMU. But we can expect boot security to become as
  important in virtualization as it presently is on bare-metal systems,
  where some devices are untrusted and must never be able to access
  memory that wasn't assigned to them.

* The OS can enable and disable bypass globally. It can then enable
  bypass for individual endpoints by attaching them to bypass domains,
  using the new VIRTIO_IOMMU_ATTACH_F_BYPASS flag. It can disable bypass
  by attaching them to normal domains.

[1] IOMMU protection against I/O attacks: a vulnerability and a proof of concept
    Morgan, B., Alata, ., Nicomette, V. et al.
    \url{https://link.springer.com/article/10.1186/s13173-017-0066-7}

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/119}
Reviewed-by: Eric Auger <eric.auger@redhat.com>
Reviewed-by: Kevin Tian <kevin.tian@intel.com>
Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
ed91523 & 21 Dec 2021 & Yadong Qi & { virtio-blk: add secure erase feature to specification


There are user requests to use the Linux BLKSECDISCARD ioctl on
virtio-blk device. A secure discard is the same as a regular discard
except that all copies of the discarded blocks that were possibly
created by garbage collection must also be erased. This requires
support from the device. And "secure erase" is more commonly used
in industry to name this feature. Hence in this proposal, extend
virtio-blk protocol to support secure erase command.

Introduced new feature flag and command type:
    VIRTIO_BLK_F_SECURE_ERASE
    VIRTIO_BLK_T_SECURE_ERASE

This feature is a passthrough feature on backend because it is hard
to emulate a secure erase. So virtio-blk will report this feature
to guest OS if backend device support such kind of feature. And
when guest OS issues a secure erase command, backend driver will
passthrough the command to host device blocks.

Introduced new fields in virtio_blk_config for secure erase commands:
struct virtio_blk_config .

    ...
    max_secure_erase_sectors;
    max_secure_erase_seg;
    secure_erase_sector_alignment;
\};

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/125}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Yadong Qi <yadong.qi@intel.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
3b5378d & 21 Dec 2021 & Xuan Zhuo & { virtio: introduce virtqueue reset as basic facility


This patch allows the driver to reset a queue individually.

This is very common on general network equipment. By disabling a queue,
you can quickly reclaim the buffer currently on the queue. If necessary,
we can reinitialize the queue separately.

For example, when virtio-net implements support for AF_XDP, we need to
disable a queue to release all the original buffers when AF_XDP setup.
And quickly release all the AF_XDP buffers that have been placed in the
queue when AF_XDP exits.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/124}
Reviewed-by: Jason Wang <jasowang@redhat.com>
Signed-off-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
12998e7 & 21 Dec 2021 & Xuan Zhuo & { virtio: pci support virtqueue reset


PCI support virtqueue reset.

virtio_pci_common_cfg add "queue_reset" to support virtqueue reset.
The driver uses this to selectively reset the queue.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/124}
Reviewed-by: Jason Wang <jasowang@redhat.com>
Signed-off-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
a4ce81a & 21 Dec 2021 & Xuan Zhuo & { virtio: mmio support virtqueue reset


mmio support virtqueue reset.

MMIO Device Register Layout "QueueReady" to support virtqueue reset.
The driver uses this to selectively reset the queue.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/124}
Reviewed-by: Jason Wang <jasowang@redhat.com>
Signed-off-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f65613a & 11 Jan 2022 & Max Gurtovoy & { Fix reserved Feature bits numbering


This should have been updated during VIRTIO_F_NOTIFICATION_DATA,
VIRTIO_F_NOTIF_CONFIG_DATA and VIRTIO_F_RING_RESET standartization.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/128}

Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Max Gurtovoy <mgurtovoy@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
5e1c3fa & 21 Jan 2022 & Arseny Krasnov & { virtio-vsock: use C style defines for constants


This:
1) Replaces enums with C style "defines", because
   use of enums is not documented, while "defines"
   are widely used in spec.
2) Adds defines for some constants.

Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Arseny Krasnov <arseny.krasnov@kaspersky.com>
Reviewed-by: Stefano Garzarella <sgarzare@redhat.com>
Signed-off-by: Stefano Garzarella <sgarzare@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
1a90fc6 & 21 Jan 2022 & Stefano Garzarella & { virtio-vsock: add VIRTIO_VSOCK_F_STREAM feature bit


Initially vsock devices only supported stream sockets, but now
we are adding support for new types (i.e. SEQPACKET, DGRAM).

Since some devices may not want to support stream sockets, we add
a feature bit for this type.

For backward compatibility, if no feature bit is set, only stream
socket type is supported.

Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Stefano Garzarella <sgarzare@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d6d9c73 & 21 Jan 2022 & Arseny Krasnov & { virtio-vsock: SOCK_SEQPACKET description


This adds description of SOCK_SEQPACKET socket type
support for virtio-vsock.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/132}
Signed-off-by: Arseny Krasnov <arseny.krasnov@kaspersky.com>
[reworked "Message and record boundaries" paragraph]
Signed-off-by: Stefano Garzarella <sgarzare@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
88895f5 & 24 Jan 2022 & Cornelia Huck & { Reserve more feature bits for device type usage


Feature bits 41 and above are noted as being reserved for future
extensions. However, the net device has been using bits in that space
for some time now, as it already used up the device type specific
range up to 23.

To avoid problems in the future, let's designate bits 50 to 127 to
device type specific usage (which accommodates current usage by the
net driver, and gives breathing room for future type specific bits),
and declare bits 41 to 49 and bits 128 and above to be reserved for
future extensions (which gives us some time before bit numbers move
beyond 63, which would need some changes in existing device and driver
implementations.)

Reported-by: Max Gurtovoy <mgurtovoy@nvidia.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/131}
Reviewed-by: Max Gurtovoy <mgurtovoy@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
6708e0f & 07 Apr 2022 & Michael S. Tsirkin & { virtio-gpio: offered -> negotiated


virtqueues are only discovered after FEATURES_OK.
As such it makes no sense to talk about virtqueues being affected by
features which are offered but not negotiated, and doing so will confuse
the reader.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
071d283 & 07 Apr 2022 & Cornelia Huck & { iommu: offered -> negotiated


All those clauses actually apply whenever the feature is negotiated,
not merely offered. Rename to clarify things.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
a214ffb & 11 Apr 2022 & Cornelia Huck & { introduction: add more section labels


In order to be able to refer to changes in sections.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
79f705b & 11 Apr 2022 & Cornelia Huck & { conformance: hook up GPU device normative statements


These statements already exist, but were not linked in the conformance section.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
da874f8 & 11 Apr 2022 & Cornelia Huck & { edit: drop 1.1 changelog


Move it to cl-cs01-11.tex.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
0d7a9e1 & 11 Apr 2022 & Cornelia Huck & { edit: add changelog for 1.2


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
de8b68c & 19 Apr 2022 & Cornelia Huck & { Revert "iommu: offered -> negotiated"


This reverts commit 071d283887352e5353e3d212fbd672861b1e550b.

This change needs more discussion, and proper voting.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
44eb958 & 19 Apr 2022 & Cornelia Huck & { Revert "iommu: offered -> negotiated"


This reverts commit 071d283887352e5353e3d212fbd672861b1e550b.

This change needs more discussion, and proper voting.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
02105f0 & 19 Apr 2022 & Michael S. Tsirkin & { packed-ring: fix some typos


The VIRTQ_DESC_F_INDIRECT flag is misnamed in a couple of places.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
bd9b3e8 & 20 Apr 2022 & Michael S. Tsirkin & { packed-ring: fix some typos


The VIRTQ_DESC_F_INDIRECT flag is misnamed in a couple of places.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
a987975 & 20 Apr 2022 & Michael S. Tsirkin & { packed-ring.tex: link conformance statements


Link conformance statements into conformance chapter.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
da2e7bf & 20 Apr 2022 & Michael S. Tsirkin & { packed-ring.tex: link conformance statements


Link conformance statements into conformance chapter.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
81a54ad & 20 Apr 2022 & Michael S. Tsirkin & { content.tex: drop space after \textbackslash field


Always use \textbackslash field\{foo\} not \textbackslash field \{foo\}, the latter confuses
latexdiff.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f67774b & 20 Apr 2022 & Michael S. Tsirkin & { content.tex: drop space after \textbackslash field


Always use \textbackslash field\{foo\} not \textbackslash field \{foo\}, the latter confuses
latexdiff.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
7c5cbf9 & 20 Apr 2022 & Michael S. Tsirkin & { fixupdiff: escape ^ caret


Since commit:

commit 1e30753d53d222fbe955f0643583d756105d557e
Author: Jan Kiszka <jan.kiszka@siemens.com>
Date:   Fri Oct 11 13:43:41 2019 +0200

    Fix ^= in example code

    Trying to escaping ^ here only leaves the backslash in the output.

    Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
    Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

we have plain ^ inside listing. Escape it with \textbackslash  but only
if not already escaped (as output of diff with old source will be).

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
e2d3115 & 20 Apr 2022 & Michael S. Tsirkin & { fixupdiff: escape ^ caret


Since commit:

commit 1e30753d53d222fbe955f0643583d756105d557e
Author: Jan Kiszka <jan.kiszka@siemens.com>
Date:   Fri Oct 11 13:43:41 2019 +0200

    Fix ^= in example code

    Trying to escaping ^ here only leaves the backslash in the output.

    Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
    Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

we have plain ^ inside listing. Escape it with \textbackslash  but only
if not already escaped (as output of diff with old source will be).

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
bb07817 & 20 Apr 2022 & Michael S. Tsirkin & { change revisions: diff from v1.1, current v1.2


 } \\
\hline
f2e7784 & 20 Apr 2022 & Michael S. Tsirkin & { fixupdiff: reverse add/del for code snippets


Turns out added/deleted versions for code snippets
were reversed and no one noticed. Fix it up.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
2fd8ed7 & 20 Apr 2022 & Michael S. Tsirkin & { makediffall: fix file name in the message printed


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
8017fbe & 20 Apr 2022 & Michael S. Tsirkin & { editorial: switch to upstream latexdiff


With latest latexdiff, we can finally show changed lines
within listings. Worth the switch to the lastest master.
As a bonus, we no longer need to maintain a pile of perl hacks
and complex command line as it seems to generally be smarter.
Add it as a submodule so we can track which version we use.
Notes:

1. DIFCODE_UNDERLINE file helps override colors within listings
(default is blue for addition, we use green to avoid confusion with
links elsewhere so I kept this consistent for listings).
It does not seem to be documented, something to watch out for
if/when we update latexdiff, and maybe work with the latexdiff
maintainer to document.

2. I am not sure we still need the 's/\textbackslash \textbackslash footnote\{/\textbackslash \textbackslash footnote \{/' hack.
Kept it around just in case. If yes it might be worth discussing
with the latexdiff maintainer to address this as part of latexdiff.

3. Invoke latexdiff as latexdiff-fast which in the past made it go faster
by using the unix diff utility. I'm not sure it's still the case but
it does not seem to hurt either.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
33f84c1 & 20 Apr 2022 & Michael S. Tsirkin & { editorial: remove unused scripts


drop fixupdiff.pl and it's (commented out) user.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
7020e34 & 21 Apr 2022 & Michael S. Tsirkin & { make-setup-generated.sh: get version from spec string


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
cbe37d7 & 21 Apr 2022 & Michael S. Tsirkin & { virtio-html.cfg: use variable for spec version


this way it gets updated automatically

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
b1202c7 & 21 Apr 2022 & Michael S. Tsirkin & { title: note that 1.2 supercedes 1.1


 } \\
\hline
ac139c7 & 21 Apr 2022 & Michael S. Tsirkin & { revision: update date


 } \\
\hline
c5fd7ed & 02 May 2022 & Parav Pandit & { virtio: Improve queue_reset polarity to match to default reset state


Currently when driver initiates a queue reset, device is expected
to communicate reset status to the driver by changing the value of the
queue_reset register twice. First to return value other than 1 when
reset is ongoing, later to return 1 when queue reset is completed.

However initially during the device reset time the queue reset value
is zero. queue_reset changes the value of the register to a different
value on reset completion. Yet another time queue_reset value is
expected to change when queue_select is reprogrammed.

For example in below flow, a created virtqueue, which is disabled
by driver leaves the queue state as
queue_enable = 0, queue_reset = 1.

example flow:
a) 0,0 -> device init time value
b) 1,0 -> vq is enabled by driver and working
c) 1,1 -> vq is enabled, driver initiated reset
d) 0,0 -> queue reset is ongoing
   conflicts with \#a, because queue is still enabled in device
   whose reset is in progress.
   External entity has no knowledge if VQ is undergoing reset or
   VQ is never enabled.
e) 0,1 -> queue reset is completed (conflicts with \#a initial value)

On next iteration, when queue_select selects the same VQ again,
without enablement, device is confused to return 1 or 0 because
it was reset once before via queue_reset register.

This demands complex device implementation to understand what
should be returned for a VQ that is reset using queue_reset register
vs other means.

Additionally, external entity that may have to manage a virtio device
cannot distinguish between \#a and \#d, whether a VQ is not yet enabled
or it is in use and undergoing a reset.

Instead, it is better and efficient to maintain the same VQ state
on the device when queue reset is completed.

new proposed flow:
q_enable, q_reset
A) 0, 0 -> default, device init time
B) 1, 0 -> driver has enabled vq
C) 1, 1 -> driver started q reset
D) 1, 1 -> q_reset stays 1 until device is busy resetting vq
(device communicates that its working on resetting VQ, consistent with \#C)
E) 0, 0 -> q_reset by device is completed, q got disabled
(consistent with device init time \#A)

Hence, this patch proposes a simple change to have reset register
polarity to be same as that of initial reset value.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/139}
Fixes: 12998e738621 ("virtio: pci support virtqueue reset")
Fixes: a4ce81a83780 ("virtio: mmio support virtqueue reset")
Fixes: 3b5378d70a42 ("virtio: introduce virtqueue reset as basic facility")
Reviewed-by: Jason Wang <jasowang@redhat.com>
Reviewed-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
6e7b446 & 02 May 2022 & Michael S. Tsirkin & { acknowledgements: update for 1.2


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
9cbe01f & 02 May 2022 & Michael S. Tsirkin & { makediff: drop old latexdiff workaround


does not seem to be needed anymore

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
0622e46 & 02 May 2022 & Michael S. Tsirkin & { revision: update for wd02


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
cb5634c & 02 May 2022 & Michael S. Tsirkin & { cl-os: add reset changes to changelog


Fixes: c5fd7eda12030 ("virtio: Improve queue_reset polarity to match to default reset state")

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
e142ddd & 02 May 2022 & Michael S. Tsirkin & { gitlog: update revision for diffs


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
7a15593 & 02 May 2022 & Michael S. Tsirkin & { gitlog: get version on command line


also, use a heuristic to get the version if not given

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
252da89 & 03 May 2022 & Michael S. Tsirkin & { ipr/title: editorial changes by Paul Knight


Update ipr and title tex files with versions sent
by Paul Knight <paul.knight@oasis-open.org> as
required for publishing for public review.


- use "stage" instead of ambiguous lower case "version" (URIs, citation format,
and "Status")

- remove line "Specification URIs"

- avoid redirects, by adding a terminating slash for the hyperlinks which point
to www.oasis-open.org resources

- the paragraph about IPR (in "Status") must include both the TC's IPR page in
Kavi (\url{https://www.oasis-open.org/committees/virtio/ipr.php),} AND the github IPR
statements (\url{https://github.com/oasis-tcs/virtio-admin/blob/master/IPR.md),}
since they both appear to be needed for complete listings of IPR-related
information.

- in "Notices", remove the paragraph beginning "This specification is provided
under", which is not part of the actual OASIS "Notices" text

- Added final sentence of the capitalized Notices text, which was missing:
"OASIS AND ITS MEMBERS WILL NOT BE LIABLE FOR ANY DIRECT,
INDIRECT, SPECIAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF ANY USE
OF THIS DOCUMENT OR ANY PART THEREOF."

- added the short paragraph following the capitalized text and the brackets
around three following paragraphs, which are used in the current template to
clarify the applicability of patent policies specifically to an "OASIS
Standards Final Deliverable"

Also, ipr.tex is now only included once.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
ef05f01 & 03 May 2022 & Michael S. Tsirkin & { images: update logo


Update the OASIS logo, with the image at \url{https://docs.oasis-open.org/}
templates/OASISLogo-v3.0.png.

Suggested-by: Paul Knight <paul.knight@oasis-open.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
47ec202 & 03 May 2022 & Michael S. Tsirkin & { html: update colors


adjust the color of the section headings from old \#552681 to new \#446CAA

Suggested-by: Paul Knight <paul.knight@oasis-open.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
9225a97 & 03 May 2022 & Michael S. Tsirkin & { makehtml: don't force logo size


could not figure out where it's forced, just drop this from html
by post-processing.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
a065419 & 03 May 2022 & Michael S. Tsirkin & { REVISION: update for csd02


update date and revision accordingly

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
a7a2813 & 03 May 2022 & Michael S. Tsirkin & { editorial: update copyright in PDF footer to 2022


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
da59182 & 03 May 2022 & Michael S. Tsirkin & { makediff: switch to latexdiff-fast


much faster. we do get some warnings but they appear to
be harmless.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
5fd6a7d & 03 May 2022 & Michael S. Tsirkin & { fixup! REVISION: update for csd02


 } \\
\hline
6dd574a & 03 May 2022 & Michael S. Tsirkin & { diff-with-base: drop diff from wd01


never published, not needed

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
9ac6254 & 04 May 2022 & Michael S. Tsirkin & { ipr: IPR page in github repository is sufficient


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
e521c5b & 10 May 2022 & Michael S. Tsirkin & { changelog editorial fixes


Paul Knight reports:

Minor broken links in the "Revision History" - Appendix D

- \url{https://lists.oasis-open.org/archives/virtio-dev/201910/msg00057.html.} (bad
link due to inclusion of the terminating period - second item dated 01 Sep 2020
in Appendix D Revision history) - not a blocking issue

- \url{https://lkml.org/lkml/2020/4/21/1020)} (bad link due to including the final
right parenthesis in the hyperlink - item dated 01 Sep 2020 by Petre Eftime) -
not a blocking issue

- \url{https://github.org/oasis-tcs/virtio-spec/issues/97} (bad link due to using
github.org instead of github.com - first item dated 30 Mar 2021 in Appendix D
Revision history) - not a blocking issue

Reported-by: Paul Knight <paul.knight@oasis-open.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
9c5d7ce & 10 May 2022 & Michael S. Tsirkin & { editorial: use bold for title and headings


Paul Knight reported:


- (HTML only) To conform to OASIS style, this should use bold font in title and
headings from top through "Notices"

-- I noted that in the HTML file, these headings use class="aeb10-", but this
is not defined in the .css file.

-- For this publication, I defined it by inserting the line below into the .css
file (virtio-v1.2-csd01.css, at line 18), which fixed this issue:

--- .aeb10-\{font-weight: bold;.


make this adjustment in makehtml.sh for the future.

Reported-by: Paul Knight <paul.knight@oasis-open.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
6f1e1b1 & 10 May 2022 & Michael S. Tsirkin & { editorial: update S390 Common I/O link


Paul Knight wrote:

In running a link check, I noted several issues, none significant for this
initial public review publication:

- broken link in Normative references:

-- [S390 Common I/O] ESA/390 Common I/O-Device and Self-Description, IBM
Publication SA22-7204,
\url{http://publibfp.dhe.ibm.com/cgi-bin/bookmgr/BOOKS/dz9ar501/CCONTENTS,} and any
future revisions
(This link is currently broken, and I could not find any alternative source for
this document. - please rewrite the reference to indicate document is no longer
available at this link. You may also consider whether the solitary citation at
4.3.1.3 is still needed.)
This broken link is not a blocking issue for a Committee specification Draft,
but it will not be allowed for a Committee Specification.

Reported-by: Paul Knight <paul.knight@oasis-open.org>
Suggested-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
5da7c14 & 13 Jun 2022 & Stefan Hajnoczi & { virtio-blk: document that the capacity field can change


Block devices can change size during operation. A configuration change
notification is sent by the device and the driver detects that the field
has changed. Document this behavior that has already been implemented in
Linux and QEMU since 2011.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/136}

Signed-off-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
ad2e167 & 13 Jun 2022 & Laura Loghin & { vsock: add documentation about len header field


Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/137}

Reviewed-by: Stefano Garzarella <sgarzare@redhat.com>
Signed-off-by: Laura Loghin <lauralg@amazon.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
fca0157 & 13 Jun 2022 & Xuan Zhuo & { virtio-net: support reset queue


A separate reset queue function introduced by Virtqueue Reset.

However, it is currently not defined what to do if the destination queue is
being reset when virtio-net is steering in multi-queue mode.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/138}

Reviewed-by: Jason Wang <jasowang@redhat.com>
Signed-off-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
6328f51 & 24 Jun 2022 & Yuri Benditovich & { virtio-net: define guest USO features


Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/120}

Add definition for large UDP packets device-to-driver.

Signed-off-by: Yuri Benditovich <yuri.benditovich@daynix.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
49ff780 & 24 Jun 2022 & Anton Yakovlev & { virtio-snd: add support for audio controls


This patch extends the virtio sound device specification by adding
support for audio controls. Audio controls can be used to set the volume
level, mute/unmute the audio signal, switch different modes/states of
the virtual sound device, etc.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/107}

Signed-off-by: Anton Yakovlev <anton.yakovlev@opensynergy.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
7602352 & 05 Jul 2022 & Michael S. Tsirkin & { virtio-v1.2-cs01 was approved


Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
120019e & 05 Jul 2022 & Michael S. Tsirkin & { makediffall.sh: fix typo in script


 } \\
\hline
4fa9cc5 & 10 Jul 2022 & Michael S. Tsirkin & { Editorial: title: fix empty line after Chairs


There's an empty line after Chairs.

Fixes: 585673d508dc ("editorial: add labels")
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
a6ed209 & 10 Jul 2022 & Michael S. Tsirkin & { editorial: date is 01 not 1


be consistent with other OASIS standards.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
4d9068e & 11 Jul 2022 & Alvaro Karsz & { Introduction of Virtio Network device notifications coalescing feature.


Control a network device notifications coalescing parameters using the control virtqueue.
A new control class was added: VIRTIO_NET_CTRL_NOTF_COAL.

This class provides 2 commands:

- VIRTIO_NET_CTRL_NOTF_COAL_TX_SET:
  Ask the network device to change the tx_usecs and tx_max_packets parameters.
  - tx_usecs: Maximum number of usecs to delay a TX notification.
  - tx_max_packets: Maximum number of packets to send before a TX notification.


- VIRTIO_NET_CTRL_NOTF_COAL_RX_SET:
  Ask the network device to change the rx_usecs and rx_max_packets parameters.
  - rx_usecs: Maximum number of usecs to delay a RX notification.
  - rx_max_packets: Maximum number of packets to receive before a RX notification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/141}

Reviewed-by: Jason Wang <jasowang@redhat.com>
Signed-off-by: Alvaro Karsz <alvaro.karsz@solid-run.com>
[CH: fixed commit message]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
e230375 & 13 Jul 2022 & Michael S. Tsirkin & { editorial: introduction: fix IBM link


OLD

[S390    z/Architecture Principles of Operation, IBM Publication SA22-7832,
PoP]     \url{http://publibfi.boulder.ibm.com/epubs/pdf/dz9zr009.pdf,} and any future
         revisions

NEW (should be)

[S390 PoP] z/Architecture Principles of Operation, IBM Publication SA22-7832,
\url{https://www.ibm.com/docs/en/SSQ2R2_15.0.0/com.ibm.tpf.toolkit.hlasm.doc/}
dz9zr006.pdf, and any future revisions

[only changes the hyperlink]

Reported-by: Paul Knight <paul.knight@oasis-open.org>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
d226655 & 20 Jul 2022 & Cornelia Huck & { .gitignore: ignore wd?? outputs as well


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
685a46b & 20 Jul 2022 & Cornelia Huck & { Merge branch 'virtio-1.3'


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
abbe8af & 03 Aug 2022 & Lei He & { virtio-crypto: introduce akcipher service


Introduce akcipher (asymmetric key cipher) service type, several
asymmetric algorithms and relevent information:
  - RSA(padding algorithm, ASN.1 schema definition)
  - ECDSA(ECC algorithm)

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/129}

Signed-off-by: zhenwei pi <pizhenwei@bytedance.com>
Signed-off-by: Lei He <helei.sig11@bytedance.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
26ed30c & 03 Aug 2022 & Stefano Garzarella & { virtio-vsock: add VIRTIO_VSOCK_F_NO_IMPLIED_STREAM feature bit


Initially virtio-vsock only supported the stream type, which is why
there was no feature. Later we added the seqpacket type and in the future
we may have other types (e.g. datagram).

seqpacket is an extension of stream, so it might be implied that if
seqpacket is supported, stream is too, but this might not be true for
other types.

As we discussed here [1] should be better to add a new
VIRTIO_VSOCK_F_NO_IMPLIED_STREAM feature bit to avoid this implication.

Let's also add normative sections to better define the behavior when
VIRTIO_VSOCK_F_NO_IMPLIED_STREAM is negotiated or not.

[1] \url{http://markmail.org/message/2s3qd74drgjxkvte}

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/142}

Suggested-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Stefano Garzarella <sgarzare@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
a7251b0 & 14 Nov 2022 & Hrishivarya Bhageeradhan & { content: reserve device ID 43 for Camera device


The virtio-camera device allows to stream a camera video with
ability to change controls, formats and get camera captures.
This patch is to reserve the next available device ID for
virtio-camera.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/148}

Signed-off-by: Hrishivarya Bhageeradhan <hrishivarya.bhageeradhan@opensynergy.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
b4e8efa & 05 Dec 2022 & Dmitry Fomichev & { virtio-blk: add zoned block device specification


Introduce support for Zoned Block Devices to virtio.

Zoned Block Devices (ZBDs) aim to achieve a better capacity, latency
and/or cost characteristics compared to commonly available block
devices by getting the entire LBA space of the device divided to block
regions that are much larger than the LBA size. These regions are
called zones and they can only be written sequentially. More details
about ZBDs can be found at

\url{https://zonedstorage.io/docs/introduction/zoned-storage} .

In its current form, the virtio protocol for block devices (virtio-blk)
is not aware of ZBDs but it allows the driver to successfully scan a
host-managed drive provided by the virtio block device. As the result,
the host-managed drive is recognized by virtio driver as a regular,
non-zoned drive that will operate erroneously under the most common
write workloads. Host-aware ZBDs are currently usable, but their
performance may not be optimal because the driver can only see them as
non-zoned block devices.

To fix this, the virtio-blk protocol needs to be extended to add the
capabilities to convey the zone characteristics of ZBDs at the device
side to the driver and to provide support for ZBD-specific commands -
Report Zones, four zone operations (Open, Close, Finish and Reset) and
(optionally) Zone Append. The proposed standard extension aims to
define this new functionality.

This patch extends the virtio-blk section of virtio specification with
the minimum set of requirements that are necessary to support ZBDs.
The resulting device model is a subset of the models defined in ZAC/ZBC
and ZNS standards documents. The included functionality mirrors
the existing Linux kernel block layer ZBD support and should be
sufficient to handle the host-managed and host-aware HDDs that are on
the market today as well as ZNS SSDs that are entering the market at
the time of submission of this patch.

I would like to thank the following people for their useful feedback
and suggestions while working on the initial iterations of this patch.

Damien Le Moal <damien.lemoal@opensource.wdc.com>
Matias Bjrling <Matias.Bjorling@wdc.com>
Niklas Cassel <Niklas.Cassel@wdc.com>
Hans Holmberg <Hans.Holmberg@wdc.com>

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/143}

Signed-off-by: Dmitry Fomichev <dmitry.fomichev@wdc.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
985bbf3 & 07 Dec 2022 & Xuan Zhuo & { content: reserve device ID 44 for ISM device


The virtio-ism device provides the ability to share memory between
different guests on a host. A guest's memory got from ism device can be
shared with multiple peers at the same time. This shared relationship
can be dynamically created and released.

The shared memory obtained from the device is divided into multiple ism
regions for share. ISM device provides a mechanism to notify other ism
region referrers of content update events.

This patch is to reserve the next available device ID for virtio-ism.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/150}

Signed-off-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Signed-off-by: Jiang Liu <gerry@linux.alibaba.com>
Signed-off-by: Dust Li <dust.li@linux.alibaba.com>
Signed-off-by: Tony Lu <tonylu@linux.alibaba.com>
Signed-off-by: Helin Guo <helinguo@linux.alibaba.com>
Signed-off-by: Hans Zhang <hans@linux.alibaba.com>
Signed-off-by: He Rongguang <herongguang@linux.alibaba.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f2b2869 & 30 Jan 2023 & Parav Pandit & { virtio-net: Maintain network device spec in separate directory


Move virtio network device specification to its own file similar to
recent virtio devices.
While at it, place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
81694cd & 30 Jan 2023 & Parav Pandit & { virtio-net: Fix spelling errors


Fix two spelling errors in the virtio network device specification.

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
335342f & 30 Jan 2023 & Parav Pandit & { virtio-blk: Maintain block device spec in separate directory


Move virtio block device specification to its own file similar to
recent virtio devices.
While at it, place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d3d0618 & 30 Jan 2023 & Parav Pandit & { virtio-console: Maintain console device spec in separate directory


Move virtio console device specification to its own file similar to
recent virtio devices.
While at it, place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
c71e88e & 30 Jan 2023 & Parav Pandit & { virtio-entropy: Maintain entropy device spec in separate directory


Move virtio entropy device specification to its own file similar to
recent virtio devices.
While at it, place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
c06f3b6 & 30 Jan 2023 & Parav Pandit & { virtio-balloon: Maintain mem balloon device spec in separate directory


Move virtio memory balloon device specification to its own file
similar to recent virtio devices.
While at it, place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d404f1c & 30 Jan 2023 & Parav Pandit & { virtio-scsi: Maintain scsi host device spec in separate directory


Move virtio SCSI host device specification to its own file similar to
recent virtio devices.
While at it, place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
442bb64 & 30 Jan 2023 & Parav Pandit & { virtio-gpu: Maintain gpu device spec in separate directory


Move virtio gpu device specification to its own file similar to
recent virtio devices.
While at it, place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
c9686f2 & 30 Jan 2023 & Parav Pandit & { virtio-input: Maintain input device spec in separate directory


Move virtio input device specification to its own file similar to
recent virtio devices.
While at it, place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
8463bba & 30 Jan 2023 & Parav Pandit & { virtio-crypto: Maintain crypto device spec in separate directory


Move virtio crypto device specification to its own file similar to
recent virtio devices.
While at it, place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
828754b & 30 Jan 2023 & Parav Pandit & { virtio-vsock: Maintain socket device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefano Garzarella <sgarzare@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
8632f80 & 30 Jan 2023 & Parav Pandit & { virtio-fs: Maintain file system device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
b067de4 & 30 Jan 2023 & Parav Pandit & { virtio-rpmb: Maintain rpmb device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
b1cf73e & 30 Jan 2023 & Parav Pandit & { virtio-iommu: Maintain iommu device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
6813e3c & 30 Jan 2023 & Parav Pandit & { virtio-sound: Maintain sound device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
5042a50 & 30 Jan 2023 & Parav Pandit & { virtio-mem: Maintain memory device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
00b9935 & 30 Jan 2023 & Parav Pandit & { virtio-i2c: Maintain i2c device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
674489b & 30 Jan 2023 & Parav Pandit & { virtio-scmi: Maintain scmi device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
6c9c04d & 30 Jan 2023 & Parav Pandit & { virtio-gpio: Maintain gpio device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d04d253 & 30 Jan 2023 & Parav Pandit & { virtio-pmem: Maintain pmem device spec in separate directory


Place device specification, its driver and device
conformance into its own directory to have self contained device
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/153}

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
b1fb6b6 & 02 Feb 2023 & Parav Pandit & { virtio-net: Clarify VLAN filter table configuration


The filtering behavior of the VLAN filter commands is not very clear as
discussed in thread [1].

Hence, add the command description and device requirements for it.

[1] \url{https://lists.oasis-open.org/archives/virtio-dev/202301/msg00210.html}

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/147}

Suggested-by: Si-Wei Liu <si-wei.liu@oracle.com>
Reviewed-by: Si-Wei Liu <si-wei.liu@oracle.com>
Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
53b0cb1 & 02 Feb 2023 & Parav Pandit & { virtio-net: Avoid confusing device configuration text


The added text in commit of Fixes tag was redundant and
confusing in context of VLAN filtering description.

Hence remove it as discussed in [1] and [2].

[1] \url{https://lists.oasis-open.org/archives/virtio-dev/202301/msg00282.html}
[2] \url{https://lists.oasis-open.org/archives/virtio-dev/202301/msg00286.html}

Fixes: 296303444f6b ("virtio-net: Clarify VLAN filter table configuration")

Suggested-by: Halil Pasic <pasic@linux.ibm.com>
Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
[CH: applied as editorial change]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
3b9b6ac & 09 Feb 2023 & Michael S. Tsirkin & { audio->sound


Spec calls the device "sound device". Make the name in the
ID section match.

MST: applied as editorial change.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
0ce03bc & 14 Feb 2023 & Parav Pandit & { virtio-net: Avoid confusion between a card and a device


Historically virtio network device is documented as an Ethernet card.
A modern card in the industry has one to multiple ports, one to multiple
PCI functions. However the virtio network device is usually just a
single link/port network interface controller.

Hence, avoid this confusing term 'card' and align the specification
to adhere to widely used specification term as 'device' used for all
virtio device types.

Replaced 'card' with 'network interface controller'.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/154}

Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
be2ce1e & 15 Feb 2023 & Parav Pandit & { content.tex Fix Driver notifications label


Driver notifications section is under "Basic Facilities of a Virtio
Device". However, the label is placed under "Virtqueues" section.

Fix the label references.

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
[CH: pushed as an editorial update]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
2ea4627 & 20 Feb 2023 & Alvaro Karsz & { virtio-net: Mention VIRTIO_NET_F_HASH_REPORT dependency on VIRTIO_NET_F_CTRL_VQ


If the VIRTIO_NET_F_HASH_REPORT feature is negotiated, the driver may
send VIRTIO_NET_CTRL_MQ_HASH_CONFIG commands, thus, the control VQ
feature should be negotiated.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/158}
Signed-off-by: Alvaro Karsz <alvaro.karsz@solid-run.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
73ce5bb & 01 Mar 2023 & Alvaro Karsz & { virtio-net: Fix and update VIRTIO_NET_F_NOTF_COAL feature


This patch makes several improvements to the notification coalescing
feature, including:


- Consolidating virtio_net_ctrl_coal_tx and virtio_net_ctrl_coal_rx
  into a single struct, virtio_net_ctrl_coal, as they are identical.

- Emphasizing that the coalescing commands are best-effort.

- Defining the behavior of coalescing with regards to delivering
  notifications when a change occur.

- Stating that the commands should apply to all the receive/transmit
  virtqueues.

- Stating that every receive/transmit virtqueue should count it's own
  packets.

- A new intro explaining the entire coalescing operation.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/159}

Signed-off-by: Alvaro Karsz <alvaro.karsz@solid-run.com>
Reviewed-by: Parav Pandit <parav@nvidia.com>
Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
3508347 & 01 Mar 2023 & Parav Pandit & { virtio-net: Improve introductory description


The control VQ of the virtio network device is used beyond advance
steering control. The control VQ dynamically changes multiple features
of the initialized device.

Hence, update this area of control VQ introductory description at few
places and also place the link to its description.

Also update the introduction section to better describe receive and
transmit virtqueues.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/156}

Reviewed-by: David Edmondson <david.edmondson@oracle.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
91a4699 & 10 Mar 2023 & Parav Pandit & { transport-pci: Split PCI transport to its own file


Place PCI transport specification in its own file to better maintain it.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/157}

Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
9e88ba9 & 10 Mar 2023 & Parav Pandit & { transport-mmio: Split MMIO transport to its own file


Place MMIO transport specification in its own file to better maintain it.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/157}

Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
0af264f & 10 Mar 2023 & Parav Pandit & { transport-ccw: Split Channel IO transport to its own file


Place Channel IO transport specification in its own file to
better maintain it.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/157}

Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
deb0aa0 & 10 Mar 2023 & Parav Pandit & { transport-pci: Fix spellings and white spaces


Now that we have individual files, fix reported spelling errors.

While at it, remove trailing white spaces.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/157}

Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
ca97719 & 10 Mar 2023 & Parav Pandit & { transport-mmio: Fix spellings and white spaces


Now that we have individual files, fix reported spelling errors.

While at it, remove trailing white spaces.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/157}

Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
8797f4d & 10 Mar 2023 & Parav Pandit & { transport-ccw: Fix spellings and white spaces


Now that we have individual files, fix reported spelling errors.

While at it, remove extra white spaces.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/157}

Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d3f832b & 15 Mar 2023 & Parav Pandit & { virtio-net: Describe dev cfg fields read only


Device configuration fields are read only. Avoid duplicating this
description for multiple fields.

Instead describe it one time and do it in the driver requirements
section.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/161}

Reviewed-by: David Edmondson <david.edmondson@oracle.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
115ceb9 & 15 Mar 2023 & Parav Pandit & { virtio-net: Define cfg fields before description


Currently some fields of the virtio_net_config structure are defined
before introducing the structure and some are defined after.
Better to define the configuration layout first followed by
description of all the fields.

Device configuration fields are described in the section. Change wording
from 'listed' to 'described' as suggested in patch [1].

[1] \url{https://lists.oasis-open.org/archives/virtio-dev/202302/msg00004.html}

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/161}

Reviewed-by: David Edmondson <david.edmondson@oracle.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
2d1d8df & 15 Mar 2023 & Parav Pandit & { virtio-net: Fix virtqueues spelling error


Correct spelling from virtqueus to virtqueues.

Signed-off-by: Parav Pandit <parav@nvidia.com>
Acked-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Jiri Pirko <jiri@nvidia.com>
[CH: pushed as editorial update]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
2d54950 & 15 Mar 2023 & Parav Pandit & { transport-pci: Remove duplicate word structure


Remove duplicate word structure.

Signed-off-by: Parav Pandit <parav@nvidia.com>
Acked-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Halil Pasic <pasic@linux.ibm.com>
Reviewed-by: Jiri Pirko <jiri@nvidia.com>
[CH: pushed as editorial update]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f6fe164 & 15 Mar 2023 & Michael S. Tsirkin & { makediff: make it work for fresh checkout


1st time one checks out our repo, latexdiff submodule
is not initialized. Pass --init to update command
to initialize it. It seems to be harmless if already
initialized.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Cornelia Huck <cohuck@redhat.com>
Tested-by: Parav Pandit <parav@nvidia.com>

 } \\
\hline
b041409 & 15 Mar 2023 & Parav Pandit & { virtio-blk: Define dev cfg layout before its fields


Define device configuration layout structure before describing its
individual fields.

This is an editorial change.

Suggested-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Max Gurtovoy <mgurtovoy@nvidia.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
380ed02 & 04 Apr 2023 & Parav Pandit & { transport-pci: Remove empty line at end of file


Remove empty line at end of file.

Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: David Edmondson <david.edmondson@oracle.com>

 } \\
\hline
1ed0754 & 11 Apr 2023 & Heng Qi & { virtio-net: support the virtqueue coalescing moderation


Currently, coalescing parameters are grouped for all transmit and receive
virtqueues. This patch supports setting or getting the parameters for a
specified virtqueue, and a typical application of this function is netdim[1].

When the traffic between virtqueues is unbalanced, for example, one virtqueue
is busy and another virtqueue is idle, then it will be very useful to
control coalescing parameters at the virtqueue granularity.

[1] \url{https://docs.kernel.org/networking/net_dim.html}

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/166}

Signed-off-by: Heng Qi <hengqi@linux.alibaba.com>
Reviewed-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Reviewed-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
362ebd0 & 11 Apr 2023 & Alvaro Karsz & { virtio-net: define the VIRTIO_NET_F_CTRL_RX_EXTRA feature bit


The VIRTIO_NET_F_CTRL_RX_EXTRA feature bit is mentioned in the spec
since version 1.0, but it's not properly defined.

This patch defines the feature bit and defines the dependency on VIRTIO_NET_F_CTRL_VQ.

Since this dependency is missing in previous versions, we add it now as
a "SHOULD".

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/162}

Reviewed-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Alvaro Karsz <alvaro.karsz@solid-run.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d3b2a19 & 21 Apr 2023 & Parav Pandit & { device-types/multiple: replace queues with enqueues


Queue is a verb and noun both. Replacing it with enqueue avoids
ambiguity around plural queues noun vs verb; similar to virtio fs device
description.

Acked-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
[CH: pushed as editorial update]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
aadefe6 & 19 May 2023 & Michael S. Tsirkin & { virtio: document forward compatibility guarantees


Feature negotiation forms the basis of forward compatibility
guarantees of virtio but has never been properly documented.
Do it now.

Suggested-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Parav Pandit <parav@nvidia.com>
Reviewed-by: Zhu Lingshan <lingshan.zhu@intel.com>

 } \\
\hline
f3ce853 & 19 May 2023 & Michael S. Tsirkin & { admin: introduce device group and related concepts


Each device group has a type. For now, define one initial group type:

SR-IOV type - PCI SR-IOV virtual functions (VFs) of a given
PCI SR-IOV physical function (PF). This group may contain zero or more
virtio devices according to NumVFs configured.

Each device within a group has a unique identifier. This identifier
is the group member identifier.

Note: one can argue both ways whether the new device group handling
functionality (this and following patches) is closer
to a new device type or a new transport type.

However, it's expected that we will add more features in the near
future. To facilitate this as much as possible of the text is located in
the new admin chapter.

Effort was made to minimize transport-specific text.

There's a bit of duplication with 0x1 repeated twice and
no special section for group type identifiers.
It seems ok to defer adding these until we have more group
types.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
2cbaaa1 & 19 May 2023 & Michael S. Tsirkin & { admin: introduce group administration commands


This introduces a general structure for group administration commands,
used to control device groups through their owner.

Following patches will introduce specific commands and an interface for
submitting these commands to the owner.

Note that the commands are focused on controlling device groups:
this is why group related fields are in the generic part of
the structure.
Without this the admin vq would become a "whatever" vq which does not do
anything specific at all, just a general transport like thing.
I feel going this way opens the design space to the point where
we no longer know what belongs in e.g. config space
what in the control q and what in the admin q.
As it is, whatever deals with groups is in the admin q; other
things not in the admin q.

There are specific exceptions such as query but that's an exception that
proves the rule ;)

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Zhu Lingshan <lingshan.zhu@intel.com>

 } \\
\hline
5f1a8ac & 19 May 2023 & Michael S. Tsirkin & { admin: introduce virtio admin virtqueues


The admin virtqueues will be the first interface used to issue admin commands.

Currently the virtio specification defines control virtqueue to manipulate
features and configuration of the device it operates on:
virtio-net, virtio-scsi, etc all have existing control virtqueues. However,
control virtqueue commands are device type specific, which makes it very
difficult to extend for device agnostic commands.

Keeping the device-specific virtqueue separate from the admin virtqueue
is simpler and has fewer potential problems. I don't think creating
common infrastructure for device-specific control virtqueues across
device types worthwhile or within the scope of this patch series.

To support this requirement in a more generic way, this patch introduces
a new admin virtqueue interface.
The admin virtqueue can be seen as the virtqueue analog to a transport.
The admin queue thus does nothing device type-specific (net, scsi, etc)
and instead focuses on transporting the admin commands.

We also support more than one admin virtqueue, for QoS and
scalability requirements.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
677aeae & 19 May 2023 & Michael S. Tsirkin & { pci: add admin vq registers to virtio over pci


Add new registers to the PCI common configuration structure.

These registers will be used for querying the indices of the admin
virtqueues of the owner device. To configure, reset or enable the admin
virtqueues, the driver should follow existing queue configuration/setup
sequence.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Parav Pandit <parav@nvidia.com>
Reviewed-by: Zhu Lingshan <lingshan.zhu@intel.com>

 } \\
\hline
a9a59f7 & 19 May 2023 & Michael S. Tsirkin & { mmio: document ADMIN_VQ as reserved


Adding relevant registers needs more work and it's not
clear what the use-case will be as currently only
the PCI transport is supported. But let's keep the
door open on this.
We already say it's reserved in a central place, but it
does not hurt to remind implementers to mask it.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Parav Pandit <parav@nvidia.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
325046c & 19 May 2023 & Michael S. Tsirkin & { ccw: document ADMIN_VQ as reserved


Adding relevant registers needs more work and it's not
clear what the use-case will be as currently only
the PCI transport is supported. But let's keep the
door open on this.
We already say it's reserved in a central place, but it
does not hurt to remind implementers to mask it.

Note: there are more features to add to this list.
Will be done later with a patch on top.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Parav Pandit <parav@nvidia.com>
Reviewed-by: Zhu Lingshan <lingshan.zhu@intel.com>

 } \\
\hline
3dc7196 & 19 May 2023 & Michael S. Tsirkin & { admin: command list discovery


Add commands to find out which commands does each group support,
as well as enable their use by driver.
This will be especially useful once we have multiple group types.

An alternative is per-type VQs. This is possible but will
require more per-transport work. Discovery through the vq
helps keep things contained.

e.g. lack of support for some command can switch to a legacy mode

note that commands are expected to be avolved by adding new
fields to command specific data at the tail, so
we generally do not need feature bits for compatibility.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Zhu Lingshan <lingshan.zhu@intel.com>

 } \\
\hline
bf1d6b0 & 19 May 2023 & Michael S. Tsirkin & { admin: conformance clauses


Add conformance clauses for admin commands and admin virtqueues.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/171}
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>

 } \\
\hline
b04be31 & 19 May 2023 & Michael S. Tsirkin & { ccw: document more reserved features


vq reset and shared memory are unsupported, too.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/160}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Reviewed-by: Zhu Lingshan <lingshan.zhu@intel.com>

 } \\
\hline
619f60a & 19 May 2023 & Parav Pandit & { admin: Fix reference and table formation


This patch brings three fixes.

1. Opcode table has 3 columns, only two were enumerated. Due to this
pdf generation script stops. Fix it and also have resizeable description
column as it needs wrap.

2. Status description column content needs to wrap. Without it pdf
   does not read good. Fix it by having resizeable description column.

3. Fix the broken link to the Device groups.

Fixes: 2cbaaa1 ("admin: introduce group administration commands")
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
c1cd68b & 19 May 2023 & Parav Pandit & { transport-pci: Improve config msix vector description


config_msix_vector is the register that holds the MSI-X vector number
for receiving configuration change related interrupts.

It is not "for MSI-X".

Hence, replace the confusing text with appropriate one.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/169}
Reviewed-by: Max Gurtovoy <mgurtovoy@nvidia.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
0f433d6 & 19 May 2023 & Parav Pandit & { transport-pci: Improve queue msix vector register desc


queue_msix_vector register is for receiving virtqueue notification
interrupts from the device for the virtqueue.

"for MSI-X" is confusing term.

Also it is the register that driver "writes" to, similar to
many other registers such as queue_desc, queue_driver etc.

Hence, replace the verb from use to write.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/169}
Signed-off-by: Parav Pandit <parav@nvidia.com>
Reviewed-by: Max Gurtovoy <mgurtovoy@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
b0fbccd & 19 May 2023 & Parav Pandit & { content: Add vq index text


Introduce vq index and its range so that subsequent patches can refer
to it.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: David Edmondson <david.edmondson@oracle.com>
Reviewed-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
362f1ca & 19 May 2023 & Parav Pandit & { content.tex Replace virtqueue number with index


Replace virtqueue number with index to align to rest of the
specification.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: David Edmondson <david.edmondson@oracle.com>
Reviewed-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
cc4a560 & 19 May 2023 & Parav Pandit & { content: Rename confusing queue_notify_data and vqn names


Currently queue_notify_data register indicates the device
internal queue notification content. This register is
meaningful only when feature bit VIRTIO_F_NOTIF_CONFIG_DATA is
negotiated.

However, above register name often get confusing association with
very similar feature bit VIRTIO_F_NOTIFICATION_DATA.

When VIRTIO_F_NOTIFICATION_DATA feature bit is negotiated,
notification really involves sending additional queue progress
related information (not queue identifier or index).

Hence
1. to avoid any misunderstanding and association of
queue_notify_data with similar name VIRTIO_F_NOTIFICATION_DATA,

and
2. to reflect that queue_notify_data is the actual device
internal virtqueue identifier/index/data/cookie,

a. rename queue_notify_data to queue_notif_config_data.

b. rename ambiguous vqn to a union of vq_index and vq_config_data

c. The driver notification section assumes that queue notification contains
vq index always. CONFIG_DATA feature bit introduction missed to
update the driver notification section. Hence, correct it.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Acked-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

Reviewed-by: David Edmondson <david.edmondson@oracle.com>

 } \\
\hline
fbb119d & 19 May 2023 & Parav Pandit & { transport-pci: Avoid first vq index reference


Drop reference to first virtqueue as it is already
covered now by the generic section in first patch.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: David Edmondson <david.edmondson@oracle.com>
Acked-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
a7a21e4 & 19 May 2023 & Parav Pandit & { transport-mmio: Rename QueueNum register


These are further named differently between pci and mmio transport.
PCI transport indicates queue size as queue_size.

To bring consistency between pci and mmio transport,
rename the QueueNumMax and QueueNum
registers to QueueSizeMax and QueueSize respectively.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Reviewed-by: Jiri Pirko <jiri@nvidia.com>
Reviewed-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
9ddc595 & 19 May 2023 & Parav Pandit & { transport-mmio: Avoid referring to zero based index


VQ range is already described in the first patch in basic virtqueue
section. Hence remove the duplicate reference to it.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: David Edmondson <david.edmondson@oracle.com>
Acked-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
e7a764f & 19 May 2023 & Parav Pandit & { transport-ccw: Rename queue depth/size to other transports


max_num field reflects the maximum queue size/depth. Hence align name of
this field with similar field in PCI and MMIO transport to
max_queue_size.
Similarly rename 'num' to 'size'.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
c309241 & 19 May 2023 & Parav Pandit & { transport-ccw: Refer to the vq by its index


Currently specification uses virtqueue index and
number interchangeably to refer to the virtqueue.

Instead refer to it by its index.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: Halil Pasic <pasic@linux.ibm.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
d6f310d & 19 May 2023 & Parav Pandit & { virtio-net: Avoid duplicate receive queue example


Receive queue number/index example is duplicate which is already defined
in the Setting RSS parameters section.

Hence, avoid such duplicate example and prepare it for the subsequent
patch to describe using receive queue handle.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
da0e169 & 19 May 2023 & Parav Pandit & { virtio-net: Describe RSS using rss rq id


The content of the indirection table and unclassified_queue were
originally described based on mathematical operations. In order to
make it easier to understand and to avoid intermixing the array
index with the vq index, introduce a structure
rss_rq_id (RSS receive queue
ID) and use it to describe the unclassified_queue and
indirection_table fields.

As part of it, have the example that uses non-zero virtqueue
index which helps to have better mapping between receiveX
object with virtqueue index and the actual value in the
indirection table.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: David Edmondson <david.edmondson@oracle.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
f9ff777 & 19 May 2023 & Parav Pandit & { virtio-net: Update vqn to vq_index for cvq cmds


Replace field name vqn to vq_index for recent virtqueue level commands.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/163}
Reviewed-by: David Edmondson <david.edmondson@oracle.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
74460ef & 19 May 2023 & Parav Pandit & { transport-mmio: Replace virtual queue with virtqueue


Basic facilities define the virtqueue construct for device <-> driver
communication.

PCI transport and individual devices description also refers to it as
virtqueue.

MMIO refers to it as 'virtual queue'.

Align MMIO transport description to call such object a virtqueue.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/168}
Reviewed-by: Stefan Hajnoczi <stefanha@redhat.com>
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
92295f3 & 24 May 2023 & Michael S. Tsirkin & { fix: content: Rename confusing queue_notify_data and vqn names


when applying the patch, I omitted adding notifications-data-le.c
As a result, build fails.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/172}
Message-ID: <20230505014614.571520-4-parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

cc4a5604b259b3d6e18d50748423177b8eda3288

 } \\
\hline
6724756 & 07 Jul 2023 & Parav Pandit & { admin: Split opcode table rows with a line


Currently all opcode appears to be in a single row.
Separate them with a line similar to other tables.

Signed-off-by: Parav Pandit <parav@nvidia.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
[CH: pushed as editorial update]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
1518c9c & 07 Jul 2023 & Parav Pandit & { admin: Fix section numbering


Requirements are put one additional level down. Fix it.

Signed-off-by: Parav Pandit <parav@nvidia.com>
Reviewed-by: Cornelia Huck <cohuck@redhat.com>
[CH: pushed as editorial update]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
9c3ba1e & 14 Jul 2023 & Heng Qi & { virtio-net: support inner header hash


1. Currently, a received encapsulated packet has an outer and an inner header, but
the virtio device is unable to calculate the hash for the inner header. The same
flow can traverse through different tunnels, resulting in the encapsulated
packets being spread across multiple receive queues (refer to the figure below).
However, in certain scenarios, we may need to direct these encapsulated packets of
the same flow to a single receive queue. This facilitates the processing
of the flow by the same CPU to improve performance (warm caches, less locking, etc.).

               client1                    client2
                  |        +-------+         |
                  +------->|tunnels|<--------+
                           +-------+
                              |  |
                              v  v
                      +-----------------+
                      | monitoring host |
                      +-----------------+

To achieve this, the device can calculate a symmetric hash based on the inner headers
of the same flow.

2. For legacy systems, they may lack entropy fields which modern protocols have in
the outer header, resulting in multiple flows with the same outer header but
different inner headers being directed to the same receive queue. This results in
poor receive performance.

To address this limitation, inner header hash can be used to enable the device to advertise
the capability to calculate the hash for the inner packet, regaining better receive performance.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/173}

Signed-off-by: Heng Qi <hengqi@linux.alibaba.com>
Reviewed-by: Xuan Zhuo <xuanzhuo@linux.alibaba.com>
Reviewed-by: Parav Pandit <parav@nvidia.com>
[CH: added missing lstlisting and hyperref escapes, fixed references]
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
73c2fd9 & 17 Jul 2023 & Haixu Cui & { virtio-spi: define the DEVICE ID for virtio SPI master


Define the DEVICE ID of virtio SPI master device as 45.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/174}
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
03c2d32 & 21 Jul 2023 & Parav Pandit & { admin: Add group member legacy register access commands


Introduce group member legacy common configuration and legacy device
configuration access read/write commands.

Group member legacy registers access commands enable group owner driver
software to access legacy registers on behalf of the guest virtual
machine.

Usecase:
========
1. A hypervisor/system needs to provide transitional
   virtio devices to the guest VM at scale of thousands,
   typically, one to eight devices per VM.

2. A hypervisor/system needs to provide such devices using a
   vendor agnostic driver in the hypervisor system.

3. A hypervisor system prefers to have single stack regardless of
   virtio device type (net/blk) and be future compatible with a
   single vfio stack using SR-IOV or other scalable device
   virtualization technology to map PCI devices to the guest VM.
   (as transitional or otherwise)

Motivation/Background:
=====================
The existing virtio transitional PCI device is missing support for
PCI SR-IOV based devices. Currently it does not work beyond
PCI PF, or as software emulated device in reality. Currently it
has below cited system level limitations:

[a] PCIe spec citation:
VFs do not support I/O Space and thus VF BARs shall not indicate I/O Space.

[b] cpu arch citiation:
Intel 64 and IA-32 Architectures Software Developers Manual:
The processors I/O address space is separate and distinct from
the physical-memory address space. The I/O address space consists
of 64K individually addressable 8-bit I/O ports, numbered 0 through FFFFH.

[c] PCIe spec citation:
If a bridge implements an I/O address range,...I/O address range will be
aligned to a 4 KB boundary.

Overview:
=========
Above usecase requirements is solved by PCI PF group owner accessing
its group member PCI VFs legacy registers using the administration
commands of the group owner PCI PF.

Two types of administration commands are added which read/write PCI VF
registers.

Software usage example:
=======================

1. One way to use and map to the guest VM is by using vfio driver
framework in Linux kernel.

                +----------------------+
                |pci_dev_id = 0x100X   |
+---------------|pci_rev_id = 0x0      |-----+
|vfio device    |BAR0 = I/O region     |     |
|               |Other attributes      |     |
|               +----------------------+     |
|                                            |
+   +--------------+     +-----------------+ |
|   |I/O BAR to AQ |     | Other vfio      | |
|   |rd/wr mapper\& |     | functionalities | |
|   | forwarder    |     |                 | |
|   +--------------+     +-----------------+ |
|                                            |
+------+-------------------------+-----------+
       |                         |
   Config region                 |
     access                Driver notifications
       |                         |
  +----+------------+       +----+------------+
  | +-----+         |       | PCI VF device A |
  | | AQ  |-------------+---->+-------------+ |
  | +-----+         |   |   | | legacy regs | |
  | PCI PF device   |   |   | +-------------+ |
  +-----------------+   |   +-----------------+
                        |
                        |   +----+------------+
                        |   | PCI VF device N |
                        +---->+-------------+ |
                            | | legacy regs | |
                            | +-------------+ |
                            +-----------------+

2. Continue to use the virtio pci driver to bind to the
   listed device id and use it as in the host.

3. Use it in a light weight hypervisor to run bare-metal OS.

Fixes: \url{https://github.com/oasis-tcs/virtio-spec/issues/167}
Signed-off-by: Parav Pandit <parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
7fe9191 & 04 Aug 2023 & Cornelia Huck & { edit: remove old changelog


Move it to cl-cs02-12.tex.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f023dfa & 09 Aug 2023 & Cornelia Huck & { edit: add changelog for 1.3


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
2985fdc & 25 Aug 2023 & Michael S. Tsirkin & { changelog: tweak column width


make description column wide and the others narrow
likely won't work well if we change page size but oh well

[CH: tweaked the tweak]
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
6234e87 & 25 Aug 2023 & Michael S. Tsirkin & { changelog: formatting fixes


Used lstlisting for ascii art. Note: if we want to we can also
break up large ascii art in the last half.
Forced no index on patch subject (looked ugly to me).
Added vspace after subject and before signature tags.
Reformatted nested lists in one commit using itemize (did not bother with
all of them but be my guest).
Liberally added paragraph breaks where it seemed appropriate.

[CH: added a bunch more enumerate/itemize, except where I was not able
to figure it out]
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
f23778d & 25 Aug 2023 & Michael S. Tsirkin & { work around extra row


latex seems to think we have an extra row in the table.
could not figure out why, but at least let's make it look
cleaner by adding cell boundaries.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
c28a45d & 25 Aug 2023 & Cornelia Huck & { acknowledgements: update for 1.3


Move some names to the section for previous versions, add names of new
contributors, etc.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
8e661c9 & 25 Aug 2023 & Cornelia Huck & { editorial: update copyright date in PDF footer to 2023


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
d401d40 & 25 Aug 2023 & Cornelia Huck & { change revisions: diff from v1.2, current v1.3


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
0f8579c & 25 Aug 2023 & Cornelia Huck & { title: note that 1.3 supercedes 1.2


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
1547af7 & 25 Aug 2023 & Cornelia Huck & { revision: update date


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
3abace8 & 27 Sep 2023 & Cornelia Huck & { remove enumerate usage that makes the tool unhappy


Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
db68dc0 & 28 Sep 2023 & Cornelia Huck & { Revert "remove enumerate usage that makes the tool unhappy"


This reverts commit 3abace87db23ddceaf9688a405dd3fd540023977.

We can fix it properly instead.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
c7bef01 & 28 Sep 2023 & Michael S. Tsirkin & { html: add missing enumitem package


makediffhtml.sh currently fails with:

! Missing number, treated as zero.
<to be read again>
                   \textbackslash c@*
l.25850 \textbackslash begin\{enumerate\}[label=\textbackslash alph*
                                      .]
?
! Emergency stop.
<to be read again>
                   \textbackslash c@*
l.25850 \textbackslash begin\{enumerate\}[label=\textbackslash alph*
                                      .]

Some web searches turned up suggestions to use enumitem and in fact,
virtio.tex already does this - but virtio-html.tex doesn't.

Adding \textbackslash usepackage\{enumitem\} in virtio-html.tex too fixes the issue.

Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
eb16e33 & 03 Nov 2023 & Cornelia Huck & { editorial: various fixes for 1.3-csd01



- Set approval date to 06 October 2023. (applies to front page subtitle,
citation format, PDF page footers)

- Set filenames and URIs to show csd01 instead of wd01 (also PDF footers)

- Set "Previous stage" to "N/A" (don't list a different numbered Version)

- In "Related work", change (3x) text - "Latest version" to "Latest stage"

- In "Notices", set the copyright year to 2023.


- In the first line of Appendix D. Revision History, replace "the previous
version" with "Version 1.2"


- In Section 1.3, apply the current IETF-recommended text:
"The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in BCP 14
[[RFC2119](\#link)] and [[RFC8174](\#link)] when, and only when, they appear
in all capitals, as shown here."

- Also, add the RFC 8174 reference:
[RFC8174]
Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words", BCP
14, RFC 8174, DOI 10.17487/RFC8174, May 2017,
\url{https://www.rfc-editor.org/info/rfc8174.}

Reported-by: Paul Knight <paul.knight@oasis-open.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
43a948e & 03 Nov 2023 & Cornelia Huck & { editorial: update "Computer Language Definitions" URL


Split out from the other fixes for 1.3-csd01 so that we can fixup the
diff.


- In "Status", (fourth paragraph) change the hyperlink under (Computer
Language Definitions) to be "
\url{https://www.oasis-open.org/policies-guidelines/tc-process-2017-05-26/\#wpComponentsCompLang}
"

Reported-by: Paul Knight <paul.knight@oasis-open.org>
Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
5fc35a7 & 03 Nov 2023 & Cornelia Huck & { makediff: update list of cherry-picks


We don't need to apply the old commits anymore, but we have to apply
the URL update to work around a not-yet-debugged latexdiff problem.

Signed-off-by: Cornelia Huck <cohuck@redhat.com>

 } \\
\hline
71fe8e9 & 21 May 2024 & Michael S. Tsirkin & { README.md: update mailing list info


As approved by the TC, we are moving to a less formal
way of discussing the specification, on the mailing lists
provided by the Linux Foundation:

\url{https://groups.oasis-open.org/higherlogic/ws/public/ballot?id=3820}

Update README.md, CONTRIBUTING.md and newdevice.tex accordingly.

Use this opportunity to explain when and how to use each
mailing list.

Oh yes, and device numbers are reserved through virtio-comment
not through virtio-dev. Correct that.

Message-Id: <8f5db33c96d685fcebca3579b05d09b64dd720d9.1715766697.git.mst@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
6678bbf & 11 Jul 2024 & Parav Pandit & { Add link for the feature bits section


Device common feature bits overview in the basic facilities and
their actual description are apart by 24 chapters.

Help reader to directly reach out to feature bits definitions from
the basic chapter.

MST: merged as a trivial editorial change

Signed-off-by: Parav Pandit <parav@nvidia.com>
Message-Id: <20240612073522.2571082-1-parav@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
d7c486b & 11 Jul 2024 & Michael S. Tsirkin & { introduction: fix label


label to rfc8174 is incorrect, leading to undefined reference
and multiple defined reference latex errors.

Fix it up.

Message-Id: <52b6fc16793e3b24284aefafda94322c739b9f7f.1720725332.git.mst@redhat.com>
Fixes: eb16e33 ("editorial: various fixes for 1.3-csd01")
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
7e454b6 & 11 Jul 2024 & Michael S. Tsirkin & { makediff: cherry pick label change


label changes tend to trip up makediff - this one
causes an undefined reference from deleted section.
To fix, cherry-pick it.

Message-Id: <216774e3fa811e0a6e994a3815f0804ddfc0bb03.1720731399.git.mst@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
b495841 & 11 Jul 2024 & Michael S. Tsirkin & { transport-mmio: fix up makediff from 1.2


we fixed a typo in label name: in the diff old links become
undefined. Add the old label back for now, we can drop it
down the road.

Message-Id: <fc98549666e0fe74e890a7a62ca71248e709712b.1720731329.git.mst@redhat.com>
Fixes: ca97719 ("transport-mmio: Fix spellings and white spaces")
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

 } \\
\hline
